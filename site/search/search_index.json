{"config":{"lang":["es"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"AltruPets - Documentaci\u00f3n del Proyecto","text":"<p>Bienvenido a la documentaci\u00f3n t\u00e9cnica de AltruPets, una plataforma cloud-native de protecci\u00f3n animal para toda Latinoam\u00e9rica.</p>"},{"location":"#sitio-principal","title":"\ud83c\udf10 Sitio Principal","text":"<p>URL: altrupets.github.io/altrupets-monorepo/</p>"},{"location":"#secciones-de-documentacion","title":"\ud83d\udcda Secciones de Documentaci\u00f3n","text":""},{"location":"#quick-links","title":"Quick Links","text":"Secci\u00f3n Descripci\u00f3n Arquitectura Arquitectura del sistema y dise\u00f1o t\u00e9cnico Tecnolog\u00edas Stack tecnol\u00f3gico completo Desarrollo Gu\u00eda de configuraci\u00f3n y desarrollo local Despliegue Estrategias de despliegue en producci\u00f3n latam_payments Paquete de pagos para LATAM"},{"location":"#estado-del-proyecto","title":"\ud83d\ude80 Estado del Proyecto","text":""},{"location":"#completado","title":"\u2705 Completado","text":"<ul> <li> Arquitectura base del monorepo</li> <li> Backend con NestJS + GraphQL</li> <li> Frontend Flutter con Clean Architecture</li> <li> Infraestructura Kubernetes</li> <li> Pipeline CI/CD con GitHub Actions</li> <li> Sistema de pagos LATAM (latam_payments)</li> </ul>"},{"location":"#roadmap","title":"\ud83d\udccb Roadmap","text":"<ul> <li> Despliegue a producci\u00f3n</li> <li> Integraci\u00f3n con pasarelas de pago regionales</li> <li> Sistema de notificaciones push</li> <li> Module Federation para micro-frontends</li> <li> M\u00e9tricas y observabilidad</li> </ul>"},{"location":"#estructura-del-proyecto","title":"\ud83d\udcc1 Estructura del Proyecto","text":"<pre><code>altrupets-monorepo/\n\u251c\u2500\u2500 apps/\n\u2502   \u251c\u2500\u2500 backend/           # Backend NestJS + GraphQL\n\u2502   \u2514\u2500\u2500 mobile/           # App Flutter\n\u251c\u2500\u2500 docs/                 # Documentaci\u00f3n MkDocs\n\u2502   \u2514\u2500\u2500 content/          # Archivos markdown\n\u251c\u2500\u2500 infrastructure/       # Terraform + Kubernetes\n\u251c\u2500\u2500 skills/              # Agent Skills para IA\n\u251c\u2500\u2500 specs/               # Especificaciones t\u00e9cnicas\n\u2514\u2500\u2500 site/                # Salida de GitHub Pages\n</code></pre>"},{"location":"#enlaces-relevantes","title":"\ud83d\udd17 Enlaces Relevantes","text":"<ul> <li>GitHub: github.com/altrupets</li> <li>Sitio Web: altrupets.com</li> </ul> <p>\u00daltima actualizaci\u00f3n: Febrero 2026</p>"},{"location":"devsecops/security-scanner/","title":"Security Scanner","text":""},{"location":"devsecops/security-scanner/#descripcion","title":"Descripci\u00f3n","text":"<p>El Security Scanner es un contenedor Docker dedicado que contiene todas las herramientas necesarias para realizar an\u00e1lisis de seguridad en el proyecto AltruPets. Se ejecuta como Kubernetes Jobs o CronJobs para escanear c\u00f3digo, dependencias, im\u00e1genes y configuraciones de infraestructura.</p>"},{"location":"devsecops/security-scanner/#arquitectura","title":"Arquitectura","text":""},{"location":"devsecops/security-scanner/#separacion-de-responsabilidades","title":"Separaci\u00f3n de Responsabilidades","text":"<pre><code>graph LR\n    A[Backend Container] --&gt; B[\"Node.js + App\"]\n    C[Security Scanner] --&gt; D[Security Tools]\n\n    style A fill:#e1f5e1\n    style B fill:#d4edda\n    style C fill:#fff3cd\n    style D fill:#f8d7da\n</code></pre>"},{"location":"devsecops/security-scanner/#por-que-un-contenedor-separado","title":"\u00bfPor qu\u00e9 un contenedor separado?","text":"Aspecto Backend Container Security Scanner Prop\u00f3sito Ejecutar la aplicaci\u00f3n Escanear seguridad Tama\u00f1o ~150MB (alpine) ~2GB (con herramientas) Entorno Producci\u00f3n CI/CD + Dev Contenido Solo runtime necesario Todas las herramientas de seguridad Principio M\u00ednima superficie de ataque M\u00e1xima cobertura de an\u00e1lisis <p>Beneficios de la Separaci\u00f3n</p> <ul> <li>\u2705 Im\u00e1genes de producci\u00f3n m\u00e1s peque\u00f1as y seguras</li> <li>\u2705 Despliegues m\u00e1s r\u00e1pidos del backend</li> <li>\u2705 Herramientas de seguridad aisladas de producci\u00f3n</li> <li>\u2705 Escaneos programables independientes</li> <li>\u2705 Versionado \u00fanico de herramientas de seguridad</li> </ul> <p>Anti-patr\u00f3n (lo que NO hacemos)</p> <ul> <li>\u274c Instalar herramientas de seguridad en el Dockerfile del backend</li> <li>\u274c Mezclar dependencias de runtime con herramientas de an\u00e1lisis</li> <li>\u274c Exponer herramientas de seguridad en contenedores de producci\u00f3n</li> </ul>"},{"location":"devsecops/security-scanner/#herramientas-incluidas","title":"Herramientas Incluidas","text":""},{"location":"devsecops/security-scanner/#analisis-de-vulnerabilidades","title":"An\u00e1lisis de Vulnerabilidades","text":"Herramienta Versi\u00f3n Prop\u00f3sito Trivy 0.69.1 Escaneo de contenedores y filesystem npm audit (Node 20.x) Vulnerabilidades en dependencias Node.js Safety latest Vulnerabilidades en dependencias Python"},{"location":"devsecops/security-scanner/#analisis-estatico-sast","title":"An\u00e1lisis Est\u00e1tico (SAST)","text":"Herramienta Versi\u00f3n Prop\u00f3sito dart analyze (Flutter stable) An\u00e1lisis est\u00e1tico de c\u00f3digo Dart ESLint (via npm) An\u00e1lisis de c\u00f3digo TypeScript/JavaScript Bandit latest An\u00e1lisis de seguridad en c\u00f3digo Python"},{"location":"devsecops/security-scanner/#deteccion-de-secretos","title":"Detecci\u00f3n de Secretos","text":"Herramienta Versi\u00f3n Prop\u00f3sito Trufflehog 2.2.1 Detecci\u00f3n de secretos en c\u00f3digo y commits"},{"location":"devsecops/security-scanner/#infrastructure-as-code-iac","title":"Infrastructure as Code (IaC)","text":"Herramienta Versi\u00f3n Prop\u00f3sito tfsec 1.28.14 An\u00e1lisis de seguridad para Terraform Checkov 3.2.504 An\u00e1lisis de IaC multi-cloud (Terraform, K8s, Docker)"},{"location":"devsecops/security-scanner/#uso","title":"Uso","text":""},{"location":"devsecops/security-scanner/#build-local","title":"Build Local","text":"<pre><code>docker build -t altrupets/security-scanner:1.0.0 \\\n  -f infrastructure/docker/security-scanner/Dockerfile .\n</code></pre>"},{"location":"devsecops/security-scanner/#ejecucion-local","title":"Ejecuci\u00f3n Local","text":"<pre><code># Escaneo completo\ndocker run --rm \\\n  -v $(pwd):/workspace \\\n  -v $(pwd)/.security-reports:/reports \\\n  altrupets/security-scanner:1.0.0 all\n\n# Escaneo espec\u00edfico\ndocker run --rm \\\n  -v $(pwd):/workspace \\\n  -v $(pwd)/.security-reports:/reports \\\n  altrupets/security-scanner:1.0.0 deps\n</code></pre>"},{"location":"devsecops/security-scanner/#makefile-commands","title":"Makefile Commands","text":"<pre><code># Escaneo completo\nmake dev-security-scan\n\n# Escaneos espec\u00edficos\nmake dev-security-deps        # Dependencias\nmake dev-security-sast        # An\u00e1lisis est\u00e1tico\nmake dev-security-secrets     # Detecci\u00f3n de secretos\nmake dev-security-container   # Im\u00e1genes de contenedor\nmake dev-security-iac         # Infrastructure as Code\n\n# Auto-fix vulnerabilidades\nmake dev-security-fix\n</code></pre>"},{"location":"devsecops/security-scanner/#kubernetes-job-on-demand","title":"Kubernetes Job (On-Demand)","text":"<pre><code># Ejecutar escaneo manual\nkubectl create job security-scan-manual \\\n  --from=cronjob/security-scanner \\\n  -n altrupets-dev\n\n# Ver logs\nkubectl logs -f job/security-scan-manual -n altrupets-dev\n\n# Ver reportes\nkubectl exec -it security-scan-manual-xxxxx -n altrupets-dev \\\n  -- ls -la /reports\n</code></pre>"},{"location":"devsecops/security-scanner/#kubernetes-cronjob-programado","title":"Kubernetes CronJob (Programado)","text":"<p>El scanner se ejecuta autom\u00e1ticamente todos los d\u00edas a las 2:00 AM:</p> <pre><code># k8s/base/security-scanner/cronjob.yaml\nschedule: \"0 2 * * *\"  # Diario a las 2 AM\n</code></pre> <pre><code># Ver pr\u00f3ximas ejecuciones\nkubectl get cronjob security-scanner -n altrupets-dev\n\n# Ver historial de Jobs\nkubectl get jobs -n altrupets-dev -l app=security-scanner\n\n# Ver logs del \u00faltimo escaneo\nkubectl logs -f $(kubectl get pods -n altrupets-dev \\\n  -l app=security-scanner --sort-by=.metadata.creationTimestamp \\\n  -o jsonpath='{.items[-1].metadata.name}')\n</code></pre>"},{"location":"devsecops/security-scanner/#tipos-de-escaneo","title":"Tipos de Escaneo","text":""},{"location":"devsecops/security-scanner/#1-dependencias-deps","title":"1. Dependencias (<code>deps</code>)","text":"<p>Escanea vulnerabilidades en dependencias de paquetes:</p> <pre><code>make dev-security-deps\n</code></pre> <p>Herramientas: - <code>npm audit</code> para Node.js - <code>safety</code> para Python - <code>flutter pub outdated --mode=security</code> para Dart</p> <p>Salida: - <code>.security-reports/npm-audit.json</code> - Reporte en consola con severidades</p>"},{"location":"devsecops/security-scanner/#2-analisis-estatico-sast","title":"2. An\u00e1lisis Est\u00e1tico (<code>sast</code>)","text":"<p>Analiza el c\u00f3digo fuente en busca de problemas de seguridad:</p> <pre><code>make dev-security-sast\n</code></pre> <p>Herramientas: - <code>dart analyze</code> para Flutter/Dart - <code>eslint</code> para TypeScript/JavaScript - <code>bandit</code> para Python - <code>shellcheck</code> para scripts Bash</p> <p>Salida: - <code>.security-reports/dart-analyze.txt</code> - <code>.security-reports/eslint.json</code> - <code>.security-reports/shellcheck.json</code></p>"},{"location":"devsecops/security-scanner/#3-secretos-secrets","title":"3. Secretos (<code>secrets</code>)","text":"<p>Detecta secretos hardcodeados en el c\u00f3digo:</p> <pre><code>make dev-security-secrets\n</code></pre> <p>Herramientas: - <code>trufflehog</code> con verificaci\u00f3n de secretos</p> <p>Patrones detectados: - API keys - Passwords - Tokens (JWT, OAuth, etc.) - Private keys (RSA, EC, DSA) - Cloud credentials (AWS, GCP, Azure)</p> <p>Salida: - <code>.security-reports/trufflehog.json</code></p>"},{"location":"devsecops/security-scanner/#4-contenedores-container","title":"4. Contenedores (<code>container</code>)","text":"<p>Escanea im\u00e1genes Docker y Dockerfiles:</p> <pre><code>make dev-security-container\n</code></pre> <p>Herramientas: - <code>trivy</code> para an\u00e1lisis de im\u00e1genes y configuraci\u00f3n</p> <p>Escanea: - Vulnerabilidades en im\u00e1genes base - Vulnerabilidades en dependencias - Configuraci\u00f3n de Dockerfiles - Best practices de Docker</p> <p>Salida: - <code>.security-reports/trivy-backend.json</code> - <code>.security-reports/trivy-backend-config.json</code></p>"},{"location":"devsecops/security-scanner/#5-infrastructure-as-code-iac","title":"5. Infrastructure as Code (<code>iac</code>)","text":"<p>Escanea configuraciones de infraestructura:</p> <pre><code>make dev-security-iac\n</code></pre> <p>Herramientas: - <code>tfsec</code> para Terraform/OpenTofu - <code>checkov</code> para Terraform, Kubernetes, Docker</p> <p>Escanea: - Configuraciones de Terraform - Manifiestos de Kubernetes - Dockerfiles - Helm charts</p> <p>Salida: - <code>.security-reports/tfsec.json</code> - <code>.security-reports/checkov.json</code> - <code>.security-reports/checkov-k8s.json</code></p>"},{"location":"devsecops/security-scanner/#6-auto-fix-fix","title":"6. Auto-Fix (<code>fix</code>)","text":"<p>Intenta corregir autom\u00e1ticamente vulnerabilidades:</p> <pre><code>make dev-security-fix\n</code></pre> <p>Acciones: - <code>npm audit fix --force</code> para Node.js - <code>flutter pub upgrade --major-versions</code> para Dart - <code>dart fix --apply</code> para c\u00f3digo Dart - <code>eslint --fix</code> para TypeScript/JavaScript</p>"},{"location":"devsecops/security-scanner/#reportes","title":"Reportes","text":""},{"location":"devsecops/security-scanner/#ubicacion","title":"Ubicaci\u00f3n","text":"<p>Todos los reportes se guardan en:</p> <pre><code>graph TD\n    reports[\".security-reports/\"]\n    npm[npm-audit.json]\n    dart[dart-analyze.txt]\n    eslint[eslint.json]\n    shell[shellcheck.json]\n    truffle[trufflehog.json]\n    trivy[trivy-backend.json]\n    trivyc[trivy-backend-config.json]\n    tfsec[tfsec.json]\n    checkov[checkov.json]\n    checkovk[checkov-k8s.json]\n    summary[summary-YYYYMMDD-HHMMSS.md]\n\n    reports --&gt; npm\n    reports --&gt; dart\n    reports --&gt; eslint\n    reports --&gt; shell\n    reports --&gt; truffle\n    reports --&gt; trivy\n    reports --&gt; trivyc\n    reports --&gt; tfsec\n    reports --&gt; checkov\n    reports --&gt; checkovk\n    reports --&gt; summary\n\n    style reports fill:#f8f9fa,stroke:#333\n</code></pre>"},{"location":"devsecops/security-scanner/#reporte-resumen","title":"Reporte Resumen","text":"<p>Cada ejecuci\u00f3n genera un reporte resumen en Markdown:</p> <pre><code># DevSecOps Scan Report\n\n**Date:** 2025-02-19 14:30:00\n**Environment:** DEV Local (Minikube)\n\n## Scans Performed\n\n| Scan | Status | Report |\n|------|--------|--------|\n| Dependencies | \u2705 | .security-reports/npm-audit.json |\n| SAST | \u2705 | .security-reports/dart-analyze.txt |\n| Secrets | \u2705 | .security-reports/trufflehog.json |\n| Containers | \u2705 | .security-reports/trivy-backend.json |\n| IaC | \u2705 | .security-reports/tfsec.json |\n</code></pre>"},{"location":"devsecops/security-scanner/#cicd-integration","title":"CI/CD Integration","text":""},{"location":"devsecops/security-scanner/#github-actions","title":"GitHub Actions","text":"<pre><code># .github/workflows/security-scan.yml\nname: Security Scan\n\non:\n  push:\n    branches: [main, develop]\n  pull_request:\n  schedule:\n    - cron: '0 2 * * *'  # Diario a las 2 AM\n\njobs:\n  security-scan:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v4\n\n      - name: Build Security Scanner\n        run: |\n          docker build -t security-scanner:latest \\\n            -f infrastructure/docker/security-scanner/Dockerfile .\n\n      - name: Run Security Scan\n        run: |\n          docker run --rm \\\n            -v ${{ github.workspace }}:/workspace \\\n            -v ${{ github.workspace }}/.security-reports:/reports \\\n            security-scanner:latest all\n\n      - name: Upload Reports\n        uses: actions/upload-artifact@v4\n        with:\n          name: security-reports\n          path: .security-reports/\n</code></pre>"},{"location":"devsecops/security-scanner/#configuracion","title":"Configuraci\u00f3n","text":""},{"location":"devsecops/security-scanner/#variables-de-entorno","title":"Variables de Entorno","text":"<pre><code># Nivel de severidad m\u00ednimo\nSEVERITY_THRESHOLD=HIGH\n\n# Fallar el build en vulnerabilidades\nFAIL_ON_VULNERABILITIES=true\n\n# Directorio de reportes\nREPORT_DIR=/reports\n</code></pre>"},{"location":"devsecops/security-scanner/#exclusiones","title":"Exclusiones","text":"<p>Crear <code>.trivyignore</code> para excluir vulnerabilidades conocidas:</p> <pre><code># .trivyignore\nCVE-2024-12345  # False positive, no aplica a nuestro caso\n</code></pre> <p>Crear <code>.tfsec-ignore</code> para Terraform:</p> <pre><code># .tfsec-ignore\n- rule: aws-s3-enable-bucket-encryption\n  expiry: 2025-12-31\n  reason: Bucket temporal para desarrollo\n</code></pre>"},{"location":"devsecops/security-scanner/#troubleshooting","title":"Troubleshooting","text":""},{"location":"devsecops/security-scanner/#error-trivy-database-update-failed","title":"Error: Trivy database update failed","text":"<pre><code># Actualizar manualmente la base de datos\ndocker run --rm aquasec/trivy:latest image --download-db-only\n</code></pre>"},{"location":"devsecops/security-scanner/#error-flutter-sdk-not-found","title":"Error: Flutter SDK not found","text":"<pre><code># Verificar que Flutter est\u00e9 en el PATH\ndocker run --rm security-scanner:latest flutter --version\n</code></pre>"},{"location":"devsecops/security-scanner/#falsos-positivos","title":"Falsos Positivos","text":"<p>Usar archivos de configuraci\u00f3n para suprimir:</p> <ul> <li><code>.trivyignore</code> para Trivy</li> <li><code>.tfsec-ignore</code> para tfsec</li> <li><code>.checkov.yml</code> para Checkov</li> </ul>"},{"location":"devsecops/security-scanner/#mejores-practicas","title":"Mejores Pr\u00e1cticas","text":"<p>Recomendaciones</p> <ol> <li> <p>Ejecutar escaneos antes de cada commit <code>bash    make dev-security-scan</code></p> </li> <li> <p>Revisar reportes regularmente <code>bash    cat .security-reports/summary-*.md</code></p> </li> <li> <p>Priorizar vulnerabilidades CRITICAL y HIGH</p> </li> <li> <p>Mantener herramientas actualizadas <code>bash    docker build --no-cache -t security-scanner:latest \\      -f infrastructure/docker/security-scanner/Dockerfile .</code></p> </li> <li> <p>Integrar en CI/CD pipeline</p> </li> </ol>"},{"location":"devsecops/security-scanner/#referencias","title":"Referencias","text":"<ul> <li>Trivy Documentation</li> <li>tfsec Documentation</li> <li>Checkov Documentation</li> <li>Trufflehog Documentation</li> <li>OWASP Top 10</li> </ul> <p>\u00daltima actualizaci\u00f3n: 19 de febrero de 2025</p>"},{"location":"docs/architecture/data-flow/","title":"\ud83d\udcca Flujo de Datos","text":""},{"location":"docs/architecture/data-flow/#flujo-de-rescate","title":"Flujo de Rescate","text":"<pre><code>1. Centinela reporta \u2192 GraphQL Mutation\n2. Geolocalizaci\u00f3n \u2192 Algoritmo de proximidad\n3. Auxiliares notificados \u2192 Firebase Cloud Messaging\n4. Auxiliar acepta \u2192 Actualizaci\u00f3n de estado\n5. Rescatista asignado \u2192 Workflow de cuidado\n6. Caso cerrado \u2192 M\u00e9tricas y trazabilidad\n</code></pre>"},{"location":"docs/architecture/data-flow/#flujo-de-donacion","title":"Flujo de Donaci\u00f3n","text":"<pre><code>1. Donante selecciona amount \u2192 Checkout\n2. Gateway seleccionado \u2192 latam_payments\n3. Procesamiento \u2192 Pago regional\n4. Confirmaci\u00f3n \u2192 Actualizaci\u00f3n de estado\n5. Notificaci\u00f3n \u2192 Recibo y trazabilidad\n</code></pre>"},{"location":"docs/architecture/micro-frontends/","title":"\ud83c\udfa8 Micro-Frontends","text":"<p>AltruPets utiliza una arquitectura de micro-frontends donde cada aplicaci\u00f3n web tiene su propio servidor Express.js independiente con Vue.js renderizado v\u00eda Inertia.js.</p>"},{"location":"docs/architecture/micro-frontends/#arquitectura-de-micro-frontends","title":"Arquitectura de Micro-Frontends","text":"<pre><code>flowchart TB\n    subgraph Clients[Clientes]\n        Browser[Browser&lt;br/&gt;Usuarios]\n        Mobile[Flutter App&lt;br/&gt;Mobile]\n        API[API Clients&lt;br/&gt;Integraciones]\n    end\n\n    subgraph Gateway[Gateway Layer]\n        NGINX[NGINX Gateway API&lt;br/&gt;HTTPRoutes]\n        Routes[Route /admin -&gt; web-superusers:3002&lt;br/&gt;Route /b2g -&gt; web-b2g:3003&lt;br/&gt;Route /graphql -&gt; backend:3001]\n    end\n\n    subgraph Superusers[CRUD Superusers]\n        Express1[Express.js&lt;br/&gt;puerto 3002]\n        Vue1[Vue 3 + Inertia&lt;br/&gt;CDN]\n        Express1 --&gt; Vue1\n    end\n\n    subgraph B2G[B2G Government]\n        Express2[Express.js&lt;br/&gt;puerto 3003]\n        Vue2[Vue 3 + Inertia&lt;br/&gt;CDN]\n        Express2 --&gt; Vue2\n    end\n\n    subgraph Backend[Backend API]\n        NestJS[NestJS + GraphQL&lt;br/&gt;puerto 3001]\n        Modules[Auth | Users | Pets&lt;br/&gt;Rescues | Adoptions | Donations]\n        NestJS --&gt; Modules\n    end\n\n    subgraph Data[Data Layer]\n        Postgres[(PostgreSQL)]\n        Valkey[(Valkey&lt;br/&gt;Cache)]\n    end\n\n    Browser --&gt; NGINX\n    Mobile --&gt; NGINX\n    API --&gt; NGINX\n    NGINX --&gt; Routes\n    Routes --&gt; Express1\n    Routes --&gt; Express2\n    Routes --&gt; NestJS\n    NestJS --&gt; Postgres\n    NestJS --&gt; Valkey\n</code></pre>"},{"location":"docs/architecture/micro-frontends/#flujo-de-request","title":"Flujo de Request","text":"<pre><code>sequenceDiagram\n    participant U as Usuario\n    participant G as Gateway\n    participant MF as Micro-Frontend\n    participant B as Backend\n\n    Note over U,B: Flujo de Login\n    U-&gt;&gt;G: GET /admin/login\n    G-&gt;&gt;MF: proxy_pass\n    MF-&gt;&gt;MF: renderPage()\n    MF--&gt;&gt;G: HTML + Vue CDN\n    G--&gt;&gt;U: HTML Response\n\n    U-&gt;&gt;G: POST /admin/login\n    G-&gt;&gt;MF: proxy_pass\n    MF-&gt;&gt;B: POST /login\n    B--&gt;&gt;MF: Set-Cookie: jwt\n    MF--&gt;&gt;G: Redirect /admin\n    G--&gt;&gt;U: Redirect + Cookie\n</code></pre>"},{"location":"docs/architecture/micro-frontends/#tecnologias-por-micro-frontend","title":"Tecnolog\u00edas por Micro-Frontend","text":""},{"location":"docs/architecture/micro-frontends/#crud-superusers-admin","title":"CRUD Superusers (<code>/admin/*</code>)","text":"Componente Tecnolog\u00eda Descripci\u00f3n Servidor Express.js Servidor Node.js minimalista Frontend Vue 3 (CDN) Sin build step, carga desde CDN SPA Inertia.js Navegaci\u00f3n sin recargar p\u00e1gina Estilos CSS inline Sin Tailwind, estilos b\u00e1sicos Puerto 3002 Puerto interno del contenedor Roles <code>SUPER_USER</code> Solo administradores"},{"location":"docs/architecture/micro-frontends/#b2g-government-b2g","title":"B2G Government (<code>/b2g/*</code>)","text":"Componente Tecnolog\u00eda Descripci\u00f3n Servidor Express.js Servidor Node.js minimalista Frontend Vue 3 (CDN) Sin build step, carga desde CDN SPA Inertia.js Navegaci\u00f3n sin recargar p\u00e1gina Estilos CSS inline Tema azul/cyan para gobierno Puerto 3003 Puerto interno del contenedor Roles <code>GOVERNMENT_ADMIN</code>, <code>SUPER_USER</code> Funcionarios gubernamentales"},{"location":"docs/architecture/micro-frontends/#ventajas-de-esta-arquitectura","title":"Ventajas de esta Arquitectura","text":"<pre><code>flowchart TB\n    root[Micro-Frontends] --&gt; sep[Separacion]\n    root --&gt; nobuild[Sin Build Step]\n    root --&gt; security[Seguridad]\n    root --&gt; dx[Developer Experience]\n\n    sep --&gt; app1[Apps Independientes]\n    sep --&gt; deploy1[Deploy Independiente]\n    sep --&gt; scale[Escalado Independiente]\n\n    nobuild --&gt; vue[Vue desde CDN]\n    nobuild --&gt; novite[Sin Vite/Webpack]\n    nobuild --&gt; simple[Dockerfiles Simples]\n    nobuild --&gt; fast[Desarrollo Rapido]\n\n    security --&gt; auth[Auth por App]\n    security --&gt; roles[Roles Especificos]\n    security --&gt; truth[Backend como Fuente]\n\n    dx --&gt; hot[Hot Reload con tsx]\n    dx --&gt; one[Un Comando Dev]\n    dx --&gt; logs[Logs Centralizados]\n</code></pre>"},{"location":"docs/architecture/micro-frontends/#despliegue-en-kubernetes","title":"Despliegue en Kubernetes","text":"<pre><code>flowchart LR\n    subgraph Namespace[\"Namespace: altrupets-dev\"]\n        subgraph WebApps[\"Web Apps\"]\n            WS[\"web-superusers&lt;br/&gt;:3002&lt;br/&gt;SUPER_USER\"]\n            WB[\"web-b2g&lt;br/&gt;:3003&lt;br/&gt;GOV_ADMIN\"]\n        end\n\n        subgraph API[\"API\"]\n            BK[\"backend&lt;br/&gt;:3001&lt;br/&gt;GraphQL\"]\n        end\n\n        subgraph GW[\"Gateway\"]\n            NG[\"dev-gateway-nginx&lt;br/&gt;HTTPRoutes\"]\n        end\n    end\n\n    subgraph Images[\"Container Images\"]\n        I1[\"localhost/altrupets-web-crud-superusers:dev\"]\n        I2[\"localhost/altrupets-web-b2g:dev\"]\n        I3[\"localhost/altrupets-backend:dev\"]\n    end\n\n    I1 --&gt; WS\n    I2 --&gt; WB\n    I3 --&gt; BK\n\n    NG --&gt; WS\n    NG --&gt; WB\n    NG --&gt; BK\n</code></pre>"},{"location":"docs/architecture/micro-frontends/#estructura-de-codigo","title":"Estructura de C\u00f3digo","text":"<pre><code>flowchart TB\n    subgraph Monorepo[Monorepo]\n        Mobile[mobile&lt;br/&gt;Flutter App]\n\n        Super[crud-superusers&lt;br/&gt;Express + Vue CDN]\n        B2G[b2g&lt;br/&gt;Express + Vue CDN]\n        Shared[shared&lt;br/&gt;Utilidades]\n\n        Backend[backend&lt;br/&gt;NestJS + GraphQL]\n\n        TF[terraform&lt;br/&gt;IaC]\n        Scripts[scripts&lt;br/&gt;Build &amp; Deploy]\n\n        Base[base&lt;br/&gt;Manifests]\n        Overlays[overlays&lt;br/&gt;dev|qa|stage|prod]\n    end\n\n    Mobile -.-&gt; Backend\n    Super -.-&gt; Backend\n    B2G -.-&gt; Backend\n</code></pre>"},{"location":"docs/architecture/micro-frontends/#comandos-de-desarrollo","title":"Comandos de Desarrollo","text":"<pre><code># Iniciar entorno local completo\nmake dev-minikube-deploy      # 1. Crear cluster\nmake dev-gateway-deploy       # 2. Deploy Gateway API\nmake dev-backend-build        # 3. Build backend\nmake dev-superusers-deploy    # 4. Deploy Admin\nmake dev-b2g-deploy           # 5. Deploy B2G\nmake dev-gateway-start        # 6. Port-forward\n\n# URLs locales\nhttp://localhost:3001/admin/login   # CRUD Superusers\nhttp://localhost:3001/b2g/login     # B2G Government\nhttp://localhost:3001/graphql       # GraphQL Playground\n</code></pre>"},{"location":"docs/architecture/overview/","title":"Arquitectura - Visi\u00f3n General","text":""},{"location":"docs/architecture/overview/#arquitectura-completa","title":"Arquitectura Completa","text":"<pre><code>flowchart TB\n    subgraph Clients\n        Browser[Browser]\n        Mobile[Flutter App]\n        API[API Clients]\n    end\n\n    subgraph Gateway\n        NGINX[NGINX Gateway API]\n    end\n\n    subgraph Apps\n        Admin[CRUD Superusers&lt;br/&gt;Express+Vue]\n        B2G[B2G Government&lt;br/&gt;Express+Vue]\n        Backend[Backend API&lt;br/&gt;NestJS+GraphQL]\n    end\n\n    subgraph Data\n        Postgres[(PostgreSQL)]\n        Valkey[(Valkey)]\n        Storage[(S3/MinIO)]\n    end\n\n    Browser --&gt; NGINX\n    Mobile --&gt; NGINX\n    API --&gt; NGINX\n    NGINX --&gt; Admin\n    NGINX --&gt; B2G\n    NGINX --&gt; Backend\n    Admin -.-&gt; Backend\n    B2G -.-&gt; Backend\n    Backend --&gt; Postgres\n    Backend --&gt; Valkey\n    Backend --&gt; Storage\n</code></pre>"},{"location":"docs/architecture/overview/#capas-de-la-arquitectura","title":"Capas de la Arquitectura","text":""},{"location":"docs/architecture/overview/#1-presentation-layer","title":"1. Presentation Layer","text":"Aplicaci\u00f3n Tecnolog\u00eda Puerto Roles CRUD Superusers Express+Vue+Inertia 3002 <code>SUPER_USER</code> B2G Government Express+Vue+Inertia 3003 <code>GOVERNMENT_ADMIN</code> Flutter Mobile Flutter+Riverpod - Todos"},{"location":"docs/architecture/overview/#2-gateway-layer","title":"2. Gateway Layer","text":"Componente Tecnolog\u00eda Ingress NGINX Gateway API HTTPRoutes Gateway API"},{"location":"docs/architecture/overview/#3-api-layer","title":"3. API Layer","text":"Componente Tecnolog\u00eda Framework NestJS API GraphQL ORM Prisma"},{"location":"docs/architecture/overview/#4-data-layer","title":"4. Data Layer","text":"Componente Tecnolog\u00eda Database PostgreSQL Cache Valkey Storage S3/MinIO"},{"location":"docs/architecture/overview/#5-infrastructure-layer","title":"5. Infrastructure Layer","text":"Componente Tecnolog\u00eda Orchestration Kubernetes IaC Terraform CI/CD GitHub Actions GitOps ArgoCD"},{"location":"docs/architecture/overview/#principios-arquitectonicos","title":"Principios Arquitect\u00f3nicos","text":""},{"location":"docs/architecture/overview/#clean-architecture","title":"Clean Architecture","text":"<pre><code>flowchart LR\n    subgraph Core\n        Payments[payments]\n        Network[network]\n        Services[services]\n    end\n\n    subgraph Features\n        Auth[auth]\n        Pets[pets]\n        Rescues[rescues]\n    end\n\n    Core --&gt; Features\n</code></pre>"},{"location":"docs/architecture/overview/#backend-modules","title":"Backend Modules","text":"<pre><code>flowchart TB\n    Auth --&gt; Shared\n    Users --&gt; Shared\n    Pets --&gt; Shared\n    Rescues --&gt; Shared\n\n    subgraph Shared\n        Guards[Guards]\n        Decorators[Decorators]\n    end\n</code></pre>"},{"location":"docs/architecture/overview/#seguridad","title":"Seguridad","text":"<pre><code>flowchart LR\n    subgraph Security\n        JWT[JWT Auth]\n        RBAC[RBAC]\n        Rate[Rate Limiting]\n        SSL[SSL/TLS]\n    end\n\n    subgraph Roles\n        Super[SUPER_USER]\n        Gov[GOVERNMENT_ADMIN]\n        Rescuer[RESCUER]\n    end\n\n    Security --&gt; Roles\n</code></pre>"},{"location":"docs/architecture/technologies/","title":"\ud83d\udee0\ufe0f Tecnolog\u00edas","text":""},{"location":"docs/architecture/technologies/#web-apps-micro-frontends","title":"\ud83d\udda5\ufe0f Web Apps (Micro-Frontends)","text":"Tecnolog\u00eda Uso Express.js Servidor Node.js minimalista Vue 3 Framework UI (desde CDN) Inertia.js SPA sin API adicional TypeScript Type safety en servidor"},{"location":"docs/architecture/technologies/#frontend-mobile","title":"\ud83d\udcf1 Frontend (Mobile)","text":"Tecnolog\u00eda Uso Flutter Framework multiplataforma Riverpod State management Clean Architecture Patr\u00f3n arquitect\u00f3nico GraphQL API Client Freezed Modelos inmutables"},{"location":"docs/architecture/technologies/#backend","title":"\u2699\ufe0f Backend","text":"Tecnolog\u00eda Uso NestJS Framework Node.js GraphQL API con Apollo Server PostgreSQL Base de datos principal Valkey Cache y queues (Redis-compatible) Prisma ORM"},{"location":"docs/architecture/technologies/#infraestructura-ovhcloud","title":"\u2601\ufe0f Infraestructura (OVHCloud)","text":"Tecnolog\u00eda Uso OVHCloud Kubernetes Orquestaci\u00f3n (QA/Stage/Prod) OVH Managed PostgreSQL Base de datos gestionada Valkey Cache (Redis-compatible) Terraform/OpenTofu IaC GitHub Actions CI/CD OVHCloud Monitoring Observabilidad"},{"location":"docs/architecture/technologies/#pagos-latam_payments","title":"\ud83d\udd10 Pagos (latam_payments)","text":"<p>El paquete <code>latam_payments</code> implementa una interfaz unificada para procesadores de pago regionales:</p> Pa\u00eds Gateways M\u00e9todos \ud83c\udde8\ud83c\uddf7 Costa Rica OnvoPay, Tilopay Cards, SINPE \ud83c\udde8\ud83c\uddf4 Colombia Wompi Cards, PSE, Nequi \ud83c\uddf2\ud83c\uddfd Mexico OpenPay, Conekta Cards, SPEI, OXXO \ud83c\udde7\ud83c\uddf7 Brazil Mercado Pago Cards, PIX, Boleto"},{"location":"docs/backend/","title":"Backend API","text":"<p>AltruPets Backend es una API GraphQL construida con NestJS 11 y Express 5.</p>"},{"location":"docs/backend/#informacion-general","title":"Informaci\u00f3n General","text":"Propiedad Valor Framework NestJS 11 Runtime Node.js 20 API GraphQL (Apollo Server 5.x) + REST Base URL <code>/graphql</code>"},{"location":"docs/backend/#endpoints","title":"Endpoints","text":""},{"location":"docs/backend/#graphql","title":"GraphQL","text":"<pre><code>POST /graphql\nContent-Type: application/json\n</code></pre>"},{"location":"docs/backend/#rest","title":"REST","text":"Endpoint M\u00e9todo Descripci\u00f3n <code>/health</code> GET Health check <code>/login</code> GET/POST Login web <code>/logout</code> POST Logout web <code>/admin/*</code> GET Panel admin (Inertia) <code>/b2g/*</code> GET Panel B2G (Inertia)"},{"location":"docs/backend/#autenticacion","title":"Autenticaci\u00f3n","text":"<p>La API usa JWT con passport-jwt.</p>"},{"location":"docs/backend/#headers-requeridos","title":"Headers requeridos","text":"<pre><code>Authorization: Bearer &lt;token&gt;\n</code></pre>"},{"location":"docs/backend/#login","title":"Login","text":"<pre><code>mutation Login($input: LoginInput!) {\n  login(loginInput: $input) {\n    access_token\n    expires_in\n  }\n}\n</code></pre> <p>Variables:</p> <pre><code>{\n  \"input\": {\n    \"username\": \"usuario\",\n    \"password\": \"contrase\u00f1a\"\n  }\n}\n</code></pre>"},{"location":"docs/backend/#queries","title":"Queries","text":"Query Descripci\u00f3n Auth <code>users</code> Lista usuarios Admin <code>user(id)</code> Usuario por ID Admin <code>currentUser</code> Usuario autenticado JWT <code>profile</code> Perfil del usuario JWT <code>searchOrganizations</code> Buscar organizaciones P\u00fablico <code>getCaptureRequests</code> Lista de capturas Autenticado"},{"location":"docs/backend/#mutations","title":"Mutations","text":"Mutation Descripci\u00f3n Auth <code>register</code> Registrar usuario P\u00fablico <code>login</code> Autenticar usuario P\u00fablico <code>createUser</code> Crear usuario Admin <code>updateUser</code> Actualizar usuario Admin <code>deleteUser</code> Eliminar usuario Admin <code>updateUserProfile</code> Actualizar perfil JWT <code>createCaptureRequest</code> Crear captura P\u00fablico"},{"location":"docs/backend/#ejemplos","title":"Ejemplos","text":""},{"location":"docs/backend/#obtener-usuario-actual","title":"Obtener usuario actual","text":"<pre><code>query {\n  currentUser {\n    id\n    username\n    email\n    roles\n  }\n}\n</code></pre>"},{"location":"docs/backend/#crear-captura","title":"Crear captura","text":"<pre><code>mutation CreateCapture($input: CreateCaptureInput!) {\n  createCaptureRequest(input: $input) {\n    id\n    imageUrl\n    latitude\n    longitude\n  }\n}\n</code></pre>"},{"location":"docs/backend/#errores","title":"Errores","text":"<p>Los errores siguen el formato est\u00e1ndar de GraphQL:</p> <pre><code>{\n  \"errors\": [\n    {\n      \"message\": \"Error description\",\n      \"path\": [\"mutationName\"],\n      \"extensions\": {\n        \"code\": \"ERROR_CODE\"\n      }\n    }\n  ]\n}\n</code></pre>"},{"location":"docs/backend/#codigos-de-error-comunes","title":"C\u00f3digos de error comunes","text":"C\u00f3digo Descripci\u00f3n <code>GRAPHQL_VALIDATION_FAILED</code> Error de validaci\u00f3n <code>UNAUTHENTICATED</code> Token faltante o inv\u00e1lido <code>FORBIDDEN</code> Permisos insuficientes <code>INTERNAL_SERVER_ERROR</code> Error del servidor"},{"location":"docs/backend/#rate-limiting","title":"Rate Limiting","text":"<p>Actualmente no implementado. Planificado para v1.1.0.</p>"},{"location":"docs/backend/#mas-informacion","title":"M\u00e1s informaci\u00f3n","text":"<p>Ver API Reference completo para detalles de cada operaci\u00f3n.</p>"},{"location":"docs/backend/api/","title":"AltruPets Backend API Documentation","text":""},{"location":"docs/backend/api/#overview","title":"Overview","text":"<p>The AltruPets Backend provides a GraphQL API for managing users, organizations, captures, and authentication.</p> <p>Base URL: <code>http://localhost:3001/graphql</code> (dev)</p>"},{"location":"docs/backend/api/#authentication","title":"Authentication","text":"<p>All authenticated requests require a JWT token in the Authorization header:</p> <pre><code>Authorization: Bearer &lt;access_token&gt;\n</code></pre>"},{"location":"docs/backend/api/#graphql-api","title":"GraphQL API","text":""},{"location":"docs/backend/api/#queries","title":"Queries","text":"Query Description Auth Required <code>users</code> List all users SUPER_USER, GOVERNMENT_ADMIN <code>user(id: ID!)</code> Get user by ID SUPER_USER, GOVERNMENT_ADMIN <code>currentUser</code> Get authenticated user Yes <code>profile</code> Get user profile Yes <code>adminOnlyData</code> Admin-only test query GOVERNMENT_ADMIN <code>searchOrganizations</code> Search organizations No <code>organization(id: ID!)</code> Get organization by ID No <code>organizationMemberships(orgId: ID!)</code> Get org members Yes <code>myMemberships</code> Get user's memberships Yes <code>getCaptureRequests</code> List capture requests WATCHER, GOVERNMENT_ADMIN, SUPER_USER"},{"location":"docs/backend/api/#mutations","title":"Mutations","text":"Mutation Description Auth Required <code>register</code> Register new user No <code>login</code> Authenticate user No <code>createUser</code> Create user (admin) SUPER_USER, GOVERNMENT_ADMIN <code>updateUser</code> Update user (admin) SUPER_USER, GOVERNMENT_ADMIN <code>deleteUser</code> Delete user (admin) SUPER_USER, GOVERNMENT_ADMIN <code>updateUserProfile</code> Update own profile Yes <code>registerOrganization</code> Register new org Yes <code>requestMembership</code> Request org membership Yes <code>approveMembership</code> Approve membership request Yes <code>rejectMembership</code> Reject membership request Yes <code>assignRole</code> Assign org role Yes <code>createCaptureRequest</code> Submit capture No"},{"location":"docs/backend/api/#types","title":"Types","text":""},{"location":"docs/backend/api/#user","title":"User","text":"<pre><code>type User {\n  id: ID!\n  username: String!\n  email: String\n  firstName: String\n  lastName: String\n  bio: String\n  roles: [UserRole!]!\n  isActive: Boolean!\n  isVerified: Boolean!\n  avatarBase64: String\n  avatarUrl: String\n  organizationId: ID\n  latitude: Float\n  longitude: Float\n  occupation: String\n  incomeSource: String\n  createdAt: DateTime!\n  updatedAt: DateTime!\n}\n</code></pre>"},{"location":"docs/backend/api/#userrole","title":"UserRole","text":"<pre><code>enum UserRole {\n  SUPER_USER\n  GOVERNMENT_ADMIN\n  WATCHER\n}\n</code></pre>"},{"location":"docs/backend/api/#authpayload","title":"AuthPayload","text":"<pre><code>type AuthPayload {\n  access_token: String!\n  expires_in: Int!\n  refresh_token: String\n}\n</code></pre>"},{"location":"docs/backend/api/#organization","title":"Organization","text":"<pre><code>type Organization {\n  id: ID!\n  name: String!\n  description: String\n  type: String\n  address: String\n  latitude: Float\n  longitude: Float\n  createdAt: DateTime!\n  updatedAt: DateTime!\n}\n</code></pre>"},{"location":"docs/backend/api/#capturerequest","title":"CaptureRequest","text":"<pre><code>type CaptureRequest {\n  id: ID!\n  imageUrl: String!\n  latitude: Float!\n  longitude: Float!\n  capturedAt: DateTime!\n  notes: String\n  createdAt: DateTime!\n}\n</code></pre>"},{"location":"docs/backend/api/#example-queries","title":"Example Queries","text":""},{"location":"docs/backend/api/#login","title":"Login","text":"<pre><code>mutation Login($input: LoginInput!) {\n  login(loginInput: $input) {\n    access_token\n    expires_in\n  }\n}\n</code></pre> <p>Variables:</p> <pre><code>{\n  \"input\": {\n    \"username\": \"admin\",\n    \"password\": \"yourpassword\"\n  }\n}\n</code></pre>"},{"location":"docs/backend/api/#get-current-user","title":"Get Current User","text":"<pre><code>query {\n  currentUser {\n    id\n    username\n    email\n    roles\n    firstName\n    lastName\n  }\n}\n</code></pre>"},{"location":"docs/backend/api/#list-users-admin","title":"List Users (Admin)","text":"<pre><code>query {\n  users {\n    id\n    username\n    email\n    roles\n    isActive\n    createdAt\n  }\n}\n</code></pre>"},{"location":"docs/backend/api/#update-profile","title":"Update Profile","text":"<pre><code>mutation UpdateProfile($input: UpdateUserInput!) {\n  updateUserProfile(input: $input) {\n    id\n    firstName\n    lastName\n    email\n    bio\n  }\n}\n</code></pre>"},{"location":"docs/backend/api/#create-capture-request","title":"Create Capture Request","text":"<pre><code>mutation CreateCapture($input: CreateCaptureInput!) {\n  createCaptureRequest(input: $input) {\n    id\n    imageUrl\n    latitude\n    longitude\n    capturedAt\n  }\n}\n</code></pre>"},{"location":"docs/backend/api/#rest-endpoints","title":"REST Endpoints","text":"Endpoint Method Description <code>/</code> GET Health check (returns \"Hello World!\") <code>/health</code> GET Detailed health status <code>/login</code> GET Login page (Inertia) <code>/login</code> POST Web login form <code>/logout</code> POST Web logout <code>/admin</code> GET Admin panel (Inertia) <code>/admin/users</code> GET Admin users list (Inertia) <code>/b2g</code> GET B2G panel (Inertia) <code>/b2g/captures</code> GET B2G captures list (Inertia)"},{"location":"docs/backend/api/#error-handling","title":"Error Handling","text":"<p>GraphQL errors follow this format:</p> <pre><code>{\n  \"errors\": [\n    {\n      \"message\": \"Error description\",\n      \"path\": [\"mutationName\"],\n      \"extensions\": {\n        \"code\": \"ERROR_CODE\"\n      }\n    }\n  ],\n  \"data\": null\n}\n</code></pre>"},{"location":"docs/backend/api/#common-error-codes","title":"Common Error Codes","text":"Code Description <code>GRAPHQL_VALIDATION_FAILED</code> Invalid query syntax <code>INTERNAL_SERVER_ERROR</code> Server-side error <code>UNAUTHENTICATED</code> Missing or invalid token <code>FORBIDDEN</code> Insufficient permissions"},{"location":"docs/backend/api/#rate-limiting","title":"Rate Limiting","text":"<p>Currently not implemented. Will be added in v1.1.0.</p>"},{"location":"docs/backend/api/#database-migrations","title":"Database Migrations","text":"Migration Description <code>AddUserFields1708152000000</code> Adds email, bio, organizationId, geolocation, status fields <code>AddDonorFields1708153000000</code> Adds occupation, incomeSource fields <code>MigrateAvatarToUrl1771407449000</code> Adds avatarUrl, avatarStorageProvider fields <p>Run migrations:</p> <pre><code>cd apps/backend\nnpm run migration:run\n</code></pre>"},{"location":"docs/backend/api/#development","title":"Development","text":""},{"location":"docs/backend/api/#running-locally","title":"Running Locally","text":"<pre><code># Start dependencies\nmake dev-postgres-port-forward\n\n# Run backend\ncd apps/backend\nnpm run start:dev\n</code></pre>"},{"location":"docs/backend/api/#running-tests","title":"Running Tests","text":"<pre><code>make dev-backend-test      # Unit tests\nmake dev-backend-test-e2e  # E2E tests\n</code></pre>"},{"location":"docs/backend/api/#sync-secrets","title":"Sync Secrets","text":"<pre><code>make dev-infisical-sync-cli  # Sync from Infisical CLI\n</code></pre>"},{"location":"docs/backend/auth/","title":"Autenticaci\u00f3n","text":"<p>El backend utiliza JWT (JSON Web Tokens) para autenticaci\u00f3n.</p>"},{"location":"docs/backend/auth/#flujo-de-autenticacion","title":"Flujo de Autenticaci\u00f3n","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     POST /graphql          \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502   Cliente   \u2502 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25b6 \u2502   Backend   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    {login mutation}        \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                        \u2502\n                        \u25bc\n                 { access_token }\n                        \u2502\n        \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n        \u2502                               \u2502\n        \u25bc                               \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510              \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 GraphQL Query \u2502              \u2502  REST Call    \u2502\n\u2502 Authorization \u2502              \u2502 Authorization \u2502\n\u2502 Bearer &lt;jwt&gt;  \u2502              \u2502 Bearer &lt;jwt&gt;  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518              \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"docs/backend/auth/#login","title":"Login","text":""},{"location":"docs/backend/auth/#graphql","title":"GraphQL","text":"<pre><code>mutation Login($username: String!, $password: String!) {\n  login(loginInput: { username: $username, password: $password }) {\n    access_token\n    expires_in\n  }\n}\n</code></pre>"},{"location":"docs/backend/auth/#rest-web","title":"REST (Web)","text":"<pre><code>POST /login\nContent-Type: application/json\n\n{\n  \"username\": \"usuario\",\n  \"password\": \"contrase\u00f1a\"\n}\n</code></pre>"},{"location":"docs/backend/auth/#uso-del-token","title":"Uso del Token","text":"<p>Incluir en headers:</p> <pre><code>Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...\n</code></pre>"},{"location":"docs/backend/auth/#roles","title":"Roles","text":"Rol Descripci\u00f3n <code>SUPER_USER</code> Acceso total <code>GOVERNMENT_ADMIN</code> Admin gubernamental <code>WATCHER</code> Solo lectura"},{"location":"docs/backend/auth/#expiracion","title":"Expiraci\u00f3n","text":"<ul> <li>Token expira en 1 hora</li> <li>Refresh token disponible para renovaci\u00f3n</li> </ul>"},{"location":"docs/backend/auth/#almacenamiento-seguro","title":"Almacenamiento Seguro","text":"<ul> <li>Tokens almacenados en httpOnly cookies (web)</li> <li>AsyncStorage con encriptaci\u00f3n (mobile)</li> <li>Nunca en localStorage</li> </ul>"},{"location":"docs/backend/changelog/","title":"Changelog","text":"<p>All notable changes to the AltruPets Backend will be documented in this file.</p> <p>The format is based on Keep a Changelog, and this project adheres to Semantic Versioning.</p>"},{"location":"docs/backend/changelog/#100-2025-02-19","title":"[1.0.0] - 2025-02-19","text":""},{"location":"docs/backend/changelog/#added","title":"Added","text":"<ul> <li>Initial stable release of AltruPets Backend</li> <li>Security Scanner - Dedicated Docker image for DevSecOps scanning</li> <li>Separate container with Trivy, Checkov, tfsec, Trufflehog</li> <li>Runs as Kubernetes Jobs/CronJobs</li> <li>See <code>infrastructure/docker/security-scanner/CHANGELOG.md</code> for details</li> <li>GraphQL API with Apollo Server 5.x</li> <li>REST API endpoints for admin and B2G panels</li> <li>JWT authentication with passport-jwt</li> <li>TypeORM integration with PostgreSQL</li> <li>Inertia.js support for server-driven SPA</li> <li>Health checks endpoint at <code>/health</code></li> <li>Docker containerization with multi-stage builds</li> <li>Kubernetes deployment manifests</li> </ul>"},{"location":"docs/backend/changelog/#changed","title":"Changed","text":"<ul> <li>BREAKING: Migrated from Express 4.x to Express 5.2.1</li> <li>Express 5 restored <code>app.router</code> which was deprecated in Express 4.19+</li> <li>No custom adapter needed for NestJS 11 compatibility</li> <li>BREAKING: Replaced <code>nestjs-inertia</code> with <code>@lapc506/nestjs-inertia@1.0.0</code></li> <li>Fixed broken entrypoint (<code>dist/index.js</code> \u2192 <code>dist/src/index.js</code>)</li> <li>Updated peer dependencies for NestJS 11.x compatibility</li> <li>Express 5.x compatible</li> <li>Published at: https://www.npmjs.com/package/@lapc506/nestjs-inertia</li> </ul>"},{"location":"docs/backend/changelog/#dependencies","title":"Dependencies","text":"Package Version nestjs/common ^11.0.1 nestjs/core ^11.0.1 nestjs/platform-express ^11.0.1 express ^5.2.1 lapc506/nestjs-inertia ^1.0.0 apollo/server ^5.2.0 typeorm ^0.3.19 pg ^8.16.3"},{"location":"docs/backend/changelog/#infrastructure","title":"Infrastructure","text":"<ul> <li>Minikube-based local development environment</li> <li>Kubernetes deployments for backend, web-superusers, web-b2g</li> <li>PostgreSQL StatefulSet</li> <li>Gateway API with HTTPRoutes</li> <li>cert-manager module for Let's Encrypt TLS certificates</li> <li>DNS-01 challenge via Cloudflare</li> <li>Staging and Production ClusterIssuers</li> <li>Terraform module at <code>infrastructure/terraform/modules/kubernetes/cert-manager</code></li> <li>Infisical integration for secrets management</li> <li>CLI sync script at <code>infrastructure/scripts/infisical-sync.sh</code></li> <li>Removed legacy <code>seed-superuser-minikube.sh</code> script</li> <li>TLS/HTTPS support in Gateway API module</li> <li>Configurable HTTPS listener</li> <li>NodePort service for both HTTP and HTTPS</li> </ul>"},{"location":"docs/backend/changelog/#known-issues","title":"Known Issues","text":"<ul> <li><code>@types/express</code> v5.x may have incomplete type definitions for some Express 5 features</li> <li>Some npm packages may still have peer dependency warnings for Express 5</li> </ul>"},{"location":"docs/backend/changelog/#migration-notes","title":"Migration Notes","text":""},{"location":"docs/backend/changelog/#from-pre-100-to-100","title":"From pre-1.0.0 to 1.0.0","text":"<ol> <li> <p>Update package dependencies: <code>bash    npm install express@^5.2.1 @lapc506/nestjs-inertia@^1.0.0</code></p> </li> <li> <p>No code changes required for most applications using:</p> </li> <li>Standard NestJS patterns</li> <li>Inertia.js middleware</li> <li>GraphQL resolvers</li> <li> <p>TypeORM repositories</p> </li> <li> <p>If using wildcards in routes (not used in this project):    ```typescript    // Express 4    app.use('*', handler)</p> </li> </ol> <p>// Express 5    app.use('{*splat}', handler)    ```</p> <ol> <li>If using res.send(status) (not used in this project):    ```typescript    // Express 4    res.send(200)</li> </ol> <p>// Express 5    res.sendStatus(200)    ```</p>"},{"location":"docs/backend/changelog/#release-checklist","title":"Release Checklist","text":""},{"location":"docs/backend/changelog/#v100-readiness","title":"v1.0.0 Readiness","text":"Criteria Status Core functionality stable \u2705 Authentication working \u2705 GraphQL API functional \u2705 Database connectivity \u2705 Environment configuration \u2705 Docker builds \u2705 Kubernetes deployments \u2705 Health checks \u2705 Error handling \u2705 Security (JWT, validation) \u2705 Unit tests \u2705 1/1 passing E2E tests \u2705 1/1 passing Security audit \u2705 0 vulnerabilities Documentation \u2705 This CHANGELOG"},{"location":"docs/backend/changelog/#testing","title":"Testing","text":"<p>Unit tests:</p> <pre><code>make dev-backend-test\n# Output: 1/1 passing\n</code></pre> <p>E2E tests:</p> <pre><code>make dev-backend-test-e2e\n# Output: 1/1 passing\n</code></pre> <p>Note: E2E tests use a lightweight TestModule without database dependencies for fast execution.</p>"},{"location":"docs/backend/changelog/#pre-release-tasks","title":"Pre-release Tasks","text":"<ul> <li> Security audit: <code>npm audit</code> (0 vulnerabilities)</li> <li> Unit tests passing (1/1)</li> <li> E2E tests passing (1/1)</li> <li> Verify all GraphQL queries/mutations</li> <li> Test authentication flow end-to-end</li> <li> Review database migration scripts (3 migrations, all with up/down)</li> <li> Update API documentation (<code>apps/backend/API.md</code>)</li> <li> Infisical secrets sync (<code>infrastructure/scripts/infisical-sync.sh</code>)</li> <li> cert-manager Terraform module</li> <li> Gateway API TLS/HTTPS support</li> <li> Create release tag</li> </ul>"},{"location":"docs/backend/changelog/#infrastructure-as-code","title":"Infrastructure as Code","text":""},{"location":"docs/backend/changelog/#terraform-modules","title":"Terraform Modules","text":"Module Path Description cert-manager <code>infrastructure/terraform/modules/kubernetes/cert-manager</code> Let's Encrypt TLS certificates gateway-api <code>infrastructure/terraform/modules/kubernetes/gateway-api</code> NGINX Gateway Fabric with HTTPS support postgres-minikube <code>infrastructure/terraform/modules/database/postgres-minikube</code> PostgreSQL StatefulSet"},{"location":"docs/backend/changelog/#k8s-manifests","title":"K8s Manifests","text":"File Description <code>infrastructure/k8s/cert-manager/cluster-issuer.yaml</code> Let's Encrypt staging + prod issuers <code>infrastructure/k8s/cert-manager/certificate.yaml</code> Certificate for <code>*.altrupets.app</code>"},{"location":"docs/backend/changelog/#scripts","title":"Scripts","text":"Script Description <code>infrastructure/scripts/infisical-sync.sh</code> Sync secrets from Infisical to Kubernetes <code>infrastructure/scripts/infisical-sync.sh --cli</code> Sync using CLI (no operator required)"},{"location":"docs/backend/changelog/#future-roadmap","title":"Future Roadmap","text":""},{"location":"docs/backend/changelog/#v110-planned","title":"v1.1.0 (Planned)","text":"<ul> <li> Redis caching integration</li> <li> Rate limiting</li> <li> OpenAPI/Swagger documentation</li> </ul>"},{"location":"docs/backend/changelog/#v120-planned","title":"v1.2.0 (Planned)","text":"<ul> <li> WebSocket support</li> <li> Real-time notifications</li> <li> Background job queue</li> </ul>"},{"location":"docs/backend/changelog/#v200-future","title":"v2.0.0 (Future)","text":"<ul> <li> Microservices architecture</li> <li> Event-driven communication</li> <li> Multi-tenancy support</li> </ul>"},{"location":"docs/deployment/cicd/","title":"\ud83d\ude80 CI/CD","text":""},{"location":"docs/deployment/cicd/#github-actions","title":"GitHub Actions","text":"<p>El proyecto utiliza GitHub Actions para CI/CD con despliegue en OVHCloud.</p>"},{"location":"docs/deployment/cicd/#pipelines","title":"Pipelines","text":"Pipeline Trigger Entorno <code>ci-build-push.yml</code> Push a main Build im\u00e1genes <code>deploy-qa.yml</code> Push a main QA (OVHCloud) <code>deploy-staging.yml</code> Manual STAGING (OVHCloud) <code>deploy-prod.yml</code> PR a production PROD (OVHCloud)"},{"location":"docs/deployment/cicd/#flujo-de-deploy","title":"Flujo de Deploy","text":"<pre><code>main \u2192 QA (auto) \u2192 STAGING (manual) \u2192 PROD (PR + approvals)\n</code></pre>"},{"location":"docs/deployment/cicd/#secrets-requeridos","title":"Secrets Requeridos","text":"<pre><code>OVH_QA_KUBECONFIG       # Kubeconfig para QA\nOVH_STAGING_KUBECONFIG  # Kubeconfig para Staging\nOVH_PROD_KUBECONFIG     # Kubeconfig para Production\nQA_POSTGRES_PASSWORD\nSTAGING_POSTGRES_PASSWORD\n</code></pre>"},{"location":"docs/deployment/cicd/#ambientes-github","title":"Ambientes GitHub","text":"<ul> <li>qa: Auto-deploy desde main</li> <li>staging: Deploy manual</li> <li>production: Requiere 2 approvals</li> </ul>"},{"location":"docs/deployment/harbor/","title":"Harbor Registry","text":""},{"location":"docs/deployment/harbor/#que-es-harbor","title":"\u00bfQu\u00e9 es Harbor?","text":"<p>Harbor es un registry de contenedores open source (CNCF Graduated) que proporciona:</p> <ul> <li>Docker Registry privado</li> <li>Helm Chart repository</li> <li>Vulnerability scanning (Trivy integrado)</li> <li>RBAC (Role-Based Access Control)</li> <li>Replication a otros registries</li> <li>Image signing (Notary)</li> <li>Web UI</li> </ul>"},{"location":"docs/deployment/harbor/#instalacion-en-dev","title":"Instalaci\u00f3n en DEV","text":"<pre><code>make dev-harbor-deploy\n</code></pre> <p>Esto instala Harbor via Helm en Minikube con NodePort.</p>"},{"location":"docs/deployment/harbor/#acceso","title":"Acceso","text":"Campo Valor URL https://localhost:30003 Username admin Password Harbor12345"},{"location":"docs/deployment/harbor/#configurar-dockerpodman","title":"Configurar Docker/Podman","text":""},{"location":"docs/deployment/harbor/#1-confiar-en-el-certificado","title":"1. Confiar en el certificado","text":"<pre><code># Crear directorio de certificados\nsudo mkdir -p /etc/docker/certs.d/localhost:30003\n\n# Obtener certificado de Harbor\nkubectl get secret -n harbor harbor-ingress -o jsonpath='{.data.ca\\.crt}' | base64 -d | sudo tee /etc/docker/certs.d/localhost:30003/ca.crt\n</code></pre>"},{"location":"docs/deployment/harbor/#2-login","title":"2. Login","text":"<pre><code># Podman\necho 'Harbor12345' | podman login localhost:30003 -u admin --password-stdin\n\n# Docker\necho 'Harbor12345' | docker login localhost:30003 -u admin --password-stdin\n</code></pre>"},{"location":"docs/deployment/harbor/#push-de-imagenes","title":"Push de Im\u00e1genes","text":""},{"location":"docs/deployment/harbor/#taggear-imagen","title":"Taggear imagen","text":"<pre><code># Backend\npodman tag localhost/altrupets-backend:dev localhost:30003/altrupets/backend:dev\n\n# Web apps\npodman tag localhost/altrupets-web-superusers:dev localhost:30003/altrupets/web-superusers:dev\npodman tag localhost/altrupets-web-b2g:dev localhost:30003/altrupets/web-b2g:dev\n</code></pre>"},{"location":"docs/deployment/harbor/#push","title":"Push","text":"<pre><code>podman push localhost:30003/altrupets/backend:dev\npodman push localhost:30003/altrupets/web-superusers:dev\npodman push localhost:30003/altrupets/web-b2g:dev\n</code></pre>"},{"location":"docs/deployment/harbor/#proyectos","title":"Proyectos","text":"<p>Por defecto, Harbor crea un proyecto <code>library</code>. Crea proyectos para organizar:</p> <pre><code># Via CLI\ncurl -X POST \"https://localhost:30003/api/v2.0/projects\" \\\n  -u \"admin:Harbor12345\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"project_name\": \"altrupets\", \"public\": false}'\n</code></pre> <p>O via Web UI: Projects \u2192 New Project</p>"},{"location":"docs/deployment/harbor/#configurar-kubernetes","title":"Configurar Kubernetes","text":"<p>Para que Minikube pueda pull de Harbor:</p> <pre><code># Crear secret de Docker registry\nkubectl create secret docker-registry harbor-registry \\\n  --docker-server=localhost:30003 \\\n  --docker-username=admin \\\n  --docker-password=Harbor12345 \\\n  -n altrupets-dev\n\n# Patchear service account\nkubectl patch serviceaccount default -n altrupets-dev \\\n  -p '{\"imagePullSecrets\": [{\"name\": \"harbor-registry\"}]}'\n</code></pre>"},{"location":"docs/deployment/harbor/#vulnerability-scanning","title":"Vulnerability Scanning","text":"<p>Harbor incluye Trivy para escaneo autom\u00e1tico:</p> <ol> <li>Push una imagen</li> <li>Harbor escanea autom\u00e1ticamente</li> <li>Ver resultados en Web UI \u2192 Project \u2192 Repositories \u2192 Tag</li> </ol>"},{"location":"docs/deployment/harbor/#harbor-vs-security-scanner","title":"Harbor vs Security Scanner","text":"<p>El proyecto tiene dos herramientas de escaneo de vulnerabilidades que son complementarias, no redundantes:</p> Aspecto Security Scanner Harbor Trivy Cu\u00e1ndo escanea Antes del push (CI/CD) Despu\u00e9s del push (Registry) Qu\u00e9 escanea C\u00f3digo, dependencias, IaC, im\u00e1genes Solo im\u00e1genes Ubicaci\u00f3n Kubernetes Job/CronJob Integrado en Harbor Prop\u00f3sito Pre-push, shift-left Post-push, defense-in-depth Herramientas Trivy, tfsec, checkov, trufflehog, bandit, safety Trivy <p>Flujo de seguridad recomendado:</p> <pre><code>flowchart TB\n    subgraph Dev[\"1. Development\"]\n        IDE[\"dart analyze&lt;br/&gt;eslint\"]\n    end\n\n    subgraph CI[\"2. Pre-commit / CI\"]\n        Scan[\"make dev-security-scan\"]\n        Trivy[\"Trivy&lt;br/&gt;filesystem\"]\n        Tfsec[\"tfsec&lt;br/&gt;Terraform\"]\n        Checkov[\"checkov&lt;br/&gt;IaC\"]\n        Trufflehog[\"trufflehog&lt;br/&gt;secrets\"]\n        Bandit[\"bandit&lt;br/&gt;Python SAST\"]\n        Safety[\"safety&lt;br/&gt;Python deps\"]\n\n        Scan --&gt; Trivy\n        Scan --&gt; Tfsec\n        Scan --&gt; Checkov\n        Scan --&gt; Trufflehog\n        Scan --&gt; Bandit\n        Scan --&gt; Safety\n    end\n\n    subgraph Registry[\"3. Container Registry (Harbor)\"]\n        Harbor[\"Harbor Trivy&lt;br/&gt;automatic on push\"]\n        Block[\"Block critical&lt;br/&gt;vulnerabilities\"]\n\n        Harbor --&gt; Block\n    end\n\n    subgraph Runtime[\"4. Runtime (Production)\"]\n        K8s[\"Kubernetes&lt;br/&gt;security policies\"]\n    end\n\n    Dev --&gt; CI\n    CI --&gt; Registry\n    Registry --&gt; Runtime\n</code></pre> <p>Beneficio: Vulnerabilidades detectadas en paso 2 nunca llegan al paso 3.</p>"},{"location":"docs/deployment/harbor/#comparacion-con-alternativas","title":"Comparaci\u00f3n con Alternativas","text":"Feature Harbor GHCR Docker Registry 2 Costo GRATIS 500MB gratis GRATIS Docker Registry \u2705 \u2705 \u2705 Helm Charts \u2705 \u274c \u274c Vulnerability Scan \u2705 Trivy \u2705 Dependabot \u274c RBAC \u2705 \u2705 \u274c UI Web \u2705 \u2705 \u274c On-premise \u2705 \u274c \u2705"},{"location":"docs/deployment/harbor/#comandos-makefile","title":"Comandos Makefile","text":"<pre><code>make dev-harbor-deploy    # Desplegar Harbor\nmake dev-harbor-destroy   # Eliminar Harbor\n</code></pre>"},{"location":"docs/deployment/harbor/#troubleshooting","title":"Troubleshooting","text":""},{"location":"docs/deployment/harbor/#error-x509-certificate-signed-by-unknown-authority","title":"Error: x509: certificate signed by unknown authority","text":"<pre><code># Agregar certificado al trust store\nsudo cp /etc/docker/certs.d/localhost:30003/ca.crt /usr/local/share/ca-certificates/harbor.crt\nsudo update-ca-certificates\n</code></pre>"},{"location":"docs/deployment/harbor/#error-connection-refused","title":"Error: connection refused","text":"<p>Verificar que Harbor est\u00e9 corriendo:</p> <pre><code>kubectl get pods -n harbor\n</code></pre>"},{"location":"docs/deployment/harbor/#reiniciar-harbor","title":"Reiniciar Harbor","text":"<pre><code>kubectl rollout restart deployment -n harbor\n</code></pre>"},{"location":"docs/deployment/harbor/#referencias","title":"Referencias","text":"<ul> <li>Harbor Documentation</li> <li>Harbor Helm Chart</li> <li>Trivy Scanner</li> </ul>"},{"location":"docs/deployment/kubernetes/","title":"Kubernetes","text":""},{"location":"docs/deployment/kubernetes/#arquitectura-de-despliegue","title":"Arquitectura de Despliegue","text":"<p>AltruPets se despliega en OVHCloud Managed Kubernetes para QA, STAGING y PROD.</p> <pre><code>flowchart TB\n    NGINX[NGINX Gateway] --&gt; Backend1[Backend]\n    NGINX --&gt; Backend2[Backend]\n    NGINX --&gt; Backend3[Backend]\n\n    Backend1 --&gt; PG[(PostgreSQL)]\n    Backend2 --&gt; PG\n    Backend3 --&gt; PG\n\n    Backend1 --&gt; Valkey[(Valkey)]\n    Backend2 --&gt; Valkey\n    Backend3 --&gt; Valkey\n</code></pre>"},{"location":"docs/deployment/kubernetes/#flujos-de-deployment","title":"Flujos de Deployment","text":""},{"location":"docs/deployment/kubernetes/#manual-sin-argocd","title":"Manual (sin ArgoCD)","text":"<p>Para desarrollo local con Minikube:</p> <pre><code>make setup &amp;&amp; make dev-minikube-deploy &amp;&amp; make dev-terraform-deploy &amp;&amp; \\\nmake dev-images-build &amp;&amp; make dev-backend-tf-deploy &amp;&amp; \\\nmake dev-superusers-tf-deploy &amp;&amp; make dev-b2g-tf-deploy &amp;&amp; make dev-gateway-start\n</code></pre>"},{"location":"docs/deployment/kubernetes/#gitops-con-argocd","title":"GitOps (con ArgoCD)","text":"<p>Para ambientes QA, Staging y Production:</p> <pre><code>make setup &amp;&amp; make dev-minikube-deploy &amp;&amp; make dev-terraform-deploy &amp;&amp; \\\nmake dev-images-build &amp;&amp; make dev-argocd-deploy &amp;&amp; make dev-gateway-start\n</code></pre>"},{"location":"docs/deployment/kubernetes/#kustomize-structure","title":"Kustomize Structure","text":"<pre><code>k8s/\n\u251c\u2500\u2500 base/          # Manifiestos base\n\u251c\u2500\u2500 overlays/      # Environments overrides\n\u2502   \u2514\u2500\u2500 dev/      # Dev environment\n\u2514\u2500\u2500 argocd/      # ArgoCD applications\n</code></pre>"},{"location":"docs/deployment/kubernetes/#targets-de-deploy","title":"Targets de Deploy","text":"Target Descripci\u00f3n Path <code>dev-backend-tf-deploy</code> Backend API <code>k8s/overlays/dev/backend</code> <code>dev-superusers-tf-deploy</code> CRUD Superusers <code>k8s/overlays/dev/web-superusers</code> <code>dev-b2g-tf-deploy</code> B2G Frontend <code>k8s/overlays/dev/web-b2g</code>"},{"location":"docs/deployment/kubernetes/#entornos","title":"Entornos","text":"Entorno Prop\u00f3sito Kubeconfig Secret DEV Local Minikube N/A (local) QA Ephemeral testing <code>OVH_QA_KUBECONFIG</code> STAGING Pre-production <code>OVH_STAGING_KUBECONFIG</code> PROD Production <code>OVH_PROD_KUBECONFIG</code>"},{"location":"docs/deployment/kubernetes/#comandos-utiles","title":"Comandos \u00datiles","text":"<pre><code># Ver pods\nkubectl get pods -n altrupets-dev\n\n# Ver servicios\nkubectl get services -n altrupets-dev\n\n# Logs\nkubectl logs -f deployment/backend -n altrupets-dev\n\n# Escalar\nkubectl scale deployment/backend --replicas=3 -n altrupets-dev\n\n# Aplicar manifiestos manualmente\nkubectl apply -k k8s/overlays/dev/backend\n</code></pre>"},{"location":"docs/deployment/kubernetes/#ovh-managed-postgresql","title":"OVH Managed PostgreSQL","text":"<p>Producci\u00f3n utiliza OVH Managed PostgreSQL en lugar de PostgreSQL self-managed: - Alta disponibilidad - Backups autom\u00e1ticos - SSL habilitado</p>"},{"location":"docs/deployment/secrets/","title":"Secrets con Infisical","text":"<p>AltruPets utiliza Infisical para gesti\u00f3n centralizada de secrets.</p>"},{"location":"docs/deployment/secrets/#por-que-infisical","title":"Por qu\u00e9 Infisical","text":"<ul> <li>Cloud-agnostic (funciona en Minikube, OVHCloud, AWS)</li> <li>Sincronizaci\u00f3n autom\u00e1tica a Kubernetes</li> <li>Integraci\u00f3n con Terraform y CLI</li> <li>Open source con opci\u00f3n cloud</li> </ul>"},{"location":"docs/deployment/secrets/#configuracion","title":"Configuraci\u00f3n","text":""},{"location":"docs/deployment/secrets/#1-login","title":"1. Login","text":"<pre><code>infisical login\n</code></pre>"},{"location":"docs/deployment/secrets/#2-sincronizar-secrets","title":"2. Sincronizar secrets","text":"<pre><code>make dev-infisical-sync-cli\n</code></pre> <p>O manualmente:</p> <pre><code>infisical export --env=dev --projectId &lt;PROJECT_ID&gt; --format=json | \\\n  jq -r '.[] | \"\\(.key)=\\(.value)\"' &gt; secrets.env\n\nkubectl create secret generic backend-secret \\\n  --from-env-file=secrets.env \\\n  -n altrupets-dev \\\n  --dry-run=client -o yaml | kubectl apply -f -\n</code></pre>"},{"location":"docs/deployment/secrets/#secrets-sincronizados","title":"Secrets sincronizados","text":"Secret Descripci\u00f3n <code>DB_HOST</code> Host de PostgreSQL <code>DB_USERNAME</code> Usuario de BD <code>DB_PASSWORD</code> Contrase\u00f1a de BD <code>DB_NAME</code> Nombre de BD <code>JWT_SECRET</code> Secret para JWT <code>SEED_ADMIN_USERNAME</code> Usuario admin inicial <code>SEED_ADMIN_PASSWORD</code> Contrase\u00f1a admin inicial"},{"location":"docs/deployment/secrets/#estructura-en-infisical","title":"Estructura en Infisical","text":"<pre><code>Project: altrupets-monorepo\n\u251c\u2500\u2500 Environment: dev\n\u2502   \u2514\u2500\u2500 Secrets: DB_*, JWT_SECRET, SEED_ADMIN_*\n\u251c\u2500\u2500 Environment: qa\n\u2502   \u2514\u2500\u2500 Secrets: ...\n\u251c\u2500\u2500 Environment: staging\n\u2502   \u2514\u2500\u2500 Secrets: ...\n\u2514\u2500\u2500 Environment: prod\n    \u2514\u2500\u2500 Secrets: ...\n</code></pre>"},{"location":"docs/deployment/secrets/#script-de-sincronizacion","title":"Script de sincronizaci\u00f3n","text":"<pre><code># Usar el script incluido\n./infrastructure/scripts/infisical-sync.sh --cli\n</code></pre>"},{"location":"docs/deployment/secrets/#troubleshooting","title":"Troubleshooting","text":""},{"location":"docs/deployment/secrets/#secrets-no-sincronizados","title":"Secrets no sincronizados","text":"<pre><code># Verificar login\ninfisical user\n\n# Exportar manualmente\ninfisical export --env=dev --projectId &lt;ID&gt;\n</code></pre>"},{"location":"docs/deployment/secrets/#secret-desactualizado-en-kubernetes","title":"Secret desactualizado en Kubernetes","text":"<pre><code># Forzar resincronizaci\u00f3n\nmake dev-infisical-sync-cli\n\n# Reiniciar pods\nkubectl rollout restart deployment/backend -n altrupets-dev\n</code></pre>"},{"location":"docs/deployment/secrets/#seguridad","title":"Seguridad","text":"<ul> <li>Tokens con permisos m\u00ednimos</li> <li>IP whitelist en Cloudflare API tokens</li> <li>Secrets rotados cada 90 d\u00edas</li> <li>Auditor\u00eda en Infisical dashboard</li> </ul>"},{"location":"docs/deployment/tls/","title":"TLS/HTTPS","text":"<p>AltruPets utiliza Let's Encrypt para certificados TLS autom\u00e1ticos.</p>"},{"location":"docs/deployment/tls/#arquitectura","title":"Arquitectura","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502   Cloudflare    \u2502 DNS Provider\n\u2502   (DNS-01)      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502\n         \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  cert-manager   \u2502 Gesti\u00f3n de certificados\n\u2502  (Kubernetes)   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502\n         \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 NGINX Gateway   \u2502 TLS Termination\n\u2502    Fabric       \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"docs/deployment/tls/#componentes","title":"Componentes","text":""},{"location":"docs/deployment/tls/#cert-manager","title":"cert-manager","text":"<pre><code># Instalaci\u00f3n\nhelm install cert-manager jetstack/cert-manager \\\n  --namespace cert-manager \\\n  --create-namespace \\\n  --set crds.enabled=true\n</code></pre>"},{"location":"docs/deployment/tls/#clusterissuers","title":"ClusterIssuers","text":"Issuer Uso <code>letsencrypt-staging</code> Desarrollo, pruebas <code>letsencrypt-prod</code> Producci\u00f3n"},{"location":"docs/deployment/tls/#certificate","title":"Certificate","text":"<pre><code>apiVersion: cert-manager.io/v1\nkind: Certificate\nmetadata:\n  name: altrupets-app-tls\nspec:\n  secretName: altrupets-app-tls\n  issuerRef:\n    name: letsencrypt-staging  # o letsencrypt-prod\n    kind: ClusterIssuer\n  dnsNames:\n    - altrupets.app\n    - \"*.altrupets.app\"\n</code></pre>"},{"location":"docs/deployment/tls/#configuracion","title":"Configuraci\u00f3n","text":""},{"location":"docs/deployment/tls/#variables-requeridas","title":"Variables requeridas","text":"Variable Descripci\u00f3n <code>CLOUDFLARE_API_TOKEN</code> Token con permisos DNS edit <code>CLOUDFLARE_ZONE_ID</code> ID de la zona en Cloudflare"},{"location":"docs/deployment/tls/#terraform","title":"Terraform","text":"<pre><code>module \"cert_manager\" {\n  source = \"../../modules/kubernetes/cert-manager\"\n\n  environment           = \"dev\"\n  namespace             = \"altrupets-dev\"\n  domain_name           = \"altrupets.app\"\n  acme_email            = \"altrupets.workspace@gmail.com\"\n  cloudflare_api_token  = var.cloudflare_api_token\n}\n</code></pre>"},{"location":"docs/deployment/tls/#validacion-dns-01","title":"Validaci\u00f3n DNS-01","text":"<ol> <li>cert-manager crea registro TXT en <code>_acme-challenge.altrupets.app</code></li> <li>Let's Encrypt valida el registro</li> <li>cert-manager emite el certificado</li> <li>Secret creado en <code>altrupets-app-tls</code></li> </ol>"},{"location":"docs/deployment/tls/#ambientes","title":"Ambientes","text":"Ambiente Issuer Dominio DEV staging localhost (sin TLS) QA staging qa.altrupets.app STAGING prod staging.altrupets.app PROD prod altrupets.app"},{"location":"docs/deployment/tls/#troubleshooting","title":"Troubleshooting","text":""},{"location":"docs/deployment/tls/#certificate-pending","title":"Certificate pending","text":"<pre><code>kubectl describe certificate altrupets-app-tls -n altrupets-dev\nkubectl get challenge -n altrupets-dev\n</code></pre>"},{"location":"docs/deployment/tls/#dns-propagation","title":"DNS propagation","text":"<pre><code>dig TXT _acme-challenge.altrupets.app @1.1.1.1\n</code></pre>"},{"location":"docs/deployment/tls/#logs","title":"Logs","text":"<pre><code>kubectl logs -n cert-manager deployment/cert-manager\n</code></pre>"},{"location":"docs/deployment/tls/#renovacion","title":"Renovaci\u00f3n","text":"<p>Los certificados se renuevan autom\u00e1ticamente 30 d\u00edas antes de expirar.</p>"},{"location":"docs/deployment/tls/#rate-limits","title":"Rate Limits","text":"<p>Let's Encrypt tiene l\u00edmites: - Staging: sin l\u00edmite estricto - Production: 50 certificados/semana por dominio</p> <p>Usar staging para desarrollo.</p>"},{"location":"docs/development/local-setup/","title":"\ud83d\udcbb Desarrollo Local","text":""},{"location":"docs/development/local-setup/#quick-start","title":"Quick Start","text":"<pre><code># Clonar repositorio\ngit clone https://github.com/altrupets/altrupets-monorepo.git\ncd altrupets-monorepo\n\n# Instalar dependencias\ncd apps/mobile &amp;&amp; flutter pub get\ncd apps/backend &amp;&amp; npm install\n\n# Ejecutar desarrollo\nflutter run\nnpm run start:dev\n</code></pre>"},{"location":"docs/development/local-setup/#minikube-desarrollo-local-con-kubernetes","title":"Minikube (Desarrollo Local con Kubernetes)","text":""},{"location":"docs/development/local-setup/#configuracion-obligatoria","title":"Configuraci\u00f3n Obligatoria","text":"<p>Minikube debe configurarse con Podman driver y containerd runtime:</p> <pre><code># Instalar Podman\nsudo apt install podman\n\n# Configurar modo rootless\nminikube config set rootless true\n\n# Iniciar cluster\nminikube start --driver=podman --container-runtime=containerd\n\n# Verificar\nminikube status\nkubectl get nodes\n</code></pre>"},{"location":"docs/development/local-setup/#por-que-podman-containerd","title":"\u00bfPor qu\u00e9 Podman + containerd?","text":"Driver Problema Docker Crea archivos <code>.csm_*</code> y <code>.s3_*</code> con permisos de root Podman (rootless) + containerd Sin archivos hu\u00e9rfanos, sin sudo"},{"location":"docs/development/local-setup/#deploy-local","title":"Deploy Local","text":"<pre><code># Deploy completo\nmake dev-minikube-deploy\n\n# Deploy de micro-frontends\nmake dev-superusers-deploy\nmake dev-b2g-deploy\n\n# Ver servicios\nkubectl get pods -n altrupets-dev\n</code></pre>"},{"location":"docs/development/local-setup/#configuracion","title":"Configuraci\u00f3n","text":"<p>Ver Instalaci\u00f3n y Configuraci\u00f3n</p>"},{"location":"docs/development/local-setup/#troubleshooting","title":"Troubleshooting","text":""},{"location":"docs/development/local-setup/#error-de-dependencias","title":"Error de dependencias","text":"<pre><code># Limpiar cache de Flutter\nflutter clean\nflutter pub get\n\n# Reinstalar node_modules\nrm -rf node_modules\nnpm install\n</code></pre>"},{"location":"docs/development/local-setup/#archivos-huerfanos-de-minikube","title":"Archivos hu\u00e9rfanos de Minikube","text":"<p>Si aparecen archivos <code>.csm_*</code> o <code>.s3_*</code> con permisos de root:</p> <pre><code># Eliminar archivos hu\u00e9rfanos\nsudo rm -f .csm_* .s3_*\n\n# Reiniciar Minikube con configuraci\u00f3n correcta\nminikube delete\nminikube config set rootless true\nminikube start --driver=podman --container-runtime=containerd\n</code></pre>"},{"location":"docs/development/structure/","title":"\ud83d\udcc2 Estructura del Proyecto","text":"<pre><code>altrupets-monorepo/\n\u251c\u2500\u2500 apps/\n\u2502   \u251c\u2500\u2500 backend/           # NestJS + GraphQL\n\u2502   \u2502   \u2514\u2500\u2500 src/\n\u2502   \u2502       \u251c\u2500\u2500 modules/  # M\u00f3dulos por dominio\n\u2502   \u2502       \u251c\u2500\u2500 common/   # Componentes compartidos\n\u2502   \u2502       \u2514\u2500\u2500 config/   # Configuraci\u00f3n\n\u2502   \u2514\u2500\u2500 mobile/           # Flutter\n\u2502       \u251c\u2500\u2500 lib/\n\u2502       \u2502   \u251c\u2500\u2500 core/    # C\u00f3digo compartido\n\u2502       \u2502   \u2502   \u2514\u2500\u2500 payments/  # \ud83d\udfe2 Paquete de pagos\n\u2502       \u2502   \u251c\u2500\u2500 features/ # Features\n\u2502       \u2502   \u2514\u2500\u2500 shared/   # Utilidades\n\u2502       \u2514\u2500\u2500 test/        # Tests\n\u251c\u2500\u2500 docs/                 # Documentaci\u00f3n MkDocs\n\u2502   \u2514\u2500\u2500 content/\n\u251c\u2500\u2500 infrastructure/       # Terraform\n\u251c\u2500\u2500 skills/              # Agent Skills\n\u2514\u2500\u2500 .github/\n    \u2514\u2500\u2500 workflows/       # CI/CD\n</code></pre>"},{"location":"docs/development/testing/","title":"\ud83e\uddea Testing","text":""},{"location":"docs/development/testing/#flutter-tests","title":"Flutter Tests","text":"<pre><code># Unit tests\ncd apps/mobile\nflutter test\n\n# Integration tests\nflutter test integration_test/\n\n# Coverage\nflutter test --coverage\ngenhtml coverage/lcov.info -o coverage/html\n</code></pre>"},{"location":"docs/development/testing/#backend-tests","title":"Backend Tests","text":"<pre><code>cd apps/backend\nnpm test\n\n# Watch mode\nnpm run test:watch\n</code></pre>"},{"location":"docs/development/testing/#e2e-tests","title":"E2E Tests","text":"<pre><code># Cypress (si aplica)\nnpm run e2e\n</code></pre>"},{"location":"docs/getting-started/installation/","title":"\ud83d\ude80 Instalaci\u00f3n","text":""},{"location":"docs/getting-started/installation/#prerrequisitos","title":"Prerrequisitos","text":""},{"location":"docs/getting-started/installation/#software-requerido","title":"Software Requerido","text":"<ul> <li>Flutter 3.x+</li> <li>Dart 3.x+</li> <li>Node.js 18+</li> <li>Docker y Docker Compose</li> <li>AWS CLI (para desarrollo cloud)</li> <li>Terraform 1.x</li> </ul>"},{"location":"docs/getting-started/installation/#instalacion-de-flutter","title":"Instalaci\u00f3n de Flutter","text":"<pre><code># macOS/Linux\ngit clone https://github.com/flutter/flutter.git -d stable\nexport PATH=\"$PATH:$HOME/flutter/bin\"\n\n# Verificar instalaci\u00f3n\nflutter --version\n</code></pre>"},{"location":"docs/getting-started/installation/#instalacion-de-dependencias","title":"Instalaci\u00f3n de Dependencias","text":"<pre><code># Instalar Flutter dependencies\ncd apps/mobile\nflutter pub get\n\n# Instalar Node.js dependencies\ncd apps/backend\nnpm install\n</code></pre>"},{"location":"docs/getting-started/installation/#configuracion-de-ide","title":"Configuraci\u00f3n de IDE","text":""},{"location":"docs/getting-started/installation/#vs-code","title":"VS Code","text":"<p>Extensiones recomendadas: - Flutter - Dart - Docker - YAML - GitLens</p>"},{"location":"docs/getting-started/installation/#intellij-idea-webstorm","title":"IntelliJ IDEA / WebStorm","text":"<ul> <li>Flutter plugin</li> <li>Dart plugin</li> </ul>"},{"location":"docs/getting-started/installation/#proximo-paso","title":"Pr\u00f3ximo Paso","text":"<p>Configuraci\u00f3n inicial \u2192</p>"},{"location":"docs/getting-started/setup/","title":"\u2699\ufe0f Configuraci\u00f3n","text":""},{"location":"docs/getting-started/setup/#variables-de-entorno","title":"Variables de Entorno","text":""},{"location":"docs/getting-started/setup/#archivo-env","title":"Archivo .env","text":"<p>Crea un archivo <code>.env</code> en la ra\u00edz del proyecto:</p> <pre><code>cp .env.example .env\n</code></pre>"},{"location":"docs/getting-started/setup/#variables-requeridas","title":"Variables Requeridas","text":"<pre><code># Backend\nDATABASE_URL=postgresql://user:pass@localhost:5432/altrupets\nREDIS_URL=redis://localhost:6379\nJWT_SECRET=your-secret-key\n\n# Mobile\nAPI_URL=https://api.altrupets.com\nENVIRONMENT=development\n</code></pre>"},{"location":"docs/getting-started/setup/#configuracion-de-firebase","title":"Configuraci\u00f3n de Firebase","text":"<ol> <li>Crea un proyecto en Firebase Console</li> <li>Descarga <code>google-services.json</code> para Android</li> <li>Descarga <code>GoogleService-Info.plist</code> para iOS</li> </ol>"},{"location":"docs/getting-started/setup/#configuracion-de-aws-opcional","title":"Configuraci\u00f3n de AWS (Opcional)","text":"<pre><code># Configurar AWS CLI\naws configure\n\n# Configurar credenciales\nexport AWS_ACCESS_KEY_ID=your-key\nexport AWS_SECRET_ACCESS_KEY=your-secret\n</code></pre>"},{"location":"docs/getting-started/setup/#ejecucion","title":"Ejecuci\u00f3n","text":"<pre><code># Backend\ncd apps/backend\nnpm run start:dev\n\n# Mobile\ncd apps/mobile\nflutter run\n</code></pre>"},{"location":"docs/mcp/","title":"MCP Servers","text":"<p>Model Context Protocol (MCP) servers proporcionan capacidades especializadas para el desarrollo.</p>"},{"location":"docs/mcp/#servidores-disponibles","title":"Servidores Disponibles","text":"Servidor Prop\u00f3sito Comando context7 Documentaci\u00f3n t\u00e9cnica <code>npx -y @upstash/context7-mcp</code> dart Flutter/Dart an\u00e1lisis <code>dart mcp-server</code> graphql GraphQL introspection <code>npx -y @apollographql/apollo-mcp-server</code> mobile-mcp Gesti\u00f3n de dispositivos <code>npx -y @mobilenext/mobile-mcp</code> stitch Generaci\u00f3n de UI <code>npx -y stitch-mcp</code>"},{"location":"docs/mcp/#configuracion","title":"Configuraci\u00f3n","text":"<p>Ver mcp.json en la ra\u00edz del proyecto.</p>"},{"location":"docs/mcp/#comandos-makefile","title":"Comandos Makefile","text":"<pre><code>make dev-mcp-start    # Iniciar todos los MCP servers\nmake dev-mcp-stop     # Detener todos los MCP servers\nmake dev-mcp-status   # Ver estado de los servers\n</code></pre>"},{"location":"docs/mcp/#requisitos","title":"Requisitos","text":"<ul> <li>context7: API key en <code>CONTEXT7_API_KEY</code></li> <li>stitch: <code>gcloud auth application-default login</code></li> <li>dart: Dart SDK instalado</li> </ul>"},{"location":"docs/mcp/#troubleshooting","title":"Troubleshooting","text":""},{"location":"docs/mcp/#stitch-mcp-authentication-failed","title":"stitch-mcp: Authentication failed","text":"<pre><code>gcloud auth application-default login\n</code></pre>"},{"location":"docs/mcp/#context7-api-key-expired","title":"context7: API key expired","text":"<p>Regenerar API key en Upstash Context7</p>"},{"location":"docs/mcp/setup/","title":"MCP Setup Guide","text":"<p>Gu\u00eda detallada de configuraci\u00f3n de MCP servers.</p>"},{"location":"docs/mcp/setup/#instalacion","title":"Instalaci\u00f3n","text":"<p>Los MCP servers se ejecutan via <code>npx</code> (Node.js) o binarios locales. No requieren instalaci\u00f3n permanente.</p>"},{"location":"docs/mcp/setup/#configuracion-individual","title":"Configuraci\u00f3n Individual","text":""},{"location":"docs/mcp/setup/#context7-documentacion","title":"Context7 (Documentaci\u00f3n)","text":"<pre><code># Configurar API key\nexport CONTEXT7_API_KEY=\"ctx7sk-xxx\"\n\n# O en mcp.json\n{\n  \"mcpServers\": {\n    \"context7\": {\n      \"command\": \"npx\",\n      \"args\": [\"-y\", \"@upstash/context7-mcp\"],\n      \"env\": {\n        \"CONTEXT7_API_KEY\": \"ctx7sk-xxx\"\n      }\n    }\n  }\n}\n</code></pre> <p>Obtener API key: https://context7.com</p>"},{"location":"docs/mcp/setup/#dartflutter-mcp","title":"Dart/Flutter MCP","text":"<pre><code># Requiere Dart SDK\ndart mcp-server --force-roots-fallback\n</code></pre>"},{"location":"docs/mcp/setup/#apollo-graphql-mcp","title":"Apollo GraphQL MCP","text":"<pre><code>npx -y @apollographql/apollo-mcp-server\n</code></pre> <p>Nota: Requiere configuraci\u00f3n de endpoint GraphQL.</p>"},{"location":"docs/mcp/setup/#mobile-mcp","title":"Mobile MCP","text":"<pre><code>npx -y @mobilenext/mobile-mcp@latest\n</code></pre> <p>Gesti\u00f3n de dispositivos Android/iOS para testing.</p>"},{"location":"docs/mcp/setup/#stitch-mcp-ui-generation","title":"Stitch MCP (UI Generation)","text":"<pre><code># Autenticaci\u00f3n Google Cloud requerida\ngcloud auth application-default login\n\n# Ejecutar\nGOOGLE_CLOUD_PROJECT=\"your-project\" npx -y stitch-mcp\n</code></pre>"},{"location":"docs/mcp/setup/#integracion-con-ide","title":"Integraci\u00f3n con IDE","text":""},{"location":"docs/mcp/setup/#claude-code","title":"Claude Code","text":"<p>Claude Code lee autom\u00e1ticamente <code>mcp.json</code> desde la ra\u00edz del proyecto.</p>"},{"location":"docs/mcp/setup/#cursor","title":"Cursor","text":"<p>Configurar en <code>.cursor/mcp.json</code> con el mismo formato.</p>"},{"location":"docs/mcp/setup/#vs-code-copilot","title":"VS Code (Copilot)","text":"<p>Instalar extensi\u00f3n MCP y apuntar a <code>mcp.json</code>.</p>"},{"location":"docs/mcp/setup/#logs-y-debugging","title":"Logs y Debugging","text":"<pre><code># Ver logs de MCP servers\ntail -f /tmp/mcp-servers/*.log\n\n# Verificar procesos activos\nps aux | grep mcp\n</code></pre>"},{"location":"docs/mcp/setup/#seguridad","title":"Seguridad","text":"<ul> <li>Las API keys se almacenan en <code>mcp.json</code> (agregar a <code>.gitignore</code> para proyectos privados)</li> <li>Usar variables de entorno para credenciales sensibles</li> <li>Los PIDs se almacenan en <code>/tmp/mcp-servers/</code></li> </ul>"},{"location":"docs/mobile/","title":"\ud83d\udcf1 AltruPets Mobile","text":"<p>Aplicaci\u00f3n m\u00f3vil multiplataforma desarrollada con Flutter para conectar rescatistas de animales, organizaciones de protecci\u00f3n animal y adoptantes en Latinoam\u00e9rica.</p>"},{"location":"docs/mobile/#vision-general","title":"Visi\u00f3n General","text":"<p>AltruPets Mobile es el cliente m\u00f3vil del ecosistema AltruPets, dise\u00f1ado con Clean Architecture y Riverpod para garantizar mantenibilidad, testabilidad y escalabilidad. La aplicaci\u00f3n soporta operaciones offline-first, sincronizaci\u00f3n en segundo plano y un sistema de pagos integrado para donaciones.</p>"},{"location":"docs/mobile/#stack-tecnologico","title":"Stack Tecnol\u00f3gico","text":"Categor\u00eda Tecnolog\u00eda Versi\u00f3n Prop\u00f3sito Framework Flutter 3.10+ UI multiplataforma State Management Riverpod 2.5.1 Gesti\u00f3n de estado reactivo Arquitectura Clean Architecture - Separaci\u00f3n de concerns Inmutabilidad Freezed 2.4.1 Modelos inmutables y union types Networking GraphQL 5.1.2 Comunicaci\u00f3n con backend HTTP Client Dio 5.4.0 Requests REST auxiliares Local Storage Hive + SQLite 2.2.3 / 2.3.3 Persistencia offline Secure Storage flutter_secure_storage 9.2.2 Tokens y datos sensibles Geolocalizaci\u00f3n Geolocator 11.0.0 Ubicaci\u00f3n para rescates Functional Dartz 0.10.1 Either, Option para manejo de errores"},{"location":"docs/mobile/#estructura-del-proyecto","title":"Estructura del Proyecto","text":"<pre><code>apps/mobile/\n\u251c\u2500\u2500 lib/\n\u2502   \u251c\u2500\u2500 core/                      # C\u00f3digo compartido entre features\n\u2502   \u2502   \u251c\u2500\u2500 auth/                  # Roles y permisos\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 roles/user_role.dart\n\u2502   \u2502   \u251c\u2500\u2500 config/                # Configuraci\u00f3n de entorno\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 environment_manager.dart\n\u2502   \u2502   \u251c\u2500\u2500 error/                 # Manejo de errores\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 exceptions.dart\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 failures.dart\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 error_logging_observer.dart\n\u2502   \u2502   \u251c\u2500\u2500 graphql/               # Cliente GraphQL\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 graphql_client.dart\n\u2502   \u2502   \u251c\u2500\u2500 models/                # Modelos compartidos\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 user_model.dart\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 organization_model.dart\n\u2502   \u2502   \u251c\u2500\u2500 network/               # Capa de red\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 http_client_service.dart\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 network_info.dart\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 circuit_breaker.dart\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 interceptors/\n\u2502   \u2502   \u2502       \u251c\u2500\u2500 auth_interceptor.dart\n\u2502   \u2502   \u2502       \u251c\u2500\u2500 error_interceptor.dart\n\u2502   \u2502   \u2502       \u251c\u2500\u2500 logging_interceptor.dart\n\u2502   \u2502   \u2502       \u2514\u2500\u2500 retry_interceptor.dart\n\u2502   \u2502   \u251c\u2500\u2500 payments/              # SDK de pagos LATAM\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 latam_payments.dart\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 domain/\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 data/gateways/\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 services/\n\u2502   \u2502   \u251c\u2500\u2500 providers/             # Providers globales\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 geolocation_provider.dart\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 navigation_provider.dart\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 registration_provider.dart\n\u2502   \u2502   \u251c\u2500\u2500 services/              # Servicios de negocio\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 auth_service.dart\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 geolocation_service.dart\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 logging_service.dart\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 onvo_pay_service.dart\n\u2502   \u2502   \u251c\u2500\u2500 storage/               # Almacenamiento local\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 app_prefs_store.dart\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 profile_cache_store.dart\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 secure_storage_service.dart\n\u2502   \u2502   \u251c\u2500\u2500 sync/                  # Sincronizaci\u00f3n offline\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 sync_status_provider.dart\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 profile_update_queue_store.dart\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 generic_sync_queue_store.dart\n\u2502   \u2502   \u251c\u2500\u2500 theme/                 # Sistema de dise\u00f1o\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 app_colors.dart\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 app_theme.dart\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 app_typography.dart\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 app_motion.dart\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 theme_provider.dart\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 token_service.dart\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 design_token_model.dart\n\u2502   \u2502   \u251c\u2500\u2500 usecases/              # Base de use cases\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 usecase.dart\n\u2502   \u2502   \u251c\u2500\u2500 utils/                 # Utilidades\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 constants.dart\n\u2502   \u2502   \u2514\u2500\u2500 widgets/               # Widgets reutilizables (Atomic Design)\n\u2502   \u2502       \u251c\u2500\u2500 atoms/\n\u2502   \u2502       \u251c\u2500\u2500 molecules/\n\u2502   \u2502       \u2514\u2500\u2500 organisms/\n\u2502   \u2502\n\u2502   \u251c\u2500\u2500 features/                  # Features por dominio\n\u2502   \u2502   \u251c\u2500\u2500 auth/                  # Autenticaci\u00f3n\n\u2502   \u2502   \u251c\u2500\u2500 home/                  # Dashboard principal\n\u2502   \u2502   \u251c\u2500\u2500 onboarding/            # Flujo de registro\n\u2502   \u2502   \u251c\u2500\u2500 organizations/         # Gesti\u00f3n de organizaciones\n\u2502   \u2502   \u251c\u2500\u2500 profile/               # Perfil de usuario\n\u2502   \u2502   \u251c\u2500\u2500 rescues/               # Coordinaci\u00f3n de rescates\n\u2502   \u2502   \u2514\u2500\u2500 settings/              # Configuraci\u00f3n\n\u2502   \u2502\n\u2502   \u251c\u2500\u2500 l10n/                      # Internacionalizaci\u00f3n\n\u2502   \u2502   \u251c\u2500\u2500 app_en.arb\n\u2502   \u2502   \u2514\u2500\u2500 app_es.arb\n\u2502   \u2502\n\u2502   \u2514\u2500\u2500 main.dart                  # Entry point\n\u2502\n\u251c\u2500\u2500 assets/\n\u2502   \u251c\u2500\u2500 fonts/                     # Tipograf\u00edas personalizadas\n\u2502   \u2502   \u251c\u2500\u2500 lemon_milk/\n\u2502   \u2502   \u2514\u2500\u2500 poppins/\n\u2502   \u2514\u2500\u2500 style_dictionary/          # Design tokens exportados\n\u2502\n\u251c\u2500\u2500 test/                          # Tests unitarios y de widget\n\u2514\u2500\u2500 pubspec.yaml\n</code></pre>"},{"location":"docs/mobile/#quick-start","title":"Quick Start","text":"<pre><code># Clonar e instalar dependencias\ngit clone https://github.com/altrupets/monorepo.git\ncd monorepo/apps/mobile\nflutter pub get\n\n# Generar c\u00f3digo (Freezed, JSON Serializable)\nflutter pub run build_runner build --delete-conflicting-outputs\n\n# Generar localizaciones\nflutter gen-l10n\n\n# Ejecutar\nflutter run\n</code></pre>"},{"location":"docs/mobile/#caracteristicas-principales","title":"Caracter\u00edsticas Principales","text":""},{"location":"docs/mobile/#autenticacion","title":"\ud83d\udd10 Autenticaci\u00f3n","text":"<ul> <li>Login/Registro con JWT</li> <li>Detecci\u00f3n autom\u00e1tica de token expirado</li> <li>Secure storage para credenciales</li> <li>Manejo de sesi\u00f3n expirada con redirecci\u00f3n</li> </ul>"},{"location":"docs/mobile/#gestion-de-organizaciones","title":"\ud83c\udfe0 Gesti\u00f3n de Organizaciones","text":"<ul> <li>B\u00fasqueda con filtros avanzados</li> <li>Registro de nuevas organizaciones</li> <li>Gesti\u00f3n de membres\u00edas y roles</li> </ul>"},{"location":"docs/mobile/#coordinacion-de-rescates","title":"\ud83d\udc3e Coordinaci\u00f3n de Rescates","text":"<ul> <li>Geolocalizaci\u00f3n en tiempo real</li> <li>Notificaciones a rescatistas cercanos</li> <li>Historial y seguimiento</li> </ul>"},{"location":"docs/mobile/#sistema-de-pagos-latam","title":"\ud83d\udcb3 Sistema de Pagos LATAM","text":"<ul> <li>M\u00faltiples gateways: OnvoPay, Tilopay (CR), Wompi (CO)</li> <li>Soporte para SINPE, PSE, tarjetas</li> <li>Tokenizaci\u00f3n segura de tarjetas</li> </ul>"},{"location":"docs/mobile/#offline-first","title":"\ud83d\udcf4 Offline-First","text":"<ul> <li>Cache local con Hive</li> <li>Cola de sincronizaci\u00f3n para cambios pendientes</li> <li>Indicador de estado de sincronizaci\u00f3n</li> </ul>"},{"location":"docs/mobile/#design-system","title":"\ud83c\udfa8 Design System","text":"<ul> <li>Material 3 con tokens personalizados</li> <li>Soporte para modo claro/oscuro</li> <li>Tipograf\u00edas: Lemon Milk (headers) + Poppins (body)</li> </ul>"},{"location":"docs/mobile/#documentacion","title":"Documentaci\u00f3n","text":"Documento Descripci\u00f3n Getting Started Instalaci\u00f3n, configuraci\u00f3n, flujo de desarrollo Launch Script Gu\u00eda completa de los comandos <code>make dev-mobile-*</code> Widgetbook (QA UI) Cat\u00e1logo de componentes y flujo de QA de dise\u00f1o Arquitectura Clean Architecture, Riverpod patterns, manejo de errores Features Detalle de cada funcionalidad Core Servicios compartidos, network, payments, storage Design System Colores, tipograf\u00eda, tema, widgets"},{"location":"docs/mobile/architecture/","title":"\ud83c\udfd7\ufe0f Arquitectura","text":"<p>AltruPets Mobile implementa Clean Architecture con Riverpod como soluci\u00f3n de state management, siguiendo principios SOLID y programaci\u00f3n funcional con <code>dartz</code>.</p>"},{"location":"docs/mobile/architecture/#principios-de-diseno","title":"Principios de Dise\u00f1o","text":"<ol> <li>Dependency Inversion: Las capas internas no dependen de las externas</li> <li>Single Responsibility: Cada clase tiene una \u00fanica raz\u00f3n para cambiar</li> <li>Testability: Inyecci\u00f3n de dependencias facilita mocking</li> <li>Immutability: Estados inmutables con Freezed evitan side effects</li> </ol>"},{"location":"docs/mobile/architecture/#diagrama-de-capas","title":"Diagrama de Capas","text":"<pre><code>flowchart TB\n    subgraph Presentation[Presentation Layer]\n        Pages[Pages/Screens]\n        Widgets[Widgets]\n        Providers[Riverpod Providers]\n        States[Freezed States]\n    end\n\n    subgraph Domain[Domain Layer]\n        Entities[Entities]\n        RepoInterfaces[Repository Interfaces]\n        UseCases[Use Cases]\n        Failures[Failures]\n    end\n\n    subgraph Data[Data Layer]\n        Models[Models]\n        RepoImpl[Repository Implementations]\n        DataSources[Data Sources]\n        GraphQL[GraphQL Client]\n    end\n\n    Pages --&gt; Providers\n    Providers --&gt; States\n    Providers --&gt; RepoInterfaces\n\n    UseCases --&gt; RepoInterfaces\n    UseCases --&gt; Entities\n\n    RepoImpl -.-&gt;|implements| RepoInterfaces\n    RepoImpl --&gt; Models\n    RepoImpl --&gt; DataSources\n    DataSources --&gt; GraphQL\n\n    Models -.-&gt;|toEntity| Entities\n</code></pre>"},{"location":"docs/mobile/architecture/#domain-layer","title":"Domain Layer","text":"<p>La capa de dominio es el n\u00facleo de la aplicaci\u00f3n. No tiene dependencias externas.</p>"},{"location":"docs/mobile/architecture/#entities-con-freezed","title":"Entities con Freezed","text":"<p>Las entidades son objetos inmutables que representan conceptos del negocio:</p> <pre><code>// lib/features/auth/domain/entities/user.dart\nimport 'package:freezed_annotation/freezed_annotation.dart';\n\npart 'user.freezed.dart';\npart 'user.g.dart';\n\n@freezed\nclass User with _$User {\n  const factory User({\n    required String id,\n    required String username,\n    @JsonKey(fromJson: _rolesFromJson) List&lt;String&gt;? roles,\n    String? email,\n    String? firstName,\n    String? lastName,\n    String? phone,\n    String? identification,\n    String? country,\n    String? province,\n    String? canton,\n    String? district,\n    String? occupation,\n    String? incomeSource,\n    bool? isActive,\n    bool? isVerified,\n    String? avatarBase64,\n    @JsonKey(fromJson: _dateTimeFromJson) DateTime? createdAt,\n    @JsonKey(fromJson: _dateTimeFromJson) DateTime? updatedAt,\n  }) = _User;\n\n  factory User.fromJson(Map&lt;String, dynamic&gt; json) =&gt; _$UserFromJson(json);\n}\n\n// Custom JSON converters\nList&lt;String&gt;? _rolesFromJson(dynamic json) {\n  if (json == null) return null;\n  if (json is List) {\n    return json.map((e) =&gt; e.toString()).toList();\n  }\n  return null;\n}\n\nDateTime? _dateTimeFromJson(dynamic json) {\n  if (json == null) return null;\n  if (json is String) {\n    return DateTime.tryParse(json);\n  }\n  return null;\n}\n</code></pre>"},{"location":"docs/mobile/architecture/#repository-interfaces","title":"Repository Interfaces","text":"<p>Definen el contrato que deben cumplir las implementaciones:</p> <pre><code>// lib/features/auth/domain/repositories/auth_repository_interface.dart\nimport 'package:dartz/dartz.dart';\nimport 'package:altrupets/core/error/failures.dart';\nimport 'package:altrupets/features/auth/domain/entities/user.dart';\nimport 'package:altrupets/features/auth/data/models/auth_payload.dart';\nimport 'package:altrupets/features/auth/data/models/register_input.dart';\n\nabstract class AuthRepositoryInterface {\n  /// Registra un nuevo usuario\n  Future&lt;Either&lt;Failure, User&gt;&gt; register(RegisterInput input);\n\n  /// Inicia sesi\u00f3n y retorna el payload con token\n  Future&lt;Either&lt;Failure, AuthPayload&gt;&gt; login(\n    String username,\n    String password,\n  );\n\n  /// Obtiene el usuario actual desde el token\n  Future&lt;Either&lt;Failure, User&gt;&gt; getCurrentUser();\n\n  /// Cierra la sesi\u00f3n\n  Future&lt;Either&lt;Failure, void&gt;&gt; logout();\n}\n</code></pre>"},{"location":"docs/mobile/architecture/#manejo-de-errores-con-either","title":"Manejo de Errores con Either","text":"<p>Usamos <code>Either&lt;Failure, T&gt;</code> para representar operaciones que pueden fallar:</p> <pre><code>// lib/core/error/failures.dart\nimport 'package:equatable/equatable.dart';\n\n/// Clase base para todos los tipos de fallos\nabstract class Failure extends Equatable {\n  const Failure(this.message);\n  final String message;\n\n  @override\n  List&lt;Object&gt; get props =&gt; [message];\n}\n\n/// Fallo del servidor (HTTP 5xx, GraphQL errors)\nclass ServerFailure extends Failure {\n  const ServerFailure([super.message = 'Error del servidor']);\n}\n\n/// Fallo de cach\u00e9 (lectura/escritura local)\nclass CacheFailure extends Failure {\n  const CacheFailure([super.message = 'Error de cach\u00e9']);\n}\n\n/// Fallo de red (sin conexi\u00f3n, timeout)\nclass NetworkFailure extends Failure {\n  const NetworkFailure([super.message = 'Sin conexi\u00f3n a internet']);\n}\n</code></pre>"},{"location":"docs/mobile/architecture/#presentation-layer-con-riverpod","title":"Presentation Layer con Riverpod","text":""},{"location":"docs/mobile/architecture/#state-con-freezed","title":"State con Freezed","text":"<pre><code>// lib/features/auth/presentation/providers/auth_provider.dart\nimport 'package:flutter_riverpod/flutter_riverpod.dart';\nimport 'package:freezed_annotation/freezed_annotation.dart';\n\npart 'auth_provider.freezed.dart';\n\n@freezed\nclass AuthState with _$AuthState {\n  const factory AuthState({\n    @Default(false) bool isLoading,\n    AuthPayload? payload,\n    User? user,\n    String? error,\n  }) = _AuthState;\n}\n</code></pre>"},{"location":"docs/mobile/architecture/#statenotifier","title":"StateNotifier","text":"<pre><code>class AuthNotifier extends StateNotifier&lt;AuthState&gt; {\n  AuthNotifier(this._repository) : super(const AuthState());\n  final AuthRepositoryInterface _repository;\n\n  Future&lt;void&gt; login(String username, String password) async {\n    // 1. Set loading state\n    state = state.copyWith(\n      isLoading: true,\n      error: null,\n      payload: null,\n      user: null,\n    );\n\n    // 2. Call repository\n    final result = await _repository.login(username, password);\n\n    // 3. Handle result with fold\n    result.fold(\n      (failure) {\n        state = state.copyWith(\n          isLoading: false,\n          error: failure.message,\n          payload: null,\n        );\n      },\n      (payload) {\n        state = state.copyWith(\n          isLoading: false,\n          payload: payload,\n          error: null,\n        );\n      },\n    );\n  }\n\n  Future&lt;void&gt; logout() async {\n    final result = await _repository.logout();\n    result.fold((_) {}, (_) {});\n    // Siempre limpiamos el estado local de auth al cerrar sesi\u00f3n\n    state = const AuthState();\n  }\n}\n</code></pre>"},{"location":"docs/mobile/architecture/#providers","title":"Providers","text":"<pre><code>// Repository provider\nfinal authRepositoryProvider = Provider&lt;AuthRepositoryInterface&gt;((ref) {\n  return AuthRepository();\n});\n\n// StateNotifier provider\nfinal authProvider = StateNotifierProvider&lt;AuthNotifier, AuthState&gt;((ref) {\n  final repository = ref.watch(authRepositoryProvider);\n  return AuthNotifier(repository);\n});\n\n// Derived providers\nfinal isAuthenticatedProvider = FutureProvider&lt;bool&gt;((ref) async {\n  final hasActiveSession = await GraphQLClientService.hasActiveSession();\n  if (!hasActiveSession) return false;\n\n  final repository = ref.read(authRepositoryProvider);\n  final currentUserResult = await repository.getCurrentUser();\n\n  final isValid = currentUserResult.fold(\n    (_) =&gt; false,\n    (_) =&gt; true,\n  );\n\n  if (!isValid) {\n    await GraphQLClientService.clearToken();\n  }\n\n  return isValid;\n});\n\n// Stream provider para sesi\u00f3n expirada\nfinal sessionExpiredProvider = StreamProvider&lt;void&gt;((ref) {\n  return GraphQLClientService.sessionExpiredStream;\n});\n</code></pre>"},{"location":"docs/mobile/architecture/#uso-en-widgets","title":"Uso en Widgets","text":"<pre><code>class LoginPage extends ConsumerWidget {\n  @override\n  Widget build(BuildContext context, WidgetRef ref) {\n    final authState = ref.watch(authProvider);\n\n    // React to state changes\n    ref.listen&lt;AuthState&gt;(authProvider, (previous, next) {\n      if (next.error != null) {\n        ScaffoldMessenger.of(context).showSnackBar(\n          SnackBar(content: Text(next.error!)),\n        );\n      }\n      if (next.payload != null) {\n        Navigator.pushReplacement(context, ...);\n      }\n    });\n\n    return Scaffold(\n      body: authState.isLoading\n        ? const CircularProgressIndicator()\n        : LoginForm(\n            onSubmit: (username, password) {\n              ref.read(authProvider.notifier).login(username, password);\n            },\n          ),\n    );\n  }\n}\n</code></pre>"},{"location":"docs/mobile/architecture/#data-layer","title":"Data Layer","text":""},{"location":"docs/mobile/architecture/#repository-implementation","title":"Repository Implementation","text":"<pre><code>// lib/features/auth/data/repositories/auth_repository.dart\nclass AuthRepository implements AuthRepositoryInterface {\n  final GraphQLClient _client = GraphQLClientService.getClient();\n\n  @override\n  Future&lt;Either&lt;Failure, AuthPayload&gt;&gt; login(\n    String username,\n    String password,\n  ) async {\n    try {\n      final result = await _client.mutate(\n        MutationOptions(\n          document: gql(loginMutation),\n          variables: {'username': username, 'password': password},\n        ),\n      );\n\n      if (result.hasException) {\n        return Left(ServerFailure(result.exception.toString()));\n      }\n\n      final payload = AuthPayload.fromJson(result.data!['login']);\n\n      // Save token\n      await GraphQLClientService.saveToken(payload.accessToken);\n\n      return Right(payload);\n    } catch (e) {\n      return Left(ServerFailure(e.toString()));\n    }\n  }\n}\n</code></pre>"},{"location":"docs/mobile/architecture/#estructura-de-feature-completa","title":"Estructura de Feature Completa","text":"<pre><code>features/auth/\n\u251c\u2500\u2500 domain/\n\u2502   \u251c\u2500\u2500 entities/\n\u2502   \u2502   \u251c\u2500\u2500 user.dart\n\u2502   \u2502   \u251c\u2500\u2500 user.freezed.dart\n\u2502   \u2502   \u2514\u2500\u2500 user.g.dart\n\u2502   \u2514\u2500\u2500 repositories/\n\u2502       \u2514\u2500\u2500 auth_repository_interface.dart\n\u251c\u2500\u2500 data/\n\u2502   \u251c\u2500\u2500 models/\n\u2502   \u2502   \u251c\u2500\u2500 auth_payload.dart\n\u2502   \u2502   \u251c\u2500\u2500 auth_payload.freezed.dart\n\u2502   \u2502   \u251c\u2500\u2500 auth_payload.g.dart\n\u2502   \u2502   \u251c\u2500\u2500 register_input.dart\n\u2502   \u2502   \u251c\u2500\u2500 register_input.freezed.dart\n\u2502   \u2502   \u2514\u2500\u2500 register_input.g.dart\n\u2502   \u2514\u2500\u2500 repositories/\n\u2502       \u2514\u2500\u2500 auth_repository.dart\n\u2514\u2500\u2500 presentation/\n    \u251c\u2500\u2500 pages/\n    \u2502   \u251c\u2500\u2500 login_page.dart\n    \u2502   \u2514\u2500\u2500 register_page.dart\n    \u251c\u2500\u2500 providers/\n    \u2502   \u251c\u2500\u2500 auth_provider.dart\n    \u2502   \u2514\u2500\u2500 auth_provider.freezed.dart\n    \u2514\u2500\u2500 widgets/\n        \u251c\u2500\u2500 login_form.dart\n        \u2514\u2500\u2500 register_form.dart\n</code></pre>"},{"location":"docs/mobile/architecture/#flujo-de-datos","title":"Flujo de Datos","text":"<pre><code>sequenceDiagram\n    participant UI as LoginPage\n    participant P as AuthProvider\n    participant R as AuthRepository\n    participant G as GraphQLClient\n    participant S as SecureStorage\n\n    UI-&gt;&gt;P: login(username, password)\n    P-&gt;&gt;P: state = loading\n    P-&gt;&gt;R: login(username, password)\n    R-&gt;&gt;G: mutate(loginMutation)\n    G--&gt;&gt;R: AuthPayload\n    R-&gt;&gt;S: saveToken(token)\n    R--&gt;&gt;P: Right(AuthPayload)\n    P-&gt;&gt;P: state = success\n    P--&gt;&gt;UI: rebuild with new state\n</code></pre>"},{"location":"docs/mobile/architecture/#best-practices","title":"Best Practices","text":""},{"location":"docs/mobile/architecture/#do","title":"DO","text":"<pre><code>// \u2705 Usar Either para operaciones fallibles\nFuture&lt;Either&lt;Failure, User&gt;&gt; getUser();\n\n// \u2705 Inyectar dependencias v\u00eda constructor\nclass AuthNotifier extends StateNotifier&lt;AuthState&gt; {\n  AuthNotifier(this._repository);\n  final AuthRepositoryInterface _repository;\n}\n\n// \u2705 Usar copyWith para actualizar estado\nstate = state.copyWith(isLoading: true);\n\n// \u2705 Manejar ambos casos de Either\nresult.fold(\n  (failure) =&gt; handleError(failure),\n  (success) =&gt; handleSuccess(success),\n);\n</code></pre>"},{"location":"docs/mobile/architecture/#dont","title":"DON'T","text":"<pre><code>// \u274c Lanzar excepciones desde repositories\nthrow Exception('Error'); // Use Left(Failure) instead\n\n// \u274c Mutar estado directamente\nstate.isLoading = true; // States are immutable\n\n// \u274c Acceder a providers sin ref\nfinal repo = AuthRepository(); // Use ref.watch()\n\n// \u274c Ignorar el lado Left de Either\nresult.getOrElse(() =&gt; defaultValue); // Handle errors properly\n</code></pre>"},{"location":"docs/mobile/core/","title":"\u2699\ufe0f Core","text":""},{"location":"docs/mobile/core/#graphql-client","title":"GraphQL Client","text":"<pre><code>final client = GraphQLClientService.getClient();\n\n// Query\nfinal result = await client.query(QueryOptions(\n  document: gql(myQuery),\n  variables: {'id': '123'},\n));\n\n// Token management\nawait GraphQLClientService.saveToken(token);\nawait GraphQLClientService.clearToken();\nfinal hasSession = await GraphQLClientService.hasActiveSession();\n</code></pre>"},{"location":"docs/mobile/core/#network","title":"Network","text":""},{"location":"docs/mobile/core/#interceptors","title":"Interceptors","text":"<ul> <li><code>AuthInterceptor</code> - JWT headers</li> <li><code>ErrorInterceptor</code> - Error handling</li> <li><code>LoggingInterceptor</code> - Request/response logging</li> <li><code>RetryInterceptor</code> - Auto retry</li> </ul>"},{"location":"docs/mobile/core/#network-info","title":"Network Info","text":"<pre><code>final isConnected = await networkInfo.isConnected;\n</code></pre>"},{"location":"docs/mobile/core/#storage","title":"Storage","text":""},{"location":"docs/mobile/core/#secure-storage-tokens","title":"Secure Storage (tokens)","text":"<pre><code>await secureStorage.write(key, value);\nfinal value = await secureStorage.read(key);\n</code></pre>"},{"location":"docs/mobile/core/#profile-cache","title":"Profile Cache","text":"<pre><code>await ProfileCacheStore.cacheProfile(user);\nfinal cached = await ProfileCacheStore.getCachedProfile();\n</code></pre>"},{"location":"docs/mobile/core/#payments-latam","title":"Payments (LATAM)","text":"<p>Gateways: OnvoPay, Tilopay (CR), Wompi (CO), Conekta (MX), MercadoPago (BR)</p> <pre><code>final gateway = PaymentGatewayFactory.create(\n  type: PaymentGatewayType.onvoPay,\n  config: PaymentGatewayConfiguration(publicKey: 'pk_...'),\n);\n\nfinal token = await gateway.tokenizeCard(...);\nfinal result = await gateway.processPayment(amount: 50000, currency: Currency.crc);\n</code></pre>"},{"location":"docs/mobile/core/#widgets-atomic-design","title":"Widgets (Atomic Design)","text":""},{"location":"docs/mobile/core/#atoms","title":"Atoms","text":"<ul> <li><code>AppCircularButton</code></li> <li><code>AppRoleBadge</code></li> <li><code>SyncStatusIndicator</code></li> </ul>"},{"location":"docs/mobile/core/#molecules","title":"Molecules","text":"<ul> <li><code>AppInputCard</code></li> <li><code>AppNavItem</code></li> <li><code>AppServiceCard</code></li> <li><code>HomeWelcomeHeader</code></li> <li><code>ProfileMenuOption</code></li> </ul>"},{"location":"docs/mobile/core/#organisms","title":"Organisms","text":"<ul> <li><code>MainNavigationBar</code></li> <li><code>ProfileHeader</code></li> <li><code>StickyActionFooter</code></li> <li><code>SecureCardInputWidget</code></li> </ul>"},{"location":"docs/mobile/core/#services","title":"Services","text":"<ul> <li><code>AuthService</code> - Sesiones</li> <li><code>GeolocationService</code> - GPS</li> <li><code>LoggingService</code> - Logs</li> </ul>"},{"location":"docs/mobile/design-system/","title":"\ud83c\udfa8 Design System","text":"<p>Material 3 con tokens de dise\u00f1o personalizados.</p>"},{"location":"docs/mobile/design-system/#colores","title":"Colores","text":"<pre><code>AppColors.primary      // Brand primary\nAppColors.secondary    // Brand secondary\nAppColors.error        // Errores\nAppColors.success      // \u00c9xito\nAppColors.surface      // Superficies\nAppColors.outline      // Bordes\n</code></pre>"},{"location":"docs/mobile/design-system/#modo-oscuro","title":"Modo Oscuro","text":"<pre><code>AppColorsDark.primary  // Primary invertido\nAppColorsDark.surface  // Surface oscuro\n</code></pre>"},{"location":"docs/mobile/design-system/#tipografia","title":"Tipograf\u00eda","text":"<p>Fuentes: Lemon Milk (t\u00edtulos), Poppins (cuerpo)</p> <pre><code>Theme.of(context).textTheme.headlineMedium\nTheme.of(context).textTheme.bodyMedium\nTheme.of(context).textTheme.labelLarge\n</code></pre>"},{"location":"docs/mobile/design-system/#theme-provider","title":"Theme Provider","text":"<pre><code>final themeMode = ref.watch(themeModeProvider);\n\n// Toggle\nref.read(themeModeProvider.notifier).toggleTheme();\n</code></pre>"},{"location":"docs/mobile/design-system/#spacing","title":"Spacing","text":"<pre><code>AppSpacing.xs   // 4\nAppSpacing.sm   // 8\nAppSpacing.md   // 16\nAppSpacing.lg   // 24\nAppSpacing.xl   // 32\n</code></pre>"},{"location":"docs/mobile/design-system/#border-radius","title":"Border Radius","text":"<pre><code>AppRadius.sm    // 8\nAppRadius.md    // 12\nAppRadius.lg    // 16\nAppRadius.full  // 9999\n</code></pre>"},{"location":"docs/mobile/design-system/#uso-en-app","title":"Uso en App","text":"<pre><code>MaterialApp(\n  theme: AppTheme.lightTheme(),\n  darkTheme: AppTheme.darkTheme(),\n  themeMode: themeMode,\n)\n</code></pre>"},{"location":"docs/mobile/design-system/#best-practices","title":"Best Practices","text":"<pre><code>// \u2705 Correcto\ncolor: AppColors.primary\nstyle: Theme.of(context).textTheme.bodyMedium\npadding: EdgeInsets.all(AppSpacing.md)\n\n// \u274c Incorrecto\ncolor: Color(0xFF6366F1)\nstyle: TextStyle(fontSize: 14)\npadding: EdgeInsets.all(17)\n</code></pre>"},{"location":"docs/mobile/features/","title":"\ud83d\udce6 Features","text":"<p>Documentaci\u00f3n detallada de cada feature de la aplicaci\u00f3n AltruPets Mobile.</p>"},{"location":"docs/mobile/features/#mapa-de-features","title":"Mapa de Features","text":"<pre><code>flowchart TB\n    Auth[Auth&lt;br/&gt;Login/Register]\n    Home[Home&lt;br/&gt;Dashboard]\n    Profile[Profile&lt;br/&gt;User Profile]\n    Orgs[Organizations&lt;br/&gt;Orgs]\n    Rescues[Rescues&lt;br/&gt;Rescues]\n    Settings[Settings&lt;br/&gt;Config]\n    Onboarding[Onboarding&lt;br/&gt;Initial Reg]\n\n    Auth --&gt; Home\n    Onboarding --&gt; Home\n    Home --&gt; Profile\n    Home --&gt; Orgs\n    Home --&gt; Rescues\n    Home --&gt; Settings\n\n    Profile -.-&gt;|uses| Auth\n    Orgs -.-&gt;|uses| Auth\n    Rescues -.-&gt;|uses| Auth\n\n    style Auth fill:#e1f5ff\n    style Home fill:#fff4e1\n    style Profile fill:#f0e1ff\n    style Orgs fill:#e1ffe1\n    style Rescues fill:#ffe1e1\n    style Settings fill:#f5f5f5\n    style Onboarding fill:#ffe1f5\n</code></pre>"},{"location":"docs/mobile/features/#estructura-de-un-feature","title":"Estructura de un Feature","text":"<p>Cada feature sigue la estructura de Clean Architecture:</p> <pre><code>flowchart TB\n    subgraph Feature[Feature Module]\n        subgraph Domain[domain/]\n            Entities[entities&lt;br/&gt;Freezed models]\n            RepoInt[repositories&lt;br/&gt;Interfaces]\n        end\n\n        subgraph Data[data/]\n            Models[models&lt;br/&gt;DTOs]\n            RepoImpl[repositories&lt;br/&gt;Implementations]\n        end\n\n        subgraph Presentation[presentation/]\n            Pages[pages&lt;br/&gt;Screens]\n            Providers[providers&lt;br/&gt;StateNotifiers]\n            Widgets[widgets&lt;br/&gt;UI Components]\n        end\n    end\n\n    Pages --&gt; Providers\n    Providers --&gt; RepoInt\n    RepoImpl -.-&gt;|implements| RepoInt\n    RepoImpl --&gt; Models\n    Models -.-&gt;|toEntity| Entities\n\n    style Domain fill:#e1f5ff\n    style Data fill:#fff4e1\n    style Presentation fill:#f0e1ff\n</code></pre> <p>Estructura de carpetas:</p> <pre><code>features/&lt;feature_name&gt;/\n\u251c\u2500\u2500 domain/                    # Capa de dominio\n\u2502   \u251c\u2500\u2500 entities/              # Entidades de negocio (Freezed)\n\u2502   \u2514\u2500\u2500 repositories/          # Interfaces de repositorio\n\u251c\u2500\u2500 data/                      # Capa de datos\n\u2502   \u251c\u2500\u2500 models/                # DTOs y modelos de datos\n\u2502   \u2514\u2500\u2500 repositories/          # Implementaciones de repositorio\n\u2514\u2500\u2500 presentation/              # Capa de presentaci\u00f3n\n    \u251c\u2500\u2500 pages/                 # P\u00e1ginas/Screens\n    \u251c\u2500\u2500 providers/             # Riverpod StateNotifiers\n    \u2514\u2500\u2500 widgets/               # Widgets espec\u00edficos del feature\n</code></pre>"},{"location":"docs/mobile/features/#auth","title":"Auth","text":"<p>Gestiona la autenticaci\u00f3n de usuarios con JWT.</p>"},{"location":"docs/mobile/features/#funcionalidades","title":"Funcionalidades","text":"<ul> <li>Login: Autenticaci\u00f3n con username/password</li> <li>Registro: Creaci\u00f3n de nuevos usuarios</li> <li>Sesi\u00f3n persistente: Token almacenado en secure storage</li> <li>Auto-logout: Detecci\u00f3n de token expirado con redirecci\u00f3n autom\u00e1tica</li> <li>Refresh token: Renovaci\u00f3n autom\u00e1tica de sesi\u00f3n (cuando el backend lo soporte)</li> </ul>"},{"location":"docs/mobile/features/#estructura","title":"Estructura","text":"<pre><code>features/auth/\n\u251c\u2500\u2500 domain/\n\u2502   \u251c\u2500\u2500 entities/\n\u2502   \u2502   \u251c\u2500\u2500 user.dart               # Entidad User con todos los campos\n\u2502   \u2502   \u251c\u2500\u2500 user.freezed.dart\n\u2502   \u2502   \u2514\u2500\u2500 user.g.dart\n\u2502   \u2514\u2500\u2500 repositories/\n\u2502       \u2514\u2500\u2500 auth_repository_interface.dart\n\u251c\u2500\u2500 data/\n\u2502   \u251c\u2500\u2500 models/\n\u2502   \u2502   \u251c\u2500\u2500 auth_payload.dart       # Token + User response\n\u2502   \u2502   \u2514\u2500\u2500 register_input.dart     # Input para registro\n\u2502   \u2514\u2500\u2500 repositories/\n\u2502       \u2514\u2500\u2500 auth_repository.dart\n\u2514\u2500\u2500 presentation/\n    \u251c\u2500\u2500 pages/\n    \u2502   \u251c\u2500\u2500 login_page.dart\n    \u2502   \u2514\u2500\u2500 register_page.dart\n    \u2514\u2500\u2500 providers/\n        \u251c\u2500\u2500 auth_provider.dart\n        \u2514\u2500\u2500 auth_provider.freezed.dart\n</code></pre>"},{"location":"docs/mobile/features/#providers","title":"Providers","text":"<pre><code>// Estado de autenticaci\u00f3n principal\nfinal authProvider = StateNotifierProvider&lt;AuthNotifier, AuthState&gt;((ref) {\n  final repository = ref.watch(authRepositoryProvider);\n  return AuthNotifier(repository);\n});\n\n// Verificaci\u00f3n de sesi\u00f3n activa\nfinal isAuthenticatedProvider = FutureProvider&lt;bool&gt;((ref) async {\n  final hasActiveSession = await GraphQLClientService.hasActiveSession();\n  if (!hasActiveSession) return false;\n\n  final repository = ref.read(authRepositoryProvider);\n  final currentUserResult = await repository.getCurrentUser();\n  return currentUserResult.isRight();\n});\n\n// Stream para sesi\u00f3n expirada (401/403)\nfinal sessionExpiredProvider = StreamProvider&lt;void&gt;((ref) {\n  return GraphQLClientService.sessionExpiredStream;\n});\n</code></pre>"},{"location":"docs/mobile/features/#uso-en-la-app","title":"Uso en la App","text":"<pre><code>// En main.dart - Escuchar expiraci\u00f3n de sesi\u00f3n\nref.listen&lt;AsyncValue&lt;void&gt;&gt;(sessionExpiredProvider, (previous, next) {\n  next.whenData((_) async {\n    await ref.read(authProvider.notifier).logout();\n    navigation.navigateAndRemoveAllGlobal(const LoginPage());\n  });\n});\n\n// Decidir pantalla inicial\nhome: isAuthenticatedAsync.when(\n  data: (isAuthenticated) =&gt;\n      isAuthenticated ? const HomePage() : const LoginPage(),\n  loading: () =&gt;\n      const Scaffold(body: Center(child: CircularProgressIndicator())),\n  error: (_, __) =&gt; const LoginPage(),\n),\n</code></pre>"},{"location":"docs/mobile/features/#entidad-user","title":"Entidad User","text":"<pre><code>@freezed\nclass User with _$User {\n  const factory User({\n    required String id,\n    required String username,\n    @JsonKey(fromJson: _rolesFromJson) List&lt;String&gt;? roles,\n    String? email,\n    String? firstName,\n    String? lastName,\n    String? phone,\n    String? identification,\n    String? country,\n    String? province,\n    String? canton,\n    String? district,\n    String? occupation,\n    String? incomeSource,\n    bool? isActive,\n    bool? isVerified,\n    String? avatarBase64,\n    @JsonKey(fromJson: _dateTimeFromJson) DateTime? createdAt,\n    @JsonKey(fromJson: _dateTimeFromJson) DateTime? updatedAt,\n  }) = _User;\n\n  factory User.fromJson(Map&lt;String, dynamic&gt; json) =&gt; _$UserFromJson(json);\n}\n</code></pre>"},{"location":"docs/mobile/features/#home","title":"Home","text":"<p>Dashboard principal que sirve como hub de navegaci\u00f3n.</p>"},{"location":"docs/mobile/features/#funcionalidades_1","title":"Funcionalidades","text":"<ul> <li>Welcome header: Saludo personalizado con nombre del usuario</li> <li>Quick actions: Accesos directos a funciones principales</li> <li>Navigation: Navegaci\u00f3n a Organizations, Profile, Settings, Rescues</li> <li>Sync status: Indicador de cambios pendientes por sincronizar</li> </ul>"},{"location":"docs/mobile/features/#estructura_1","title":"Estructura","text":"<pre><code>features/home/\n\u2514\u2500\u2500 presentation/\n    \u251c\u2500\u2500 pages/\n    \u2502   \u2514\u2500\u2500 home_page.dart\n    \u2514\u2500\u2500 widgets/\n        \u251c\u2500\u2500 home_welcome_header.dart\n        \u2514\u2500\u2500 quick_action_card.dart\n</code></pre>"},{"location":"docs/mobile/features/#organizations","title":"Organizations","text":"<p>Gesti\u00f3n completa de organizaciones de protecci\u00f3n animal.</p>"},{"location":"docs/mobile/features/#funcionalidades_2","title":"Funcionalidades","text":"<ul> <li>B\u00fasqueda: Filtrado por nombre, ubicaci\u00f3n, tipo</li> <li>Detalle: Vista completa de organizaci\u00f3n con informaci\u00f3n de contacto</li> <li>Registro: Formulario para crear nueva organizaci\u00f3n</li> <li>Membres\u00edas: Gesti\u00f3n de miembros y roles dentro de organizaciones</li> </ul>"},{"location":"docs/mobile/features/#estructura_2","title":"Estructura","text":"<pre><code>features/organizations/\n\u251c\u2500\u2500 data/\n\u2502   \u251c\u2500\u2500 models/\n\u2502   \u2502   \u251c\u2500\u2500 organization.dart\n\u2502   \u2502   \u251c\u2500\u2500 organization_membership.dart\n\u2502   \u2502   \u251c\u2500\u2500 register_organization_input.dart\n\u2502   \u2502   \u2514\u2500\u2500 search_organizations_input.dart\n\u2502   \u2514\u2500\u2500 repositories/\n\u2502       \u2514\u2500\u2500 organizations_repository.dart\n\u2514\u2500\u2500 presentation/\n    \u251c\u2500\u2500 pages/\n    \u2502   \u251c\u2500\u2500 search_organizations_page.dart\n    \u2502   \u251c\u2500\u2500 organization_detail_page.dart\n    \u2502   \u251c\u2500\u2500 register_organization_page.dart\n    \u2502   \u2514\u2500\u2500 manage_memberships_page.dart\n    \u2514\u2500\u2500 providers/\n        \u2514\u2500\u2500 organizations_provider.dart\n</code></pre>"},{"location":"docs/mobile/features/#modelo-organization","title":"Modelo Organization","text":"<pre><code>@freezed\nclass Organization with _$Organization {\n  const factory Organization({\n    required String id,\n    required String name,\n    String? description,\n    String? legalId,           // C\u00e9dula jur\u00eddica\n    String? email,\n    String? phone,\n    String? website,\n    String? address,\n    String? province,\n    String? canton,\n    String? district,\n    String? logoBase64,\n    bool? isVerified,\n    DateTime? createdAt,\n  }) = _Organization;\n\n  factory Organization.fromJson(Map&lt;String, dynamic&gt; json) =&gt;\n      _$OrganizationFromJson(json);\n}\n</code></pre>"},{"location":"docs/mobile/features/#profile","title":"Profile","text":"<p>Gesti\u00f3n del perfil de usuario con soporte offline.</p>"},{"location":"docs/mobile/features/#funcionalidades_3","title":"Funcionalidades","text":"<ul> <li>Ver/Editar: Informaci\u00f3n personal completa</li> <li>Avatar: Subida y visualizaci\u00f3n de foto de perfil</li> <li>Ubicaci\u00f3n: Selector cascada de Costa Rica (provincia \u2192 cant\u00f3n \u2192 distrito)</li> <li>Hogares de acogida: Gesti\u00f3n de foster homes</li> <li>Offline: Cache local con sincronizaci\u00f3n en segundo plano</li> </ul>"},{"location":"docs/mobile/features/#estructura_3","title":"Estructura","text":"<pre><code>features/profile/\n\u251c\u2500\u2500 data/\n\u2502   \u251c\u2500\u2500 models/\n\u2502   \u2502   \u251c\u2500\u2500 update_profile_input.dart\n\u2502   \u2502   \u2514\u2500\u2500 foster_home.dart\n\u2502   \u2514\u2500\u2500 repositories/\n\u2502       \u2514\u2500\u2500 profile_repository.dart\n\u2514\u2500\u2500 presentation/\n    \u251c\u2500\u2500 pages/\n    \u2502   \u251c\u2500\u2500 profile_page.dart\n    \u2502   \u2514\u2500\u2500 edit_profile_page.dart\n    \u251c\u2500\u2500 providers/\n    \u2502   \u2514\u2500\u2500 profile_provider.dart\n    \u2514\u2500\u2500 widgets/\n        \u251c\u2500\u2500 profile_header.dart\n        \u2514\u2500\u2500 profile_menu_option.dart\n</code></pre>"},{"location":"docs/mobile/features/#sincronizacion-offline","title":"Sincronizaci\u00f3n Offline","text":"<p>El sistema de sincronizaci\u00f3n offline permite que los cambios se guarden localmente y se sincronicen cuando hay conexi\u00f3n.</p> <pre><code>sequenceDiagram\n    participant UI as Pagina Editar Perfil\n    participant P as ProfileProvider\n    participant R as ProfileRepository\n    participant Q as ColaSincronizacion\n    participant C as Cache\n    participant API as API GraphQL\n\n    UI-&gt;&gt;P: updateProfile(datos)\n    P-&gt;&gt;C: Guardar en cache\n    C--&gt;&gt;P: Guardado\n\n    alt En linea\n        P-&gt;&gt;API: Mutacion\n        API--&gt;&gt;P: Exito\n        P-&gt;&gt;C: Actualizar cache\n    else Sin conexion\n        P-&gt;&gt;Q: Agregar a cola\n        Q--&gt;&gt;P: Encolado\n        Note over Q: Espera conexion\n    end\n\n    P--&gt;&gt;UI: Actualizar UI\n\n    Note over Q,API: Cuando hay conexion\n    Q-&gt;&gt;API: Sincronizar cambios\n    API--&gt;&gt;Q: Exito\n    Q-&gt;&gt;C: Actualizar cache\n</code></pre> <p>Uso en c\u00f3digo:</p> <pre><code>// Ver estado de sincronizaci\u00f3n\nfinal syncStatus = ref.watch(syncStatusProvider);\n\nif (syncStatus.pendingCount &gt; 0) {\n  // Mostrar indicador de cambios pendientes\n  SyncStatusIndicator(status: syncStatus);\n}\n\n// Texto descriptivo\nsyncStatus.statusText; // \"Sincronizando...\", \"2 cambio(s) pendiente(s)\", \"Sincronizado\"\nsyncStatus.timeSinceLastSync; // \"Hace 5 min\", \"Hace 1 h\"\n</code></pre>"},{"location":"docs/mobile/features/#rescues","title":"Rescues","text":"<p>Coordinaci\u00f3n de rescates de animales con geolocalizaci\u00f3n.</p>"},{"location":"docs/mobile/features/#funcionalidades_4","title":"Funcionalidades","text":"<ul> <li>Crear rescate: Reportar animal en situaci\u00f3n de emergencia</li> <li>Geolocalizaci\u00f3n: Ubicaci\u00f3n exacta del animal</li> <li>Asignaci\u00f3n: Match con rescatistas cercanos</li> <li>Seguimiento: Estado del rescate en tiempo real</li> <li>Historial: Rescates completados</li> </ul>"},{"location":"docs/mobile/features/#estructura_4","title":"Estructura","text":"<pre><code>features/rescues/\n\u251c\u2500\u2500 domain/\n\u2502   \u251c\u2500\u2500 entities/\n\u2502   \u2502   \u2514\u2500\u2500 rescue.dart\n\u2502   \u2514\u2500\u2500 repositories/\n\u2502       \u2514\u2500\u2500 rescue_repository_interface.dart\n\u251c\u2500\u2500 data/\n\u2502   \u2514\u2500\u2500 repositories/\n\u2502       \u2514\u2500\u2500 rescue_repository.dart\n\u2514\u2500\u2500 presentation/\n    \u251c\u2500\u2500 pages/\n    \u2502   \u251c\u2500\u2500 create_rescue_page.dart\n    \u2502   \u251c\u2500\u2500 rescue_detail_page.dart\n    \u2502   \u2514\u2500\u2500 rescue_history_page.dart\n    \u2514\u2500\u2500 providers/\n        \u2514\u2500\u2500 rescue_provider.dart\n</code></pre>"},{"location":"docs/mobile/features/#geolocalizacion","title":"Geolocalizaci\u00f3n","text":"<p>El sistema de geolocalizaci\u00f3n permite ubicar rescates con precisi\u00f3n.</p> <pre><code>sequenceDiagram\n    participant UI as Pagina Crear Rescate\n    participant GP as GeolocationProvider\n    participant GS as GeolocationService\n    participant Perm as Permisos\n    participant GPS as Dispositivo GPS\n\n    UI-&gt;&gt;GP: getCurrentPosition()\n    GP-&gt;&gt;Perm: Verificar permisos\n\n    alt Permisos concedidos\n        Perm--&gt;&gt;GP: Concedidos\n        GP-&gt;&gt;GS: getPosition()\n        GS-&gt;&gt;GPS: Solicitar ubicacion\n        GPS--&gt;&gt;GS: Posicion(lat, lng)\n        GS--&gt;&gt;GP: Posicion\n        GP--&gt;&gt;UI: Posicion\n    else Permisos denegados\n        Perm--&gt;&gt;GP: Denegados\n        GP-&gt;&gt;UI: Solicitar permisos\n        UI-&gt;&gt;Perm: requestPermissions()\n        Perm--&gt;&gt;UI: Resultado\n    end\n\n    UI-&gt;&gt;UI: Mostrar mapa con marcador\n</code></pre> <p>Uso en c\u00f3digo:</p> <pre><code>// Obtener ubicaci\u00f3n actual\nfinal position = await ref.read(geolocationProvider.notifier).getCurrentPosition();\n\n// Usar en formulario de rescate\nCreateRescueInput(\n  latitude: position.latitude,\n  longitude: position.longitude,\n  description: 'Perro abandonado en...',\n);\n</code></pre>"},{"location":"docs/mobile/features/#settings","title":"Settings","text":"<p>Configuraci\u00f3n de preferencias de la aplicaci\u00f3n.</p>"},{"location":"docs/mobile/features/#funcionalidades_5","title":"Funcionalidades","text":"<ul> <li>Tema: Modo claro, oscuro, o seguir sistema</li> <li>Idioma: Espa\u00f1ol, Ingl\u00e9s</li> <li>Notificaciones: Preferencias de push notifications</li> <li>Cuenta: Cerrar sesi\u00f3n, eliminar cuenta</li> </ul>"},{"location":"docs/mobile/features/#estructura_5","title":"Estructura","text":"<pre><code>features/settings/\n\u2514\u2500\u2500 presentation/\n    \u251c\u2500\u2500 pages/\n    \u2502   \u2514\u2500\u2500 settings_page.dart\n    \u2514\u2500\u2500 widgets/\n        \u251c\u2500\u2500 theme_selector.dart\n        \u2514\u2500\u2500 language_selector.dart\n</code></pre>"},{"location":"docs/mobile/features/#cambiar-tema","title":"Cambiar Tema","text":"<p>El sistema de temas permite cambiar entre modo claro, oscuro o seguir el sistema.</p> <pre><code>sequenceDiagram\n    participant UI as Pagina Configuracion\n    participant TP as ThemeProvider\n    participant TN as ThemeNotifier\n    participant Prefs as SharedPreferences\n    participant App as MaterialApp\n\n    UI-&gt;&gt;TP: Leer tema actual\n    TP--&gt;&gt;UI: ThemeMode.dark\n\n    UI-&gt;&gt;TN: setThemeMode(light)\n    TN-&gt;&gt;Prefs: Guardar preferencia\n    Prefs--&gt;&gt;TN: Guardado\n    TN-&gt;&gt;TP: Actualizar estado\n    TP-&gt;&gt;App: Rebuild con nuevo tema\n    App--&gt;&gt;UI: UI actualiza\n</code></pre> <p>Uso en c\u00f3digo:</p> <pre><code>// Leer tema actual\nfinal themeMode = ref.watch(themeModeProvider);\n\n// Cambiar tema\nfinal notifier = await ref.read(themeNotifierInstanceProvider.future);\nawait notifier.setThemeMode(AppThemeMode.dark);\n</code></pre>"},{"location":"docs/mobile/features/#onboarding","title":"Onboarding","text":"<p>Flujo de registro paso a paso para nuevos usuarios.</p>"},{"location":"docs/mobile/features/#funcionalidades_6","title":"Funcionalidades","text":"<ul> <li>Selecci\u00f3n de rol: Adoptante, Rescatista, Organizaci\u00f3n</li> <li>Informaci\u00f3n b\u00e1sica: Nombre, email, tel\u00e9fono</li> <li>Ubicaci\u00f3n: Pa\u00eds, provincia, cant\u00f3n, distrito</li> <li>Verificaci\u00f3n: Email o tel\u00e9fono</li> </ul>"},{"location":"docs/mobile/features/#flujo-de-onboarding","title":"Flujo de Onboarding","text":"<pre><code>state-v2\n    [*] --&gt; RoleSelection: Iniciar\n    RoleSelection --&gt; PersonalInfo: Seleccionar rol\n    PersonalInfo --&gt; Location: Completar info\n    Location --&gt; Verification: Seleccionar ubicacion\n    Verification --&gt; Complete: Verificar\n    Complete --&gt; [*]: Registro exitoso\n\n    RoleSelection --&gt; RoleSelection: Cambiar rol\n    PersonalInfo --&gt; RoleSelection: Volver\n    Location --&gt; PersonalInfo: Volver\n    Verification --&gt; Location: Volver\n</code></pre>"},{"location":"docs/mobile/features/#estructura_6","title":"Estructura","text":"<pre><code>features/onboarding/\n\u2514\u2500\u2500 presentation/\n    \u251c\u2500\u2500 pages/\n    \u2502   \u251c\u2500\u2500 onboarding_page.dart\n    \u2502   \u251c\u2500\u2500 role_selection_page.dart\n    \u2502   \u251c\u2500\u2500 personal_info_page.dart\n    \u2502   \u2514\u2500\u2500 verification_page.dart\n    \u2514\u2500\u2500 providers/\n        \u2514\u2500\u2500 onboarding_provider.dart\n</code></pre>"},{"location":"docs/mobile/features/#crear-nueva-feature","title":"Crear Nueva Feature","text":""},{"location":"docs/mobile/features/#1-generar-estructura-de-carpetas","title":"1. Generar Estructura de Carpetas","text":"<pre><code>mkdir -p lib/features/nueva_feature/{domain/{entities,repositories},data/{models,repositories},presentation/{pages,providers,widgets}}\n</code></pre>"},{"location":"docs/mobile/features/#2-crear-entidad","title":"2. Crear Entidad","text":"<pre><code>// lib/features/nueva_feature/domain/entities/mi_entidad.dart\nimport 'package:freezed_annotation/freezed_annotation.dart';\n\npart 'mi_entidad.freezed.dart';\npart 'mi_entidad.g.dart';\n\n@freezed\nclass MiEntidad with _$MiEntidad {\n  const factory MiEntidad({\n    required String id,\n    required String nombre,\n  }) = _MiEntidad;\n\n  factory MiEntidad.fromJson(Map&lt;String, dynamic&gt; json) =&gt;\n      _$MiEntidadFromJson(json);\n}\n</code></pre>"},{"location":"docs/mobile/features/#3-crear-interface-de-repositorio","title":"3. Crear Interface de Repositorio","text":"<pre><code>// lib/features/nueva_feature/domain/repositories/mi_repositorio_interface.dart\nimport 'package:dartz/dartz.dart';\nimport 'package:altrupets/core/error/failures.dart';\n\nabstract class MiRepositorioInterface {\n  Future&lt;Either&lt;Failure, List&lt;MiEntidad&gt;&gt;&gt; getAll();\n  Future&lt;Either&lt;Failure, MiEntidad&gt;&gt; getById(String id);\n  Future&lt;Either&lt;Failure, MiEntidad&gt;&gt; create(CreateInput input);\n}\n</code></pre>"},{"location":"docs/mobile/features/#4-implementar-repositorio","title":"4. Implementar Repositorio","text":"<pre><code>// lib/features/nueva_feature/data/repositories/mi_repositorio.dart\nclass MiRepositorio implements MiRepositorioInterface {\n  final GraphQLClient _client = GraphQLClientService.getClient();\n\n  @override\n  Future&lt;Either&lt;Failure, List&lt;MiEntidad&gt;&gt;&gt; getAll() async {\n    try {\n      final result = await _client.query(...);\n      if (result.hasException) {\n        return Left(ServerFailure(result.exception.toString()));\n      }\n      return Right(...);\n    } catch (e) {\n      return Left(ServerFailure(e.toString()));\n    }\n  }\n}\n</code></pre>"},{"location":"docs/mobile/features/#5-crear-provider","title":"5. Crear Provider","text":"<pre><code>// lib/features/nueva_feature/presentation/providers/mi_provider.dart\n@freezed\nclass MiState with _$MiState {\n  const factory MiState({\n    @Default(false) bool isLoading,\n    @Default([]) List&lt;MiEntidad&gt; items,\n    String? error,\n  }) = _MiState;\n}\n\nclass MiNotifier extends StateNotifier&lt;MiState&gt; {\n  MiNotifier(this._repository) : super(const MiState());\n  final MiRepositorioInterface _repository;\n\n  Future&lt;void&gt; loadItems() async {\n    state = state.copyWith(isLoading: true);\n    final result = await _repository.getAll();\n    result.fold(\n      (failure) =&gt; state = state.copyWith(\n        isLoading: false,\n        error: failure.message,\n      ),\n      (items) =&gt; state = state.copyWith(\n        isLoading: false,\n        items: items,\n      ),\n    );\n  }\n}\n\nfinal miProvider = StateNotifierProvider&lt;MiNotifier, MiState&gt;((ref) {\n  return MiNotifier(ref.watch(miRepositorioProvider));\n});\n</code></pre>"},{"location":"docs/mobile/features/#6-generar-codigo","title":"6. Generar C\u00f3digo","text":"<pre><code>flutter pub run build_runner build --delete-conflicting-outputs\n</code></pre>"},{"location":"docs/mobile/features/#7-crear-paginas","title":"7. Crear P\u00e1ginas","text":"<pre><code>// lib/features/nueva_feature/presentation/pages/mi_page.dart\nclass MiPage extends ConsumerWidget {\n  const MiPage({super.key});\n\n  @override\n  Widget build(BuildContext context, WidgetRef ref) {\n    final state = ref.watch(miProvider);\n\n    if (state.isLoading) {\n      return const Center(child: CircularProgressIndicator());\n    }\n\n    if (state.error != null) {\n      return Center(child: Text(state.error!));\n    }\n\n    return ListView.builder(\n      itemCount: state.items.length,\n      itemBuilder: (context, index) =&gt; ListTile(\n        title: Text(state.items[index].nombre),\n      ),\n    );\n  }\n}\n</code></pre>"},{"location":"docs/mobile/getting-started/","title":"\ud83d\ude80 Getting Started","text":"<p>Gu\u00eda completa para configurar y ejecutar AltruPets Mobile en tu entorno de desarrollo.</p>"},{"location":"docs/mobile/getting-started/#prerrequisitos","title":"Prerrequisitos","text":""},{"location":"docs/mobile/getting-started/#software-requerido","title":"Software Requerido","text":"Software Versi\u00f3n M\u00ednima Prop\u00f3sito Flutter SDK 3.10.4+ Framework Dart SDK 3.0+ Incluido con Flutter Android Studio 2023.1+ IDE y Android SDK Xcode 14.0+ Solo macOS, para iOS VS Code Latest IDE alternativo"},{"location":"docs/mobile/getting-started/#verificar-instalacion","title":"Verificar Instalaci\u00f3n","text":"<pre><code># Verificar que Flutter est\u00e1 correctamente instalado\nflutter doctor -v\n\n# Output esperado:\n# [\u2713] Flutter (Channel stable, 3.10.x)\n# [\u2713] Android toolchain\n# [\u2713] Xcode (solo macOS)\n# [\u2713] Chrome\n# [\u2713] Android Studio\n</code></pre>"},{"location":"docs/mobile/getting-started/#extensiones-recomendadas-vs-code","title":"Extensiones Recomendadas (VS Code)","text":"<ul> <li>Flutter - Dart-Code.flutter</li> <li>Dart - Dart-Code.dart-code</li> <li>Riverpod Snippets - robert-brunhage.flutter-riverpod-snippets</li> <li>Error Lens - usernamehw.errorlens</li> </ul>"},{"location":"docs/mobile/getting-started/#instalacion","title":"Instalaci\u00f3n","text":""},{"location":"docs/mobile/getting-started/#1-clonar-el-repositorio","title":"1. Clonar el Repositorio","text":"<pre><code>git clone https://github.com/altrupets/monorepo.git\ncd monorepo/apps/mobile\n</code></pre>"},{"location":"docs/mobile/getting-started/#2-instalar-dependencias","title":"2. Instalar Dependencias","text":"<pre><code>flutter pub get\n</code></pre>"},{"location":"docs/mobile/getting-started/#3-generar-codigo","title":"3. Generar C\u00f3digo","text":"<p>El proyecto usa Freezed y JSON Serializable para generar c\u00f3digo:</p> <pre><code># Generar una vez\nflutter pub run build_runner build --delete-conflicting-outputs\n\n# O en modo watch (regenera autom\u00e1ticamente al guardar)\nflutter pub run build_runner watch --delete-conflicting-outputs\n</code></pre> <p>Archivos Generados</p> <p>Los archivos <code>*.freezed.dart</code> y <code>*.g.dart</code> son generados autom\u00e1ticamente. No los edites manualmente - tus cambios se perder\u00e1n.</p>"},{"location":"docs/mobile/getting-started/#4-generar-localizaciones","title":"4. Generar Localizaciones","text":"<pre><code>flutter gen-l10n\n</code></pre> <p>Esto genera <code>lib/l10n/app_localizations.dart</code> desde los archivos <code>.arb</code>.</p>"},{"location":"docs/mobile/getting-started/#flujo-de-desarrollo-completo-dev","title":"Flujo de Desarrollo Completo (DEV)","text":"<p>AltruPets usa un flujo de desarrollo basado en Kubernetes local (Minikube) con ArgoCD para GitOps. El <code>Makefile</code> en la ra\u00edz del monorepo automatiza todo el proceso.</p>"},{"location":"docs/mobile/getting-started/#setup-inicial-primera-vez","title":"Setup Inicial (Primera Vez)","text":"<pre><code># 1. Setup del entorno\nmake setup\n\n# 2. Crear cluster Minikube\nmake dev-minikube-deploy\n\n# 3. Desplegar Gateway API (instala CRDs)\nmake dev-gateway-deploy\n\n# 4. Construir imagen del backend\nmake dev-backend-build\n\n# 5. Desplegar ArgoCD + todas las apps\nmake dev-argocd-deploy\n\n# 6. Iniciar port-forward del Gateway\nmake dev-gateway-start\n</code></pre>"},{"location":"docs/mobile/getting-started/#comandos-utiles-del-makefile","title":"Comandos \u00datiles del Makefile","text":"<p>Minikube:</p> <pre><code>make dev-minikube-deploy          # Crear cluster\nmake dev-minikube-clear           # Limpiar namespaces estancados\nmake dev-minikube-destroy         # Eliminar cluster\n</code></pre> <p>Backend:</p> <pre><code>make dev-backend-build            # Rebuild imagen + rollout restart\nmake dev-backend-start            # Iniciar backend en modo dev\n</code></pre> <p>Gateway:</p> <pre><code>make dev-gateway-start            # Port-forward a localhost:3001\nmake dev-gateway-stop             # Detener port-forward\n</code></pre> <p>ArgoCD:</p> <pre><code>make dev-argocd-deploy            # Instalar ArgoCD + apps\nmake dev-argocd-status            # Ver estado de aplicaciones\nmake dev-argocd-password          # Obtener password de admin\nmake dev-argocd-destroy           # Eliminar ArgoCD\n</code></pre> <p>PostgreSQL:</p> <pre><code>make dev-postgres-deploy          # Desplegar PostgreSQL\nmake dev-postgres-logs            # Ver logs\nmake dev-postgres-port-forward    # Port-forward a localhost:5432\n</code></pre> <p>Aplicaciones Web:</p> <pre><code>make dev-superusers-start         # CRUD Superusers local\nmake dev-superusers-deploy        # Deploy a Kubernetes\nmake dev-b2g-start                # B2G local\nmake dev-b2g-deploy               # Deploy a Kubernetes\n</code></pre> <p>Utilidades:</p> <pre><code>make dev-superuser-seed           # Crear usuario SUPER_USER\nmake help                         # Ver todos los comandos\n</code></pre>"},{"location":"docs/mobile/getting-started/#flujo-de-trabajo-tipico","title":"Flujo de Trabajo T\u00edpico","text":"<pre><code># 1. Iniciar el d\u00eda\nmake dev-minikube-deploy          # Si no est\u00e1 corriendo\nmake dev-gateway-start            # Port-forward del backend\n\n# 2. Desarrollar en mobile\ncd apps/mobile\nmake dev-mobile-launch-desktop              # Desktop para pruebas r\u00e1pidas\n# o\nmake dev-mobile-launch-emulator              # Emulador Android\n\n# 3. Si cambias el backend\nmake dev-backend-build            # Rebuild + redeploy autom\u00e1tico\n\n# 4. Ver logs del backend\nkubectl -n altrupets-dev logs -f deploy/backend --tail=100\n\n# 5. Al terminar (opcional)\nmake dev-gateway-stop             # Detener port-forward\n</code></pre>"},{"location":"docs/mobile/getting-started/#endpoints-disponibles","title":"Endpoints Disponibles","text":"<p>Cuando el Gateway est\u00e1 activo (<code>make dev-gateway-start</code>):</p> Endpoint Descripci\u00f3n <code>http://localhost:3001/graphql</code> API GraphQL del backend <code>http://localhost:3001/admin/login</code> CRUD Superusers <code>http://localhost:3001/b2g/login</code> B2G (Business to Good)"},{"location":"docs/mobile/getting-started/#troubleshooting-del-entorno","title":"Troubleshooting del Entorno","text":"<p>Backend no est\u00e1 Ready:</p> <pre><code># Ver estado\nkubectl -n altrupets-dev get pods\n\n# Ver logs\nkubectl -n altrupets-dev logs -f deploy/backend\n\n# Rebuild forzado\nmake dev-backend-build\n\n# Limpiar pods estancados\nmake dev-minikube-clear\n</code></pre> <p>Port-forward no funciona:</p> <pre><code># Detener todos los port-forwards\nmake dev-gateway-stop\n\n# Reiniciar\nmake dev-gateway-start\n</code></pre> <p>Minikube lento o sin recursos:</p> <pre><code># Recrear con m\u00e1s recursos (edita Makefile o script)\nmake dev-minikube-destroy\n# Edita: minikube start --cpus=8 --memory=16384\nmake dev-minikube-deploy\n</code></pre>"},{"location":"docs/mobile/getting-started/#configuracion-del-backend","title":"Configuraci\u00f3n del Backend","text":""},{"location":"docs/mobile/getting-started/#url-del-backend","title":"URL del Backend","text":"<p>Edita <code>lib/core/utils/constants.dart</code>:</p> <pre><code>class AppConstants {\n  // Desarrollo local\n  static const String baseUrl = 'http://localhost:4000';\n\n  // Para emulador Android (localhost no funciona)\n  // static const String baseUrl = 'http://10.0.2.2:4000';\n\n  // Para dispositivo f\u00edsico Android (usa tu IP local)\n  // static const String baseUrl = 'http://192.168.1.100:4000';\n\n  // Staging\n  // static const String baseUrl = 'https://api-staging.altrupets.com';\n\n  // Producci\u00f3n\n  // static const String baseUrl = 'https://api.altrupets.com';\n}\n</code></pre>"},{"location":"docs/mobile/getting-started/#variables-de-entorno-opcional","title":"Variables de Entorno (Opcional)","text":"<p>Para m\u00faltiples ambientes, considera usar <code>flutter_dotenv</code>:</p> <pre><code># .env.development\nAPI_URL=http://localhost:4000\n\n# .env.staging\nAPI_URL=https://api-staging.altrupets.com\n\n# .env.production\nAPI_URL=https://api.altrupets.com\n</code></pre>"},{"location":"docs/mobile/getting-started/#ejecutar-la-aplicacion","title":"Ejecutar la Aplicaci\u00f3n","text":""},{"location":"docs/mobile/getting-started/#script-de-lanzamiento-automatizado","title":"Script de Lanzamiento Automatizado","text":"<p>AltruPets incluye comandos <code>make dev-mobile-*</code> que automatizan el flujo completo de desarrollo:</p> <pre><code># Desde la ra\u00edz del monorepo\nmake dev-mobile-launch  # Men\u00fa interactivo\n</code></pre>"},{"location":"docs/mobile/getting-started/#opciones-disponibles","title":"Opciones Disponibles","text":"<p>Desktop (Pruebas R\u00e1pidas):</p> <pre><code>make dev-mobile-launch-desktop, --linux       # Linux desktop\n</code></pre> <p>Android:</p> <pre><code>make dev-mobile-launch-desktop          # Linux desktop\nmake dev-mobile-launch-emulator         # Emulador Android\nmake dev-mobile-launch-device           # Dispositivo f\u00edsico Android\n</code></pre> <p>Widgetbook (Cat\u00e1logo de Widgets):</p> <pre><code>make dev-mobile-widgetbook  # Abre Widgetbook en Linux desktop\n</code></pre> <p>Opciones Globales:</p> <pre><code>--dirty                          # Saltar 'flutter clean' (\u00fatil en Android)\n--no-backend-check               # No verificar backend en Kubernetes\n--no-backend-auto-build          # No build autom\u00e1tico si hay ImagePullBackOff\n--backend-retries N              # Intentos de recuperaci\u00f3n backend (default: 5)\n--backend-redeploy-argo          # Flujo GitOps: build + refresh/sync ArgoCD\n--backend-rollout-restart        # Flujo imperativo: rollout restart\n--no-backend-prune               # No eliminar pods backend en CrashLoopBackOff\n--no-backend-logs-window         # No abrir ventana con logs del backend\n--no-adb-reverse                 # No configurar adb reverse en --device\n</code></pre>"},{"location":"docs/mobile/getting-started/#menu-interactivo","title":"Men\u00fa Interactivo","text":"<p>Si ejecutas el script sin argumentos, se muestra un men\u00fa interactivo:</p> <pre><code>make dev-mobile-launch\n\n# \ud83d\udcf1 AltruPets \u2014 Selecciona destino:\n#   1) \ud83d\udda5\ufe0f  Linux desktop (prueba r\u00e1pida)\n#   2) \ud83d\udcf1 Emulador Android\n#   3) \ud83d\udcf2 Dispositivo Android f\u00edsico\n#   4) \ud83d\udcd6 Widgetbook (cat\u00e1logo de widgets)\n# Opci\u00f3n [1-4]:\n</code></pre>"},{"location":"docs/mobile/getting-started/#caracteristicas-del-script","title":"Caracter\u00edsticas del Script","text":"<p>El script <code>apps/mobile/launch_flutter_debug.sh</code> (invocado por <code>make dev-mobile-*</code>) realiza autom\u00e1ticamente:</p> <ol> <li>Verificaci\u00f3n de Backend: Comprueba que el backend en Kubernetes est\u00e9 Ready</li> <li>Recuperaci\u00f3n Autom\u00e1tica: Intenta resolver problemas comunes (ImagePullBackOff, pods estancados)</li> <li>Port-Forward Autom\u00e1tico: Configura t\u00faneles para acceder al backend desde la app</li> <li>adb reverse (Android): Configura t\u00fanel <code>localhost:3001</code> en dispositivos f\u00edsicos</li> <li>Logs Centralizados: Guarda logs en <code>logs/mobile/&lt;device&gt;/launch-&lt;timestamp&gt;.log</code></li> <li>Ventana de Logs Backend: Abre terminal separada con logs del backend (Linux)</li> </ol>"},{"location":"docs/mobile/getting-started/#ejemplos-de-uso","title":"Ejemplos de Uso","text":"<pre><code># Desarrollo r\u00e1pido en desktop\nmake dev-mobile-launch-desktop\n\n# Android con build limpio\nmake dev-mobile-launch-emulator\n\n# Android sin limpiar cach\u00e9 (m\u00e1s r\u00e1pido)\nmake dev-mobile-launch-device  # Usa --dirty por defecto\n\n# Con recuperaci\u00f3n autom\u00e1tica del backend\nmake dev-mobile-launch-emulator --backend-retries 10\n\n# Sin verificar backend (desarrollo offline)\nmake dev-mobile-launch-desktop --no-backend-check\n</code></pre>"},{"location":"docs/mobile/getting-started/#listar-dispositivos-disponibles","title":"Listar Dispositivos Disponibles","text":"<pre><code>flutter devices\n\n# Output ejemplo:\n# 3 connected devices:\n# Pixel 6 (mobile)      \u2022 emulator-5554      \u2022 android-arm64\n# macOS (desktop)       \u2022 macos              \u2022 darwin-x64\n# Chrome (web)          \u2022 chrome             \u2022 web-javascript\n</code></pre>"},{"location":"docs/mobile/getting-started/#ejecutar-manualmente-sin-script","title":"Ejecutar Manualmente (Sin Script)","text":"<pre><code># Dispositivo por defecto\nflutter run\n\n# Dispositivo espec\u00edfico\nflutter run -d emulator-5554\nflutter run -d chrome\n\n# Con verbose logging\nflutter run -v\n</code></pre>"},{"location":"docs/mobile/getting-started/#ejecutar-en-modo-release","title":"Ejecutar en Modo Release","text":"<pre><code># Android\nflutter run --release\n\n# iOS (requiere perfil de provisi\u00f3n)\nflutter run --release -d &lt;ios-device-id&gt;\n</code></pre>"},{"location":"docs/mobile/getting-started/#hot-reload-vs-hot-restart","title":"Hot Reload vs Hot Restart","text":"Acci\u00f3n Atajo Uso Hot Reload <code>r</code> Cambios en UI, preserva estado Hot Restart <code>R</code> Reinicia app, pierde estado Quit <code>q</code> Salir de flutter run"},{"location":"docs/mobile/getting-started/#build-para-produccion","title":"Build para Producci\u00f3n","text":""},{"location":"docs/mobile/getting-started/#android","title":"Android","text":"<pre><code># APK (para distribuci\u00f3n directa)\nflutter build apk --release\n# Output: build/app/outputs/flutter-apk/app-release.apk\n\n# App Bundle (para Play Store)\nflutter build appbundle --release\n# Output: build/app/outputs/bundle/release/app-release.aab\n\n# Con ofuscaci\u00f3n (recomendado para producci\u00f3n)\nflutter build appbundle --release --obfuscate --split-debug-info=build/debug-info\n</code></pre>"},{"location":"docs/mobile/getting-started/#ios","title":"iOS","text":"<pre><code># Build para archivo (requiere Xcode)\nflutter build ios --release\n\n# Luego en Xcode:\n# Product &gt; Archive &gt; Distribute App\n</code></pre>"},{"location":"docs/mobile/getting-started/#firmar-builds","title":"Firmar Builds","text":""},{"location":"docs/mobile/getting-started/#android_1","title":"Android","text":"<p>Crea <code>android/key.properties</code>:</p> <pre><code>storePassword=&lt;password&gt;\nkeyPassword=&lt;password&gt;\nkeyAlias=upload\nstoreFile=&lt;path-to-keystore&gt;/upload-keystore.jks\n</code></pre>"},{"location":"docs/mobile/getting-started/#ios_1","title":"iOS","text":"<p>Configura en Xcode: 1. Signing &amp; Capabilities 2. Selecciona tu Team 3. Configura Bundle Identifier</p>"},{"location":"docs/mobile/getting-started/#testing","title":"Testing","text":""},{"location":"docs/mobile/getting-started/#ejecutar-tests","title":"Ejecutar Tests","text":"<pre><code># Todos los tests\nflutter test\n\n# Test espec\u00edfico\nflutter test test/features/auth/auth_provider_test.dart\n\n# Con coverage\nflutter test --coverage\n\n# Ver reporte de coverage\ngenhtml coverage/lcov.info -o coverage/html\nopen coverage/html/index.html\n</code></pre>"},{"location":"docs/mobile/getting-started/#estructura-de-tests","title":"Estructura de Tests","text":"<pre><code>test/\n\u251c\u2500\u2500 features/\n\u2502   \u251c\u2500\u2500 auth/\n\u2502   \u2502   \u251c\u2500\u2500 auth_provider_test.dart\n\u2502   \u2502   \u2514\u2500\u2500 auth_repository_test.dart\n\u2502   \u2514\u2500\u2500 profile/\n\u2502       \u2514\u2500\u2500 profile_provider_test.dart\n\u251c\u2500\u2500 core/\n\u2502   \u251c\u2500\u2500 graphql_client_test.dart\n\u2502   \u2514\u2500\u2500 failures_test.dart\n\u2514\u2500\u2500 widget_test.dart\n</code></pre>"},{"location":"docs/mobile/getting-started/#comandos-utiles","title":"Comandos \u00datiles","text":""},{"location":"docs/mobile/getting-started/#limpieza-y-mantenimiento","title":"Limpieza y Mantenimiento","text":"<pre><code># Limpiar cach\u00e9 y builds\nflutter clean\n\n# Regenerar pubspec.lock\nrm pubspec.lock &amp;&amp; flutter pub get\n\n# Actualizar dependencias\nflutter pub upgrade\n\n# Ver dependencias desactualizadas\nflutter pub outdated\n</code></pre>"},{"location":"docs/mobile/getting-started/#analisis-de-codigo","title":"An\u00e1lisis de C\u00f3digo","text":"<pre><code># Usar script SAST (recomendado)\n./flutter-sast.sh analyze    # dart analyze\n./flutter-sast.sh test       # unit tests\n./flutter-sast.sh coverage   # tests con coverage\n./flutter-sast.sh lint       # all linting\n./flutter-sast.sh all        # full analysis\n\n# O comandos directos\nflutter analyze\ndart format lib/\ndart fix --apply\n</code></pre>"},{"location":"docs/mobile/getting-started/#debugging","title":"Debugging","text":"<pre><code># Ver logs del dispositivo\nflutter logs\n\n# Capturar screenshot\nflutter screenshot\n\n# Abrir DevTools\nflutter pub global activate devtools\ndevtools\n</code></pre>"},{"location":"docs/mobile/getting-started/#troubleshooting","title":"Troubleshooting","text":""},{"location":"docs/mobile/getting-started/#problemas-con-los-comandos-make-dev-mobile-","title":"Problemas con los Comandos make dev-mobile-*","text":""},{"location":"docs/mobile/getting-started/#error-backend-no-disponible-abortando-launch","title":"Error: \"Backend no disponible. Abortando launch\"","text":"<p>Causa: El backend en Kubernetes no est\u00e1 Ready.</p> <p>Soluci\u00f3n:</p> <pre><code># Ver estado del backend\nkubectl -n altrupets-dev get pods\n\n# Ver logs\nkubectl -n altrupets-dev logs -f deploy/backend --tail=50\n\n# Rebuild del backend\nmake dev-backend-build\n\n# Si persiste, usar --no-backend-check\nmake dev-mobile-launch-desktop --no-backend-check\n</code></pre>"},{"location":"docs/mobile/getting-started/#error-no-se-detecto-dispositivo-o-emulador-android","title":"Error: \"No se detect\u00f3 dispositivo o emulador Android\"","text":"<p>Causa: No hay dispositivos Android conectados o emuladores activos.</p> <p>Soluci\u00f3n:</p> <pre><code># Listar emuladores disponibles\nflutter emulators\n\n# Lanzar emulador\nflutter emulators --launch &lt;emulator-id&gt;\n\n# Verificar dispositivos\nflutter devices\nadb devices\n</code></pre>"},{"location":"docs/mobile/getting-started/#error-adb-reverse-failed","title":"Error: \"adb reverse failed\"","text":"<p>Causa: Dispositivo Android no autorizado o sin depuraci\u00f3n USB.</p> <p>Soluci\u00f3n: 1. Habilita \"Depuraci\u00f3n USB\" en el dispositivo 2. Acepta el di\u00e1logo de autorizaci\u00f3n 3. Verifica con <code>adb devices</code> 4. O usa <code>--no-adb-reverse</code> y configura IP manualmente</p>"},{"location":"docs/mobile/getting-started/#backend-en-crashloopbackoff","title":"Backend en CrashLoopBackOff","text":"<p>Causa: Error en la imagen del backend o secretos desincronizados.</p> <p>Soluci\u00f3n:</p> <pre><code># El script intenta recuperaci\u00f3n autom\u00e1tica, pero puedes forzar:\nmake dev-backend-build\n\n# O con el script:\nmake dev-mobile-launch-desktop --backend-rollout-restart\n\n# Limpiar pods estancados\nmake dev-minikube-clear\n</code></pre>"},{"location":"docs/mobile/getting-started/#logs-no-se-guardan","title":"Logs no se guardan","text":"<p>Causa: Permisos o directorio <code>logs/mobile/</code> no existe.</p> <p>Soluci\u00f3n:</p> <pre><code># Crear directorio manualmente\nmkdir -p logs/mobile/android-device\nmkdir -p logs/mobile/android-emulator\nmkdir -p logs/mobile/linux\n\n# Verificar permisos\nchmod -R 755 logs/\n</code></pre>"},{"location":"docs/mobile/getting-started/#error-socketexception-connection-refused","title":"Error: \"SocketException: Connection refused\"","text":"<p>Causa: El backend no est\u00e1 corriendo o la URL es incorrecta.</p> <p>Soluci\u00f3n: 1. Verifica que el backend est\u00e9 corriendo:    <code>bash    kubectl -n altrupets-dev get pods    make dev-gateway-start</code> 2. Si usas emulador Android, cambia a <code>10.0.2.2:3001</code> 3. Si usas dispositivo f\u00edsico:    - Verifica <code>adb reverse</code>: <code>adb reverse --list</code>    - O usa la IP de tu m\u00e1quina: <code>192.168.x.x:3001</code></p>"},{"location":"docs/mobile/getting-started/#error-could-not-find-generator-freezed","title":"Error: \"Could not find generator 'freezed'\"","text":"<p>Causa: build_runner no est\u00e1 instalado o cach\u00e9 corrupto.</p> <p>Soluci\u00f3n:</p> <pre><code>flutter clean\nflutter pub get\nflutter pub run build_runner build --delete-conflicting-outputs\n</code></pre>"},{"location":"docs/mobile/getting-started/#error-gradle-build-failed","title":"Error: \"Gradle build failed\"","text":"<p>Soluci\u00f3n:</p> <pre><code>cd android\n./gradlew clean\ncd ..\nflutter clean\nflutter pub get\nflutter run\n</code></pre>"},{"location":"docs/mobile/getting-started/#error-cocoapods-not-installed-macos","title":"Error: \"CocoaPods not installed\" (macOS)","text":"<p>Soluci\u00f3n:</p> <pre><code>sudo gem install cocoapods\ncd ios\npod install\ncd ..\n</code></pre>"},{"location":"docs/mobile/getting-started/#hot-reload-no-funciona","title":"Hot Reload no funciona","text":"<p>Causa: Cambios en c\u00f3digo nativo o archivos de configuraci\u00f3n.</p> <p>Soluci\u00f3n: Usa Hot Restart (<code>R</code>) o reinicia completamente con <code>flutter run</code>.</p>"},{"location":"docs/mobile/getting-started/#port-forward-se-desconecta-constantemente","title":"Port-forward se desconecta constantemente","text":"<p>Causa: Minikube inestable o recursos insuficientes.</p> <p>Soluci\u00f3n:</p> <pre><code># Reiniciar port-forward\nmake dev-gateway-stop\nmake dev-gateway-start\n\n# O aumentar recursos de Minikube (edita Makefile)\nmake dev-minikube-destroy\n# Edita: --cpus=8 --memory=16384\nmake dev-minikube-deploy\n</code></pre>"},{"location":"docs/mobile/getting-started/#widgetbook-no-abre-en-chrome","title":"Widgetbook no abre en Chrome","text":"<p>Causa: Chrome no est\u00e1 disponible como dispositivo Flutter.</p> <p>Soluci\u00f3n:</p> <pre><code># Verificar dispositivos\nflutter devices\n\n# Si Linux desktop no aparece, verifica que est\u00e9 habilitado\nflutter config --enable-linux-desktop\nmake dev-mobile-widgetbook\n\n# O ejecuta manualmente\ncd apps/widgetbook\nflutter run -d linux  # o macos/windows\n</code></pre>"},{"location":"docs/mobile/getting-started/#logs-y-debugging-avanzado","title":"Logs y Debugging Avanzado","text":""},{"location":"docs/mobile/getting-started/#logs-centralizados-make-dev-mobile-","title":"Logs Centralizados (make dev-mobile-*)","text":"<p>Los comandos <code>make dev-mobile-*</code> guardan autom\u00e1ticamente todos los logs en:</p> <pre><code>logs/mobile/\n\u251c\u2500\u2500 android-device/\n\u2502   \u2514\u2500\u2500 launch-20250218-143022.log\n\u251c\u2500\u2500 android-emulator/\n\u2502   \u2514\u2500\u2500 launch-20250218-140512.log\n\u2514\u2500\u2500 linux/\n    \u2514\u2500\u2500 launch-20250218-135401.log\n</code></pre> <p>Ver logs en tiempo real:</p> <pre><code># \u00daltimo log de Android device\ntail -f logs/mobile/android-device/launch-*.log\n\n# Buscar errores\ngrep -i error logs/mobile/*/launch-*.log\n</code></pre>"},{"location":"docs/mobile/getting-started/#ventana-de-logs-del-backend-linux","title":"Ventana de Logs del Backend (Linux)","text":"<p>En Linux, el script abre autom\u00e1ticamente una terminal separada con los logs del backend:</p> <pre><code># Si no se abre autom\u00e1ticamente, ejecuta manualmente:\nkubectl -n altrupets-dev logs -f deploy/backend --tail=200\n\n# O desactiva la ventana:\nmake dev-mobile-launch-desktop --no-backend-logs-window\n</code></pre>"},{"location":"docs/mobile/getting-started/#flutter-devtools","title":"Flutter DevTools","text":"<pre><code># Activar DevTools globalmente\nflutter pub global activate devtools\n\n# Ejecutar\ndevtools\n\n# O desde flutter run:\n# Presiona 'v' para abrir DevTools en el navegador\n</code></pre>"},{"location":"docs/mobile/getting-started/#debugging-con-vs-code","title":"Debugging con VS Code","text":"<p>Crea <code>.vscode/launch.json</code>:</p> <pre><code>{\n  \"version\": \"0.2.0\",\n  \"configurations\": [\n    {\n      \"name\": \"Flutter (Debug)\",\n      \"type\": \"dart\",\n      \"request\": \"launch\",\n      \"program\": \"lib/main.dart\",\n      \"args\": [\"--dart-define=ENV=dev\"]\n    },\n    {\n      \"name\": \"Flutter (Profile)\",\n      \"type\": \"dart\",\n      \"request\": \"launch\",\n      \"program\": \"lib/main.dart\",\n      \"flutterMode\": \"profile\"\n    }\n  ]\n}\n</code></pre>"},{"location":"docs/mobile/getting-started/#analisis-de-performance","title":"An\u00e1lisis de Performance","text":"<pre><code># Ejecutar en modo profile\nflutter run --profile\n\n# Capturar timeline\nflutter screenshot --type=skia --observatory-url=&lt;url&gt;\n\n# Ver en DevTools\ndevtools --appSizeBase=&lt;path-to-app-size-json&gt;\n</code></pre>"},{"location":"docs/mobile/getting-started/#recursos-adicionales","title":"Recursos Adicionales","text":"<ul> <li>Flutter Documentation</li> <li>Riverpod Documentation</li> <li>GraphQL Flutter</li> <li>AltruPets Backend API</li> <li>Design System</li> <li>Architecture Guide</li> </ul>"},{"location":"docs/mobile/launch-script/","title":"\ud83d\ude80 Comandos de Lanzamiento (make dev-mobile-*)","text":"<p>Gu\u00eda completa de los comandos automatizados para ejecutar AltruPets Mobile con verificaci\u00f3n de backend y configuraci\u00f3n autom\u00e1tica.</p>"},{"location":"docs/mobile/launch-script/#descripcion-general","title":"Descripci\u00f3n General","text":"<p>Los comandos <code>make dev-mobile-*</code> automatizan el flujo completo de desarrollo de la aplicaci\u00f3n m\u00f3vil, invocando el script <code>apps/mobile/launch_flutter_debug.sh</code> con las opciones correctas:</p> <ul> <li>\u2705 Verificaci\u00f3n autom\u00e1tica del backend en Kubernetes</li> <li>\ud83d\udd04 Recuperaci\u00f3n autom\u00e1tica de errores comunes</li> <li>\ud83c\udf10 Configuraci\u00f3n de port-forwarding y t\u00faneles</li> <li>\ud83d\udcdd Logs centralizados por dispositivo</li> <li>\ud83e\ude9f Ventana separada con logs del backend (Linux)</li> </ul>"},{"location":"docs/mobile/launch-script/#ubicacion","title":"Ubicaci\u00f3n","text":"<pre><code># Desde la ra\u00edz del monorepo\nmake dev-mobile-launch          # Men\u00fa interactivo\nmake dev-mobile-launch-desktop  # Linux desktop\nmake dev-mobile-launch-emulator # Android emulator\nmake dev-mobile-launch-device   # Android device\nmake dev-mobile-widgetbook      # Widgetbook UI catalog\n</code></pre>"},{"location":"docs/mobile/launch-script/#sintaxis","title":"Sintaxis","text":"<pre><code>make dev-mobile-&lt;target&gt;\n</code></pre>"},{"location":"docs/mobile/launch-script/#plataformas-soportadas","title":"Plataformas Soportadas","text":""},{"location":"docs/mobile/launch-script/#desktop-pruebas-rapidas","title":"Desktop (Pruebas R\u00e1pidas)","text":"<pre><code>make dev-mobile-launch-desktop\n</code></pre> <p>Lanza la app en el escritorio nativo (Linux/macOS/Windows). Ideal para: - Pruebas r\u00e1pidas de UI - Desarrollo de l\u00f3gica de negocio - Debugging sin emulador</p>"},{"location":"docs/mobile/launch-script/#android-emulator","title":"Android Emulator","text":"<pre><code>make dev-mobile-launch-emulator\n</code></pre> <p>Lanza en el emulador Android activo. Si no hay ninguno activo, intenta lanzar el primero disponible.</p> <p>Caracter\u00edsticas: - Detecci\u00f3n autom\u00e1tica del emulador - Lanzamiento autom\u00e1tico si no est\u00e1 activo - Configuraci\u00f3n de t\u00fanel para backend</p>"},{"location":"docs/mobile/launch-script/#android-device-fisico","title":"Android Device (F\u00edsico)","text":"<pre><code>make dev-mobile-launch-device\n</code></pre> <p>Lanza en un dispositivo Android f\u00edsico conectado por USB.</p> <p>Caracter\u00edsticas: - Detecci\u00f3n autom\u00e1tica del dispositivo - Configuraci\u00f3n de <code>adb reverse</code> para t\u00fanel localhost - Verificaci\u00f3n de autorizaci\u00f3n USB</p>"},{"location":"docs/mobile/launch-script/#widgetbook-catalogo-de-widgets","title":"Widgetbook (Cat\u00e1logo de Widgets)","text":"<pre><code>make dev-mobile-widgetbook\n</code></pre> <p>Abre el cat\u00e1logo de widgets en Linux desktop.</p> <p>Caracter\u00edsticas: - Generaci\u00f3n autom\u00e1tica con <code>build_runner</code> - Ideal para desarrollo de Design System - No requiere backend activo</p>"},{"location":"docs/mobile/launch-script/#opciones-avanzadas-del-script","title":"Opciones Avanzadas del Script","text":"<p>Si necesitas opciones avanzadas, puedes invocar el script directamente desde <code>apps/mobile/</code>:</p> <pre><code>cd apps/mobile\n./launch_flutter_debug.sh [OPCIONES]\n</code></pre>"},{"location":"docs/mobile/launch-script/#-dirty","title":"--dirty","text":"<p>Salta el paso de <code>flutter clean</code> en Android.</p> <pre><code>cd apps/mobile\n./launch_flutter_debug.sh -d --dirty\n</code></pre> <p>Cu\u00e1ndo usar: - Builds incrementales r\u00e1pidos - Cuando no hay cambios en dependencias nativas - Para ahorrar tiempo en iteraciones r\u00e1pidas</p> <p>Cu\u00e1ndo NO usar: - Despu\u00e9s de cambiar dependencias en <code>pubspec.yaml</code> - Despu\u00e9s de modificar c\u00f3digo nativo (Android/iOS) - Si hay errores de build extra\u00f1os</p>"},{"location":"docs/mobile/launch-script/#-no-backend-check","title":"--no-backend-check","text":"<p>Desactiva la verificaci\u00f3n de readiness del backend en Kubernetes.</p> <pre><code>cd apps/mobile\n./launch_flutter_debug.sh --linux --no-backend-check\n</code></pre> <p>Cu\u00e1ndo usar: - Desarrollo offline - Cuando el backend no est\u00e1 en Kubernetes - Para pruebas de UI sin backend</p>"},{"location":"docs/mobile/launch-script/#-no-backend-auto-build","title":"--no-backend-auto-build","text":"<p>Desactiva el build autom\u00e1tico de la imagen del backend si hay <code>ImagePullBackOff</code>.</p> <pre><code>cd apps/mobile\n./launch_flutter_debug.sh --emulator --no-backend-auto-build\n</code></pre> <p>Cu\u00e1ndo usar: - Cuando no quieres que el script modifique el backend - En entornos CI/CD - Si prefieres hacer el build manualmente</p>"},{"location":"docs/mobile/launch-script/#-backend-retries-n","title":"--backend-retries N","text":"<p>Configura el n\u00famero de intentos de recuperaci\u00f3n del backend (default: 5).</p> <pre><code>cd apps/mobile\n./launch_flutter_debug.sh --emulator --backend-retries 10\n</code></pre> <p>Cu\u00e1ndo usar: - Backend lento en iniciar - Recursos limitados en Minikube - Debugging de problemas de deployment</p>"},{"location":"docs/mobile/launch-script/#-backend-redeploy-argo","title":"--backend-redeploy-argo","text":"<p>Flujo GitOps: build local + refresh/sync de ArgoCD (sin <code>rollout restart</code> manual).</p> <pre><code>cd apps/mobile\n./launch_flutter_debug.sh --emulator --backend-redeploy-argo\n</code></pre> <p>Cu\u00e1ndo usar: - Cuando usas ArgoCD para gestionar deployments - Para mantener consistencia con GitOps - En entornos compartidos</p>"},{"location":"docs/mobile/launch-script/#-backend-rollout-restart","title":"--backend-rollout-restart","text":"<p>Flujo imperativo: ejecuta <code>kubectl rollout restart deployment/backend</code>.</p> <pre><code>cd apps/mobile\n./launch_flutter_debug.sh --emulator --backend-rollout-restart\n</code></pre> <p>Cu\u00e1ndo usar: - Desarrollo local r\u00e1pido - Cuando no usas ArgoCD - Para forzar recreaci\u00f3n de pods</p>"},{"location":"docs/mobile/launch-script/#-no-backend-prune","title":"--no-backend-prune","text":"<p>Desactiva la eliminaci\u00f3n autom\u00e1tica de pods backend en <code>CrashLoopBackOff</code>.</p> <pre><code>cd apps/mobile\n./launch_flutter_debug.sh --emulator --no-backend-prune\n</code></pre> <p>Cu\u00e1ndo usar: - Debugging de problemas de backend - Cuando quieres inspeccionar pods fallidos - En entornos de producci\u00f3n</p>"},{"location":"docs/mobile/launch-script/#-no-backend-logs-window","title":"--no-backend-logs-window","text":"<p>Desactiva la apertura autom\u00e1tica de una ventana con logs del backend (solo Linux).</p> <pre><code>cd apps/mobile\n./launch_flutter_debug.sh --linux --no-backend-logs-window\n</code></pre> <p>Cu\u00e1ndo usar: - Cuando prefieres ver logs en la terminal principal - En sistemas sin terminal gr\u00e1fica - Para reducir ventanas abiertas</p>"},{"location":"docs/mobile/launch-script/#-no-adb-reverse","title":"--no-adb-reverse","text":"<p>Desactiva la configuraci\u00f3n de <code>adb reverse</code> en modo <code>--device</code>.</p> <pre><code>./launch_flutter_debug.sh -d --no-adb-reverse\n</code></pre> <p>Cu\u00e1ndo usar: - Cuando usas IP directa en lugar de localhost - Problemas con adb reverse - Dispositivos que no soportan reverse</p>"},{"location":"docs/mobile/launch-script/#menu-interactivo","title":"Men\u00fa Interactivo","text":"<p>Si ejecutas el script sin argumentos, se muestra un men\u00fa interactivo:</p> <pre><code>cd apps/mobile\n./launch_flutter_debug.sh\n\n\ud83d\udcf1 AltruPets \u2014 Selecciona destino:\n  1) \ud83d\udda5\ufe0f  Linux desktop (prueba r\u00e1pida)\n  2) \ud83d\udcf1 Emulador Android\n  3) \ud83d\udcf2 Dispositivo Android f\u00edsico\n  4) \ud83d\udcd6 Widgetbook (cat\u00e1logo de widgets)\nOpci\u00f3n [1-4]:\n</code></pre>"},{"location":"docs/mobile/launch-script/#flujo-de-ejecucion","title":"Flujo de Ejecuci\u00f3n","text":""},{"location":"docs/mobile/launch-script/#1-deteccion-de-plataforma","title":"1. Detecci\u00f3n de Plataforma","text":"<p>El script detecta autom\u00e1ticamente el sistema operativo: - Linux \u2192 <code>linux</code> - macOS \u2192 <code>macos</code> - Windows \u2192 <code>windows</code></p>"},{"location":"docs/mobile/launch-script/#2-verificacion-de-backend-si-esta-habilitada","title":"2. Verificaci\u00f3n de Backend (si est\u00e1 habilitada)","text":"<pre><code># El script verifica:\n1. kubectl est\u00e1 instalado\n2. Namespace 'altrupets-dev' existe\n3. Deployment 'backend' existe\n4. Backend est\u00e1 Ready (readyReplicas &gt;= 1)\n</code></pre> <p>Recuperaci\u00f3n autom\u00e1tica: - Sincroniza secretos de DB si est\u00e1n desincronizados - Elimina pods en <code>CrashLoopBackOff</code> si hay r\u00e9plicas sanas - Intenta build autom\u00e1tico si hay <code>ImagePullBackOff</code> - Limpia pods de ReplicaSets viejos que bloquean rollout</p>"},{"location":"docs/mobile/launch-script/#3-configuracion-de-tuneles","title":"3. Configuraci\u00f3n de T\u00faneles","text":"<p>Desktop:</p> <pre><code># Port-forward del backend (si est\u00e1 disponible)\nkubectl port-forward -n altrupets-dev svc/backend-service 3001:3001\n</code></pre> <p>Android Device:</p> <pre><code># adb reverse para t\u00fanel localhost\nadb -s &lt;device-id&gt; reverse tcp:3001 tcp:3001\n</code></pre>"},{"location":"docs/mobile/launch-script/#4-logs-centralizados","title":"4. Logs Centralizados","text":"<p>Todos los logs se guardan en:</p> <pre><code>logs/mobile/&lt;device-label&gt;/launch-&lt;timestamp&gt;.log\n</code></pre> <p>Donde <code>&lt;device-label&gt;</code> es: - <code>linux</code> / <code>macos</code> / <code>windows</code> para desktop - <code>android-emulator</code> para emulador - <code>android-device</code> para dispositivo f\u00edsico</p>"},{"location":"docs/mobile/launch-script/#5-ventana-de-logs-backend-linux","title":"5. Ventana de Logs Backend (Linux)","text":"<p>En Linux, el script intenta abrir una terminal separada con:</p> <pre><code>kubectl -n altrupets-dev logs -f deploy/backend --tail=200\n</code></pre> <p>Soporta: - <code>gnome-terminal</code> - <code>x-terminal-emulator</code> - <code>konsole</code></p>"},{"location":"docs/mobile/launch-script/#6-ejecucion-de-flutter","title":"6. Ejecuci\u00f3n de Flutter","text":"<pre><code>cd apps/mobile\nflutter pub get\nflutter run -d &lt;device-id&gt;\n</code></pre>"},{"location":"docs/mobile/launch-script/#ejemplos-de-uso","title":"Ejemplos de Uso","text":""},{"location":"docs/mobile/launch-script/#desarrollo-rapido-en-desktop","title":"Desarrollo R\u00e1pido en Desktop","text":"<pre><code>make dev-mobile-launch-desktop\n</code></pre>"},{"location":"docs/mobile/launch-script/#android-con-build-limpio","title":"Android con Build Limpio","text":"<pre><code>make dev-mobile-launch-emulator\n</code></pre>"},{"location":"docs/mobile/launch-script/#android-incremental-rapido","title":"Android Incremental (R\u00e1pido)","text":"<pre><code>cd apps/mobile\n./launch_flutter_debug.sh -d --dirty\n</code></pre>"},{"location":"docs/mobile/launch-script/#desarrollo-offline","title":"Desarrollo Offline","text":"<pre><code>cd apps/mobile\n./launch_flutter_debug.sh --linux --no-backend-check\n</code></pre>"},{"location":"docs/mobile/launch-script/#con-recuperacion-agresiva-del-backend","title":"Con Recuperaci\u00f3n Agresiva del Backend","text":"<pre><code>cd apps/mobile\n./launch_flutter_debug.sh --emulator --backend-retries 10 --backend-rollout-restart\n</code></pre>"},{"location":"docs/mobile/launch-script/#debugging-del-backend","title":"Debugging del Backend","text":"<pre><code>cd apps/mobile\n./launch_flutter_debug.sh --linux --no-backend-prune --backend-retries 1\n</code></pre>"},{"location":"docs/mobile/launch-script/#widgetbook-sin-backend","title":"Widgetbook sin Backend","text":"<pre><code>make dev-mobile-widgetbook\n# Backend check se salta autom\u00e1ticamente para Widgetbook\n</code></pre>"},{"location":"docs/mobile/launch-script/#variables-de-entorno-internas","title":"Variables de Entorno Internas","text":"<p>El script usa estas variables (no necesitas configurarlas):</p> Variable Default Descripci\u00f3n <code>BACKEND_CHECK_ENABLED</code> <code>true</code> Verificar backend <code>BACKEND_AUTO_BUILD_ENABLED</code> <code>true</code> Build autom\u00e1tico <code>BACKEND_MAX_RECOVERY_ATTEMPTS</code> <code>5</code> Intentos de recuperaci\u00f3n <code>ADB_REVERSE_ENABLED</code> <code>true</code> Configurar adb reverse <code>BACKEND_PRUNE_STALE_PODS</code> <code>true</code> Eliminar pods estancados <code>BACKEND_LOGS_WINDOW_ENABLED</code> <code>true</code> Abrir ventana de logs"},{"location":"docs/mobile/launch-script/#troubleshooting","title":"Troubleshooting","text":""},{"location":"docs/mobile/launch-script/#backend-no-disponible-abortando-launch","title":"\"Backend no disponible. Abortando launch\"","text":"<p>Causa: El backend no est\u00e1 Ready despu\u00e9s de todos los intentos.</p> <p>Soluci\u00f3n:</p> <pre><code># Ver estado\nkubectl -n altrupets-dev get pods\n\n# Ver logs\nkubectl -n altrupets-dev logs -f deploy/backend\n\n# Rebuild manual\nmake dev-backend-build\n\n# O saltar verificaci\u00f3n\ncd apps/mobile\n./launch_flutter_debug.sh --linux --no-backend-check\n</code></pre>"},{"location":"docs/mobile/launch-script/#no-se-detecto-dispositivo-o-emulador-android","title":"\"No se detect\u00f3 dispositivo o emulador Android\"","text":"<p>Causa: No hay dispositivos conectados.</p> <p>Soluci\u00f3n:</p> <pre><code># Listar emuladores\nflutter emulators\n\n# Lanzar emulador\nflutter emulators --launch &lt;emulator-id&gt;\n\n# Verificar\nflutter devices\nadb devices\n</code></pre>"},{"location":"docs/mobile/launch-script/#adb-reverse-failed","title":"\"adb reverse failed\"","text":"<p>Causa: Dispositivo no autorizado o sin depuraci\u00f3n USB.</p> <p>Soluci\u00f3n: 1. Habilita \"Depuraci\u00f3n USB\" en el dispositivo 2. Acepta el di\u00e1logo de autorizaci\u00f3n 3. Verifica: <code>adb devices</code> 4. O usa directamente: <code>cd apps/mobile &amp;&amp; ./launch_flutter_debug.sh -d --no-adb-reverse</code></p>"},{"location":"docs/mobile/launch-script/#no-se-pudo-abrir-terminal-adicional-para-logs","title":"\"No se pudo abrir terminal adicional para logs\"","text":"<p>Causa: Terminal no soportada o no disponible.</p> <p>Soluci\u00f3n:</p> <pre><code># Ver logs manualmente\nkubectl -n altrupets-dev logs -f deploy/backend --tail=200\n\n# O desactiva la ventana\ncd apps/mobile\n./launch_flutter_debug.sh --linux --no-backend-logs-window\n</code></pre>"},{"location":"docs/mobile/launch-script/#logs-no-se-guardan","title":"Logs no se guardan","text":"<p>Causa: Directorio <code>logs/mobile/</code> no existe o sin permisos.</p> <p>Soluci\u00f3n:</p> <pre><code>mkdir -p logs/mobile/{android-device,android-emulator,linux}\nchmod -R 755 logs/\n</code></pre>"},{"location":"docs/mobile/launch-script/#integracion-con-makefile","title":"Integraci\u00f3n con Makefile","text":"<p>El script se integra con los comandos del Makefile:</p> <pre><code># Setup completo\nmake setup\nmake dev-minikube-deploy\nmake dev-gateway-deploy\nmake dev-backend-build\nmake dev-argocd-deploy\n\n# Lanzar app\nmake dev-mobile-launch-emulator\n\n# Si cambias backend\nmake dev-backend-build\n# El script detectar\u00e1 el cambio autom\u00e1ticamente\n</code></pre>"},{"location":"docs/mobile/launch-script/#mejores-practicas","title":"Mejores Pr\u00e1cticas","text":"<ol> <li>Usa <code>--dirty</code> para iteraciones r\u00e1pidas en Android (ahorra ~30s por build)</li> <li>Revisa los logs centralizados si hay problemas: <code>logs/mobile/*/launch-*.log</code></li> <li>Usa desktop para desarrollo de UI (m\u00e1s r\u00e1pido que emulador)</li> <li>Usa <code>--backend-retries 10</code> si Minikube es lento</li> <li>Desactiva verificaci\u00f3n de backend si trabajas offline: <code>--no-backend-check</code></li> </ol>"},{"location":"docs/mobile/launch-script/#proximas-mejoras","title":"Pr\u00f3ximas Mejoras","text":"<ul> <li> Soporte para iOS (detecci\u00f3n de simuladores)</li> <li> Configuraci\u00f3n de variables de entorno por archivo <code>.env</code></li> <li> Selecci\u00f3n interactiva de m\u00faltiples dispositivos</li> <li> Integraci\u00f3n con Firebase Test Lab</li> <li> Modo \"watch\" para rebuild autom\u00e1tico del backend</li> </ul>"},{"location":"docs/mobile/launch-script/#ver-tambien","title":"Ver Tambi\u00e9n","text":"<ul> <li>Getting Started - Gu\u00eda completa de instalaci\u00f3n</li> <li>Makefile Commands - Comandos de infraestructura</li> <li>Backend Setup - Configuraci\u00f3n del backend</li> <li>Troubleshooting - Soluci\u00f3n de problemas comunes</li> </ul>"},{"location":"docs/mobile/sast/","title":"Flutter SAST (Static Analysis)","text":"<p>El script <code>flutter-sast.sh</code> proporciona an\u00e1lisis est\u00e1tico de c\u00f3digo para Flutter.</p>"},{"location":"docs/mobile/sast/#uso","title":"Uso","text":"<pre><code>./flutter-sast.sh [command]\n</code></pre>"},{"location":"docs/mobile/sast/#comandos-disponibles","title":"Comandos disponibles","text":"Comando Descripci\u00f3n <code>analyze</code> Ejecuta <code>dart analyze</code> (default) <code>test</code> Ejecuta unit tests <code>coverage</code> Ejecuta tests con coverage <code>lint</code> Ejecuta an\u00e1lisis + formato <code>all</code> Ejecuta an\u00e1lisis completo"},{"location":"docs/mobile/sast/#ejemplos","title":"Ejemplos","text":""},{"location":"docs/mobile/sast/#analisis-basico","title":"An\u00e1lisis b\u00e1sico","text":"<pre><code>./flutter-sast.sh analyze\n</code></pre>"},{"location":"docs/mobile/sast/#tests-con-coverage","title":"Tests con coverage","text":"<pre><code>./flutter-sast.sh coverage\n</code></pre> <p>Output: <code>coverage/lcov.info</code></p>"},{"location":"docs/mobile/sast/#analisis-completo","title":"An\u00e1lisis completo","text":"<pre><code>./flutter-sast.sh all\n</code></pre>"},{"location":"docs/mobile/sast/#integracion-con-makefile","title":"Integraci\u00f3n con Makefile","text":"<pre><code>make dev-mobile-analyze      # dart analyze\nmake dev-mobile-test         # unit tests\nmake dev-mobile-test-coverage # tests con coverage\nmake dev-mobile-lint         # all linting\n</code></pre>"},{"location":"docs/mobile/sast/#cicd","title":"CI/CD","text":"<p>Para integrar en pipelines:</p> <pre><code># GitHub Actions example\n- name: Flutter SAST\n  run: |\n    cd apps/mobile\n    ./flutter-sast.sh all\n</code></pre>"},{"location":"docs/mobile/sast/#herramientas-incluidas","title":"Herramientas incluidas","text":"<ul> <li>dart analyze: An\u00e1lisis est\u00e1tico de Dart</li> <li>flutter test: Unit tests</li> <li>flutter format: Verificaci\u00f3n de formato</li> </ul>"},{"location":"docs/mobile/sast/#configuracion","title":"Configuraci\u00f3n","text":"<p>El an\u00e1lisis usa las reglas definidas en: - <code>analysis_options.yaml</code> - Reglas de linting - <code>dart_test.yaml</code> - Configuraci\u00f3n de tests</p>"},{"location":"docs/mobile/widgetbook/","title":"\ud83d\udcd6 Widgetbook - Cat\u00e1logo de Componentes UI","text":"<p>Gu\u00eda completa para usar Widgetbook como herramienta de QA de dise\u00f1o UI en AltruPets.</p>"},{"location":"docs/mobile/widgetbook/#que-es-widgetbook","title":"\u00bfQu\u00e9 es Widgetbook?","text":"<p>Widgetbook es un cat\u00e1logo interactivo de componentes UI que permite:</p> <ul> <li>\ud83c\udfa8 Visualizar componentes en aislamiento sin ejecutar la app completa</li> <li>\ud83d\udd27 Probar variaciones de props, estados y temas en tiempo real</li> <li>\ud83d\udcf1 Validar dise\u00f1o antes de integrar en la aplicaci\u00f3n</li> <li>\ud83e\udd1d Colaborar con dise\u00f1adores mostrando componentes implementados</li> <li>\ud83d\udcda Documentar el Design System de forma visual e interactiva</li> </ul>"},{"location":"docs/mobile/widgetbook/#ubicacion","title":"Ubicaci\u00f3n","text":"<pre><code>apps/widgetbook/\n\u251c\u2500\u2500 lib/\n\u2502   \u251c\u2500\u2500 main.dart                    # Entry point con tabs\n\u2502   \u251c\u2500\u2500 main.directories.g.dart      # Generado por build_runner\n\u2502   \u251c\u2500\u2500 showcase/                    # Showcase del Design System\n\u2502   \u2502   \u251c\u2500\u2500 design_system_showcase.dart\n\u2502   \u2502   \u251c\u2500\u2500 tonal_palette_generator.dart\n\u2502   \u2502   \u251c\u2500\u2500 typography_showcase.dart\n\u2502   \u2502   \u2514\u2500\u2500 elevation_showcase.dart\n\u2502   \u2514\u2500\u2500 use_cases/                   # Use cases de componentes\n\u2502       \u251c\u2500\u2500 atoms/                   # Componentes b\u00e1sicos\n\u2502       \u251c\u2500\u2500 molecules/               # Componentes compuestos\n\u2502       \u2514\u2500\u2500 organisms/               # Componentes complejos\n\u251c\u2500\u2500 pubspec.yaml\n\u2514\u2500\u2500 README.md\n</code></pre>"},{"location":"docs/mobile/widgetbook/#arquitectura","title":"Arquitectura","text":"<p>Widgetbook en AltruPets tiene dos secciones principales:</p>"},{"location":"docs/mobile/widgetbook/#1-widgetbook-tab-1","title":"1. Widgetbook (Tab 1)","text":"<p>Cat\u00e1logo interactivo de componentes individuales con controles (knobs) para modificar props en tiempo real.</p>"},{"location":"docs/mobile/widgetbook/#2-showcase-tab-2","title":"2. Showcase (Tab 2)","text":"<p>Visualizaci\u00f3n completa del Design System: - Colors: Paletas tonales, colores primarios, secundarios, etc. - Typography: Escalas tipogr\u00e1ficas (Display, Headline, Body, Label) - Elevation: Niveles de sombra y profundidad</p>"},{"location":"docs/mobile/widgetbook/#lanzar-widgetbook","title":"Lanzar Widgetbook","text":""},{"location":"docs/mobile/widgetbook/#opcion-1-script-automatizado-recomendado","title":"Opci\u00f3n 1: Script Automatizado (Recomendado)","text":"<pre><code># Desde la ra\u00edz del monorepo\nmake dev-mobile-widgetbook\n</code></pre> <p>El script autom\u00e1ticamente: 1. Ejecuta <code>flutter pub get</code> 2. Genera c\u00f3digo con <code>build_runner</code> 3. Abre Widgetbook en Chrome (o desktop si Chrome no est\u00e1 disponible)</p>"},{"location":"docs/mobile/widgetbook/#opcion-2-manual","title":"Opci\u00f3n 2: Manual","text":"<pre><code>cd apps/widgetbook\n\n# Instalar dependencias\nflutter pub get\n\n# Generar directorios (IMPORTANTE)\ndart run build_runner build -d\n\n# Ejecutar en Chrome\nflutter run -d chrome\n\n# O en desktop\nflutter run -d linux   # macOS: macos, Windows: windows\n</code></pre>"},{"location":"docs/mobile/widgetbook/#flujo-de-trabajo-para-qa-de-ui","title":"Flujo de Trabajo para QA de UI","text":""},{"location":"docs/mobile/widgetbook/#1-disenador-crea-mockups-en-figma","title":"1. Dise\u00f1ador crea mockups en Figma","text":"<p>El dise\u00f1ador trabaja en Figma y define: - Colores (tokens de dise\u00f1o) - Tipograf\u00edas - Espaciados - Componentes</p>"},{"location":"docs/mobile/widgetbook/#2-desarrollador-implementa-componente","title":"2. Desarrollador implementa componente","text":"<pre><code>// apps/mobile/lib/core/widgets/atoms/app_circular_button.dart\nclass AppCircularButton extends StatelessWidget {\n  final IconData icon;\n  final VoidCallback onTap;\n  final double size;\n  final Color? iconColor;\n  final double iconSize;\n  final Gradient? gradient;\n  final List&lt;BoxShadow&gt;? boxShadow;\n\n  const AppCircularButton({\n    super.key,\n    required this.icon,\n    required this.onTap,\n    this.size = 56,\n    this.iconColor,\n    this.iconSize = 24,\n    this.gradient,\n    this.boxShadow,\n  });\n\n  @override\n  Widget build(BuildContext context) {\n    // Implementaci\u00f3n...\n  }\n}\n</code></pre>"},{"location":"docs/mobile/widgetbook/#3-crear-use-case-en-widgetbook","title":"3. Crear Use Case en Widgetbook","text":"<pre><code>// apps/widgetbook/lib/use_cases/atoms/app_circular_button_use_case.dart\nimport 'package:flutter/material.dart';\nimport 'package:widgetbook/widgetbook.dart';\nimport 'package:widgetbook_annotation/widgetbook_annotation.dart' as widgetbook;\nimport 'package:altrupets/core/widgets/atoms/app_circular_button.dart';\n\n@widgetbook.UseCase(name: 'Default', type: AppCircularButton)\nWidget buildAppCircularButtonUseCase(BuildContext context) {\n  return AppCircularButton(\n    icon: Icons.add,\n    onTap: () {},\n    size: context.knobs.double.slider(\n      label: 'Size',\n      initialValue: 56,\n      min: 32,\n      max: 80,\n    ),\n    iconColor: context.knobs.color(\n      label: 'Icon Color',\n      initialValue: Colors.white,\n    ),\n    iconSize: context.knobs.double.slider(\n      label: 'Icon Size',\n      initialValue: 24,\n      min: 16,\n      max: 40,\n    ),\n  );\n}\n\n@widgetbook.UseCase(name: 'With Gradient', type: AppCircularButton)\nWidget buildAppCircularButtonGradientUseCase(BuildContext context) {\n  return AppCircularButton(\n    icon: Icons.home_rounded,\n    onTap: () {},\n    size: 56,\n    iconSize: 30,\n    gradient: LinearGradient(\n      colors: [\n        Theme.of(context).colorScheme.secondary,\n        Theme.of(context).colorScheme.primary,\n      ],\n    ),\n  );\n}\n</code></pre>"},{"location":"docs/mobile/widgetbook/#4-regenerar-widgetbook","title":"4. Regenerar Widgetbook","text":"<pre><code>cd apps/widgetbook\ndart run build_runner build -d\n</code></pre> <p>Esto genera <code>main.directories.g.dart</code> que registra autom\u00e1ticamente todos los use cases.</p>"},{"location":"docs/mobile/widgetbook/#5-qa-visual-con-disenador","title":"5. QA Visual con Dise\u00f1ador","text":"<ol> <li>Abrir Widgetbook: <code>make dev-mobile-widgetbook</code></li> <li>Navegar al componente en el \u00e1rbol de la izquierda</li> <li>Probar variaciones usando los knobs (controles)</li> <li>Cambiar tema (Light/Dark) con el addon de tema</li> <li>Validar que coincida con el dise\u00f1o de Figma</li> <li>Iterar si hay diferencias</li> </ol>"},{"location":"docs/mobile/widgetbook/#6-capturar-screenshots-opcional","title":"6. Capturar Screenshots (Opcional)","text":"<pre><code># Mientras Widgetbook est\u00e1 corriendo\nflutter screenshot --out=screenshots/button_default.png\n</code></pre>"},{"location":"docs/mobile/widgetbook/#anatomia-de-un-use-case","title":"Anatom\u00eda de un Use Case","text":""},{"location":"docs/mobile/widgetbook/#estructura-basica","title":"Estructura B\u00e1sica","text":"<pre><code>import 'package:widgetbook_annotation/widgetbook_annotation.dart' as widgetbook;\n\n@widgetbook.UseCase(name: 'Nombre del Caso', type: MiWidget)\nWidget buildMiWidgetUseCase(BuildContext context) {\n  return MiWidget(\n    // Props del widget\n  );\n}\n</code></pre>"},{"location":"docs/mobile/widgetbook/#knobs-disponibles","title":"Knobs Disponibles","text":"<p>Los knobs permiten controlar props en tiempo real:</p> <pre><code>// Slider num\u00e9rico\ncontext.knobs.double.slider(\n  label: 'Size',\n  initialValue: 56,\n  min: 32,\n  max: 80,\n)\n\n// Input de texto\ncontext.knobs.string(\n  label: 'Title',\n  initialValue: 'Hello World',\n)\n\n// Selector de color\ncontext.knobs.color(\n  label: 'Background Color',\n  initialValue: Colors.blue,\n)\n\n// Boolean (checkbox)\ncontext.knobs.boolean(\n  label: 'Enabled',\n  initialValue: true,\n)\n\n// Lista de opciones\ncontext.knobs.list(\n  label: 'Size',\n  options: ['small', 'medium', 'large'],\n  initialOption: 'medium',\n)\n</code></pre>"},{"location":"docs/mobile/widgetbook/#multiples-variantes","title":"M\u00faltiples Variantes","text":"<p>Puedes crear m\u00faltiples use cases para el mismo widget:</p> <pre><code>@widgetbook.UseCase(name: 'Default', type: AppButton)\nWidget buildDefaultButton(BuildContext context) {\n  return AppButton(text: 'Click me');\n}\n\n@widgetbook.UseCase(name: 'Loading', type: AppButton)\nWidget buildLoadingButton(BuildContext context) {\n  return AppButton(text: 'Loading...', isLoading: true);\n}\n\n@widgetbook.UseCase(name: 'Disabled', type: AppButton)\nWidget buildDisabledButton(BuildContext context) {\n  return AppButton(text: 'Disabled', enabled: false);\n}\n</code></pre>"},{"location":"docs/mobile/widgetbook/#organizacion-por-atomic-design","title":"Organizaci\u00f3n por Atomic Design","text":"<p>Widgetbook en AltruPets sigue Atomic Design:</p>"},{"location":"docs/mobile/widgetbook/#atoms-atomos","title":"Atoms (\u00c1tomos)","text":"<p>Componentes b\u00e1sicos e indivisibles: - <code>AppCircularButton</code> - <code>AppRoleBadge</code> - <code>AppAccentBar</code></p> <p>Ubicaci\u00f3n: - Implementaci\u00f3n: <code>apps/mobile/lib/core/widgets/atoms/</code> - Use cases: <code>apps/widgetbook/lib/use_cases/atoms/</code></p>"},{"location":"docs/mobile/widgetbook/#molecules-moleculas","title":"Molecules (Mol\u00e9culas)","text":"<p>Combinaci\u00f3n de \u00e1tomos: - <code>HomeWelcomeHeader</code> - <code>SectionHeader</code> - <code>AppInputCard</code> - <code>ProfileMenuOption</code></p> <p>Ubicaci\u00f3n: - Implementaci\u00f3n: <code>apps/mobile/lib/core/widgets/molecules/</code> - Use cases: <code>apps/widgetbook/lib/use_cases/molecules/</code></p>"},{"location":"docs/mobile/widgetbook/#organisms-organismos","title":"Organisms (Organismos)","text":"<p>Componentes complejos: - <code>MainNavigationBar</code> - <code>ProfileHeader</code> - <code>StickyActionFooter</code></p> <p>Ubicaci\u00f3n: - Implementaci\u00f3n: <code>apps/mobile/lib/core/widgets/organisms/</code> - Use cases: <code>apps/widgetbook/lib/use_cases/organisms/</code></p>"},{"location":"docs/mobile/widgetbook/#showcase-del-design-system","title":"Showcase del Design System","text":"<p>El tab \"Showcase\" muestra el Design System completo:</p>"},{"location":"docs/mobile/widgetbook/#colors-paletas-tonales","title":"Colors (Paletas Tonales)","text":"<p>Visualiza todas las paletas de color: - Primary (Azul) - Secondary (Naranja) - Tertiary - Error - Neutral - Neutral Variant</p> <p>Cada paleta muestra tonos del 0 al 100.</p>"},{"location":"docs/mobile/widgetbook/#typography-tipografia","title":"Typography (Tipograf\u00eda)","text":"<p>Muestra todas las escalas tipogr\u00e1ficas: - Display: displayLarge, displayMedium, displaySmall - Headline: headlineLarge, headlineMedium, headlineSmall - Title: titleLarge, titleMedium, titleSmall - Body: bodyLarge, bodyMedium, bodySmall - Label: labelLarge, labelMedium, labelSmall</p>"},{"location":"docs/mobile/widgetbook/#elevation-elevacion","title":"Elevation (Elevaci\u00f3n)","text":"<p>Visualiza los 5 niveles de elevaci\u00f3n con sus sombras correspondientes.</p>"},{"location":"docs/mobile/widgetbook/#comandos-utiles","title":"Comandos \u00datiles","text":""},{"location":"docs/mobile/widgetbook/#regenerar-codigo","title":"Regenerar C\u00f3digo","text":"<pre><code>cd apps/widgetbook\n\n# Build una vez\ndart run build_runner build -d\n\n# Watch mode (regenera autom\u00e1ticamente)\ndart run build_runner watch -d\n</code></pre>"},{"location":"docs/mobile/widgetbook/#limpiar-y-regenerar","title":"Limpiar y Regenerar","text":"<pre><code>cd apps/widgetbook\nflutter clean\nflutter pub get\ndart run build_runner build --delete-conflicting-outputs\n</code></pre>"},{"location":"docs/mobile/widgetbook/#ejecutar-en-diferentes-plataformas","title":"Ejecutar en Diferentes Plataformas","text":"<pre><code># Chrome (recomendado para QA)\nflutter run -d chrome\n\n# Linux desktop\nflutter run -d linux\n\n# macOS desktop\nflutter run -d macos\n\n# Windows desktop\nflutter run -d windows\n</code></pre>"},{"location":"docs/mobile/widgetbook/#checklist-de-qa-visual","title":"Checklist de QA Visual","text":"<p>Usa este checklist al validar componentes con el dise\u00f1ador:</p>"},{"location":"docs/mobile/widgetbook/#colores","title":"\u2705 Colores","text":"<ul> <li> Colores coinciden con tokens de Figma</li> <li> Tema claro funciona correctamente</li> <li> Tema oscuro funciona correctamente</li> <li> Estados hover/pressed tienen feedback visual</li> </ul>"},{"location":"docs/mobile/widgetbook/#tipografia","title":"\u2705 Tipograf\u00eda","text":"<ul> <li> Fuentes correctas (Lemon Milk / Poppins)</li> <li> Tama\u00f1os de texto coinciden con dise\u00f1o</li> <li> Line height y letter spacing correctos</li> <li> Jerarqu\u00eda visual clara</li> </ul>"},{"location":"docs/mobile/widgetbook/#espaciado","title":"\u2705 Espaciado","text":"<ul> <li> Padding interno correcto</li> <li> Margin externo correcto</li> <li> Espaciado entre elementos consistente</li> </ul>"},{"location":"docs/mobile/widgetbook/#interactividad","title":"\u2705 Interactividad","text":"<ul> <li> Botones responden al tap</li> <li> Animaciones suaves (si aplica)</li> <li> Estados disabled visualmente claros</li> <li> Loading states funcionan</li> </ul>"},{"location":"docs/mobile/widgetbook/#responsive","title":"\u2705 Responsive","text":"<ul> <li> Se adapta a diferentes anchos</li> <li> Texto no se corta</li> <li> Im\u00e1genes escalan correctamente</li> </ul>"},{"location":"docs/mobile/widgetbook/#accesibilidad","title":"\u2705 Accesibilidad","text":"<ul> <li> Contraste de color suficiente (WCAG AA)</li> <li> Tama\u00f1os de tap targets &gt;= 44x44</li> <li> Semantic labels presentes</li> </ul>"},{"location":"docs/mobile/widgetbook/#integracion-con-figma","title":"Integraci\u00f3n con Figma","text":""},{"location":"docs/mobile/widgetbook/#exportar-tokens-de-figma","title":"Exportar Tokens de Figma","text":"<ol> <li>Dise\u00f1ador exporta tokens desde Figma usando plugin \"Design Tokens\"</li> <li>Tokens se guardan en <code>apps/mobile/assets/style_dictionary/</code></li> <li>Desarrollador ejecuta Style Dictionary para generar c\u00f3digo Dart</li> <li>Tokens se aplican en <code>apps/mobile/lib/core/theme/</code></li> </ol>"},{"location":"docs/mobile/widgetbook/#validar-implementacion","title":"Validar Implementaci\u00f3n","text":"<ol> <li>Abrir Figma y Widgetbook lado a lado</li> <li>Comparar visualmente componente en ambos</li> <li>Usar herramientas de medici\u00f3n de Figma para verificar espaciados</li> <li>Usar inspector de color para verificar valores exactos</li> </ol>"},{"location":"docs/mobile/widgetbook/#troubleshooting","title":"Troubleshooting","text":""},{"location":"docs/mobile/widgetbook/#could-not-find-generator-widgetbook_generator","title":"\"Could not find generator 'widgetbook_generator'\"","text":"<p>Soluci\u00f3n:</p> <pre><code>cd apps/widgetbook\nflutter clean\nflutter pub get\ndart run build_runner build -d\n</code></pre>"},{"location":"docs/mobile/widgetbook/#use-case-no-aparece-en-widgetbook","title":"Use case no aparece en Widgetbook","text":"<p>Causas comunes: 1. Falta anotaci\u00f3n <code>@widgetbook.UseCase</code> 2. No se regener\u00f3 <code>main.directories.g.dart</code> 3. Archivo no est\u00e1 en <code>lib/use_cases/</code></p> <p>Soluci\u00f3n:</p> <pre><code>dart run build_runner build --delete-conflicting-outputs\n</code></pre>"},{"location":"docs/mobile/widgetbook/#chrome-no-esta-disponible","title":"Chrome no est\u00e1 disponible","text":"<p>Soluci\u00f3n:</p> <pre><code># Usar desktop en su lugar\nflutter run -d linux  # o macos/windows\n</code></pre>"},{"location":"docs/mobile/widgetbook/#componente-no-se-importa-correctamente","title":"Componente no se importa correctamente","text":"<p>Causa: El componente est\u00e1 en <code>apps/mobile</code> y Widgetbook lo importa como dependencia.</p> <p>Soluci\u00f3n:</p> <pre><code>// Importar desde el paquete altrupets\nimport 'package:altrupets/core/widgets/atoms/mi_widget.dart';\n</code></pre>"},{"location":"docs/mobile/widgetbook/#hot-reload-no-funciona","title":"Hot reload no funciona","text":"<p>Soluci\u00f3n: - Usa Hot Restart (<code>R</code>) en lugar de Hot Reload (<code>r</code>) - O reinicia completamente: <code>q</code> + <code>flutter run</code></p>"},{"location":"docs/mobile/widgetbook/#mejores-practicas","title":"Mejores Pr\u00e1cticas","text":""},{"location":"docs/mobile/widgetbook/#1-un-use-case-por-estado","title":"1. Un Use Case por Estado","text":"<p>Crea use cases separados para cada estado significativo:</p> <pre><code>@widgetbook.UseCase(name: 'Default', type: AppButton)\n@widgetbook.UseCase(name: 'Loading', type: AppButton)\n@widgetbook.UseCase(name: 'Disabled', type: AppButton)\n@widgetbook.UseCase(name: 'Error', type: AppButton)\n</code></pre>"},{"location":"docs/mobile/widgetbook/#2-usa-knobs-para-props-variables","title":"2. Usa Knobs para Props Variables","text":"<p>Permite al dise\u00f1ador experimentar:</p> <pre><code>size: context.knobs.double.slider(\n  label: 'Size',\n  initialValue: 56,\n  min: 32,\n  max: 80,\n)\n</code></pre>"},{"location":"docs/mobile/widgetbook/#3-proporciona-contexto-visual","title":"3. Proporciona Contexto Visual","text":"<p>Envuelve componentes en contenedores con fondo si es necesario:</p> <pre><code>return Container(\n  width: 400,\n  color: const Color(0xFF0F172A),\n  child: MiWidget(),\n);\n</code></pre>"},{"location":"docs/mobile/widgetbook/#4-documenta-variantes-importantes","title":"4. Documenta Variantes Importantes","text":"<p>Crea use cases para casos de uso reales:</p> <pre><code>@widgetbook.UseCase(name: 'With Long Text', type: AppCard)\n@widgetbook.UseCase(name: 'With Image', type: AppCard)\n@widgetbook.UseCase(name: 'Empty State', type: AppCard)\n</code></pre>"},{"location":"docs/mobile/widgetbook/#5-manten-sincronizado-con-mobile","title":"5. Mant\u00e9n Sincronizado con Mobile","text":"<p>Cuando cambies un componente en <code>apps/mobile</code>: 1. Actualiza el use case correspondiente en <code>apps/widgetbook</code> 2. Regenera con <code>build_runner</code> 3. Valida visualmente</p>"},{"location":"docs/mobile/widgetbook/#workflow-completo-diseno-implementacion-qa","title":"Workflow Completo: Dise\u00f1o \u2192 Implementaci\u00f3n \u2192 QA","text":"<pre><code>graph LR\n    A[Dise\u00f1ador crea en Figma] --&gt; B[Exporta tokens]\n    B --&gt; C[Dev implementa componente]\n    C --&gt; D[Dev crea use case]\n    D --&gt; E[Regenera Widgetbook]\n    E --&gt; F[QA visual con dise\u00f1ador]\n    F --&gt; G{\u00bfAprobado?}\n    G --&gt;|No| C\n    G --&gt;|S\u00ed| H[Integrar en app]\n</code></pre>"},{"location":"docs/mobile/widgetbook/#paso-a-paso","title":"Paso a Paso","text":"<ol> <li>Dise\u00f1ador: Crea componente en Figma con especificaciones</li> <li>Desarrollador: Implementa en <code>apps/mobile/lib/core/widgets/</code></li> <li>Desarrollador: Crea use case en <code>apps/widgetbook/lib/use_cases/</code></li> <li>Desarrollador: Regenera Widgetbook</li> <li>Ambos: Sesi\u00f3n de QA visual en Widgetbook</li> <li>Dise\u00f1ador: Aprueba o solicita cambios</li> <li>Desarrollador: Itera hasta aprobaci\u00f3n</li> <li>Desarrollador: Integra componente en features de la app</li> </ol>"},{"location":"docs/mobile/widgetbook/#recursos-adicionales","title":"Recursos Adicionales","text":"<ul> <li>Widgetbook Documentation</li> <li>Atomic Design Methodology</li> <li>Material Design 3</li> <li>AltruPets Design System</li> <li>Getting Started</li> </ul>"},{"location":"docs/mobile/widgetbook/#proximas-mejoras","title":"Pr\u00f3ximas Mejoras","text":"<ul> <li> Integraci\u00f3n con Figma Dev Mode para comparaci\u00f3n lado a lado</li> <li> Screenshots autom\u00e1ticos para regression testing</li> <li> Exportaci\u00f3n de componentes a Storybook (web)</li> <li> Tests visuales automatizados con Golden Files</li> <li> Documentaci\u00f3n inline en use cases</li> </ul> <p>\u00daltima actualizaci\u00f3n: Febrero 2025</p>"},{"location":"docs/packages/latam-payments-package/","title":"LatinAmericanPaymentGateway - Package Documentation","text":""},{"location":"docs/packages/latam-payments-package/#overview","title":"Overview","text":"<p>A comprehensive payment gateway SDK for Latin America supporting Costa Rica, Panama, Colombia, Mexico, Brazil, and more with native payment methods like SINPE, PSE, SPEI, PIX, and OXXO.</p> <p>Target: pub.dev package <code>latam_payments</code></p>"},{"location":"docs/packages/latam-payments-package/#1-package-structure","title":"1. Package Structure","text":"<pre><code>lib/\n\u251c\u2500\u2500 src/\n\u2502   \u251c\u2500\u2500 core/\n\u2502   \u2502   \u251c\u2500\u2500 entities/\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 money.dart\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 card_token.dart\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 payment_result.dart\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 refund_result.dart\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 payment_gateway_configuration.dart\n\u2502   \u2502   \u251c\u2500\u2500 enums/\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 country.dart\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 currency.dart\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 payment_method_type.dart\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 payment_status.dart\n\u2502   \u2502   \u2514\u2500\u2500 interfaces/\n\u2502   \u2502       \u2514\u2500\u2500 latin_american_payment_gateway.dart\n\u2502   \u251c\u2500\u2500 gateways/\n\u2502   \u2502   \u251c\u2500\u2500 costa_rica/\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 onvo_pay_payment_gateway.dart\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 tilopay_payment_gateway.dart\n\u2502   \u2502   \u251c\u2500\u2500 panama/\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 [to be defined]\n\u2502   \u2502   \u251c\u2500\u2500 colombia/\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 wompi_payment_gateway.dart\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 payu_colombia_payment_gateway.dart\n\u2502   \u2502   \u251c\u2500\u2500 mexico/\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 openpay_payment_gateway.dart\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 conekta_payment_gateway.dart\n\u2502   \u2502   \u2514\u2500\u2500 brazil/\n\u2502   \u2502       \u251c\u2500\u2500 pix/\n\u2502   \u2502       \u2502   \u251c\u2500\u2500 pix_payment_method.dart\n\u2502   \u2502       \u2502   \u2514\u2500\u2500 pix_payment_gateway.dart\n\u2502   \u2502       \u2514\u2500\u2500 mercado_pago_brazil_payment_gateway.dart\n\u2502   \u2514\u2500\u2500 services/\n\u2502       \u251c\u2500\u2500 payment_gateway_factory.dart\n\u2502       \u2514\u2500\u2500 payment_gateway_registry.dart\n\u251c\u2500\u2500 latam_payments.dart\n\u2514\u2500\u2500 latam_payments_core.dart\n</code></pre>"},{"location":"docs/packages/latam-payments-package/#2-core-interface","title":"2. Core Interface","text":""},{"location":"docs/packages/latam-payments-package/#latin_american_payment_gatewaydart","title":"<code>latin_american_payment_gateway.dart</code>","text":"<pre><code>abstract class LatinAmericanPaymentGateway {\n  /// Unique identifier for the gateway\n  String get id;\n\n  /// Display name\n  String get name;\n\n  /// Primary country of operation\n  Country get primaryCountry;\n\n  /// Additional supported countries (for multi-country gateways)\n  Set&lt;Country&gt; get supportedCountries;\n\n  /// Supported payment methods\n  Set&lt;PaymentMethodType&gt; get supportedMethods;\n\n  /// Supported currencies\n  Set&lt;Currency&gt; get supportedCurrencies;\n\n  /// Initialize with configuration\n  Future&lt;void&gt; initialize(PaymentGatewayConfiguration config);\n\n  /// PCI compliant card tokenization\n  /// Returns a secure token representing the card\n  Future&lt;CardToken&gt; tokenizeCard({\n    required String cardNumber,\n    required String expiryMonth,\n    required String expiryYear,\n    required String cvv,\n    required String cardHolderName,\n    CardBillingAddress? billingAddress,\n  });\n\n  /// Process a payment\n  /// [amount]: Amount in smallest currency unit (e.g., 1000 = $10.00)\n  /// [currency]: Payment currency\n  /// [method]: Payment method (CardToken, Pix, Sinpe, etc.)\n  Future&lt;PaymentResult&gt; processPayment({\n    required int amount,\n    required Currency currency,\n    required PaymentMethodType method,\n    required String description,\n    String? orderId,\n    Customer? customer,\n    Map&lt;String, dynamic&gt;? metadata,\n  });\n\n  /// Check transaction status\n  Future&lt;PaymentResult&gt; getTransaction(String transactionId);\n\n  /// Refund transaction\n  /// [amount]: If null, full refund\n  Future&lt;RefundResult&gt; refund({\n    required String transactionId,\n    int? amount,\n    String? reason,\n  });\n\n  /// Check gateway availability\n  Future&lt;bool&gt; healthCheck();\n\n  /// Dispose resources\n  Future&lt;void&gt; dispose();\n}\n</code></pre>"},{"location":"docs/packages/latam-payments-package/#3-configuration","title":"3. Configuration","text":""},{"location":"docs/packages/latam-payments-package/#payment_gateway_configurationdart","title":"<code>payment_gateway_configuration.dart</code>","text":"<pre><code>/// Configuration for any LATAM payment gateway\nclass PaymentGatewayConfiguration {\n  /// Public API Key (for client-side tokenization)\n  final String? publicKey;\n\n  /// Private API Key (for backend, if applicable)\n  final String? privateKey;\n\n  /// API Secret (for gateways requiring it)\n  final String? apiSecret;\n\n  /// Environment: sandbox or production\n  final bool sandbox;\n\n  /// Request timeout (default: 30s)\n  final Duration timeout;\n\n  /// Gateway-specific configuration\n  final Map&lt;String, dynamic&gt;? extraConfig;\n\n  const PaymentGatewayConfiguration({\n    this.publicKey,\n    this.privateKey,\n    this.apiSecret,\n    this.sandbox = true,\n    this.timeout = const Duration(seconds: 30),\n    this.extraConfig,\n  });\n\n  /// Factory for minimal configuration (tokenization only)\n  factory PaymentGatewayConfiguration.minimal({\n    required String publicKey,\n    bool sandbox = true,\n  }) =&gt; PaymentGatewayConfiguration(\n    publicKey: publicKey,\n    sandbox: sandbox,\n  );\n}\n</code></pre>"},{"location":"docs/packages/latam-payments-package/#4-enums","title":"4. Enums","text":""},{"location":"docs/packages/latam-payments-package/#country","title":"Country","text":"<pre><code>enum Country {\n  costaRica('CR', 'Costa Rica'),\n  panama('PA', 'Panam\u00e1'),\n  colombia('CO', 'Colombia'),\n  mexico('MX', 'M\u00e9xico'),\n  brazil('BR', 'Brasil'),\n  argentina('AR', 'Argentina'),\n  chile('CL', 'Chile'),\n  peru('PE', 'Per\u00fa');\n\n  final String code;\n  final String displayName;\n  const Country(this.code, this.displayName);\n}\n</code></pre>"},{"location":"docs/packages/latam-payments-package/#currency","title":"Currency","text":"<pre><code>enum Currency {\n  crc('CRC', 'Costa Rican Col\u00f3n', '\u20a1'),\n  pab('PAB', 'Panamanian Balboa', 'B/.'),\n  cop('COP', 'Colombian Peso', r'$'),\n  mxn('MXN', 'Mexican Peso', r'$'),\n  brl('BRL', 'Brazilian Real', r'R$'),\n  usd('USD', 'US Dollar', r'$');\n\n  final String code;\n  final String name;\n  final String symbol;\n  const Currency(this.code, this.name, this.symbol);\n}\n</code></pre>"},{"location":"docs/packages/latam-payments-package/#paymentmethodtype","title":"PaymentMethodType","text":"<pre><code>enum PaymentMethodType {\n  creditCard,\n  debitCard,\n  sinpeMovil,      // Costa Rica\n  pse,             // Colombia\n  nequi,           // Colombia\n  spei,            // M\u00e9xico\n  oxxo,            // M\u00e9xico\n  pix,             // Brasil\n  boleto,          // Brasil\n  yape,            // Per\u00fa\n  plin,            // Per\u00fa\n}\n</code></pre>"},{"location":"docs/packages/latam-payments-package/#5-factory-registry","title":"5. Factory &amp; Registry","text":""},{"location":"docs/packages/latam-payments-package/#payment_gateway_factorydart","title":"<code>payment_gateway_factory.dart</code>","text":"<pre><code>enum PaymentGatewayType {\n  onvoPay,\n  tilopay,\n  wompi,\n  openpay,\n  conekta,\n  mercadoPago,\n  ebanx,\n}\n\nclass PaymentGatewayFactory {\n  static LatinAmericanPaymentGateway create({\n    required PaymentGatewayType type,\n    required PaymentGatewayConfiguration config,\n  }) {\n    switch (type) {\n      case PaymentGatewayType.onvoPay:\n        return OnvoPayPaymentGateway(config);\n      case PaymentGatewayType.tilopay:\n        return TilopayPaymentGateway(config);\n      case PaymentGatewayType.wompi:\n        return WompiPaymentGateway(config);\n      case PaymentGatewayType.openpay:\n        return OpenpayPaymentGateway(config);\n      case PaymentGatewayType.conekta:\n        return ConektaPaymentGateway(config);\n      case PaymentGatewayType.mercadoPago:\n        return MercadoPagoPaymentGateway(config);\n      case PaymentGatewayType.ebanx:\n        return EbanxPaymentGateway(config);\n    }\n  }\n\n  static List&lt;PaymentGatewayType&gt; availableFor(Country country) {\n    return PaymentGatewayRegistry.gatewaysByCountry[country] ?? [];\n  }\n\n  static Set&lt;PaymentMethodType&gt; nativeMethodsFor(Country country) {\n    return switch (country) {\n      Country.costaRica =&gt; {PaymentMethodType.sinpeMovil},\n      Country.colombia =&gt; {PaymentMethodType.pse, PaymentMethodType.nequi},\n      Country.mexico =&gt; {PaymentMethodType.spei, PaymentMethodType.oxxo},\n      Country.brazil =&gt; {PaymentMethodType.pix, PaymentMethodType.boleto},\n      _ =&gt; {},\n    };\n  }\n}\n</code></pre>"},{"location":"docs/packages/latam-payments-package/#payment_gateway_registrydart","title":"<code>payment_gateway_registry.dart</code>","text":"<pre><code>class PaymentGatewayRegistry {\n  static const Map&lt;Country, List&lt;PaymentGatewayType&gt;&gt; gatewaysByCountry = {\n    Country.costaRica: [\n      PaymentGatewayType.onvoPay,\n      PaymentGatewayType.tilopay,\n    ],\n    Country.panama: [\n      // To be defined\n    ],\n    Country.colombia: [\n      PaymentGatewayType.wompi,\n      PaymentGatewayType.mercadoPago,\n      PaymentGatewayType.ebanx,\n    ],\n    Country.mexico: [\n      PaymentGatewayType.openpay,\n      PaymentGatewayType.conekta,\n      PaymentGatewayType.mercadoPago,\n    ],\n    Country.brazil: [\n      PaymentGatewayType.mercadoPago,\n      PaymentGatewayType.ebanx,\n    ],\n  };\n}\n</code></pre>"},{"location":"docs/packages/latam-payments-package/#6-implementation-roadmap","title":"6. Implementation Roadmap","text":""},{"location":"docs/packages/latam-payments-package/#sprint-1-foundations-this-week","title":"Sprint 1: Foundations (This Week)","text":"<ol> <li>Create directory structure</li> <li>Define base interfaces (<code>LatinAmericanPaymentGateway</code>, enums, entities)</li> <li>Migrate <code>OnvoPayPaymentGateway</code> and <code>TilopayPaymentGateway</code></li> <li>Create <code>PaymentGatewayFactory</code> and <code>PaymentGatewayRegistry</code></li> <li>Unit tests</li> </ol>"},{"location":"docs/packages/latam-payments-package/#sprint-2-colombia-week-2","title":"Sprint 2: Colombia (Week 2)","text":"<ol> <li>Implement <code>WompiPaymentGateway</code></li> <li>PSE support</li> <li>Nequi support (if API available)</li> </ol>"},{"location":"docs/packages/latam-payments-package/#sprint-3-mexico-week-3","title":"Sprint 3: Mexico (Week 3)","text":"<ol> <li>Implement <code>OpenpayPaymentGateway</code></li> <li>SPEI support</li> <li>OXXO support</li> </ol>"},{"location":"docs/packages/latam-payments-package/#sprint-4-brazil-pix-week-4","title":"Sprint 4: Brazil PIX (Week 4)","text":"<ol> <li>Implement <code>MercadoPagoBrazilPaymentGateway</code></li> <li>PIX QR code generation</li> <li>PIX confirmation webhooks</li> </ol>"},{"location":"docs/packages/latam-payments-package/#sprint-5-package-release-week-5","title":"Sprint 5: Package Release (Week 5)","text":"<ol> <li>Extract to separate repository</li> <li>Create example app</li> <li>Documentation</li> <li>Publish to pub.dev as <code>latam_payments: ^0.1.0</code></li> </ol>"},{"location":"docs/packages/latam-payments-package/#7-usage-example","title":"7. Usage Example","text":"<pre><code>import 'package:latam_payments/latam_payments.dart';\n\n// Initialize gateway\nfinal gateway = PaymentGatewayFactory.create(\n  type: PaymentGatewayType.onvoPay,\n  config: PaymentGatewayConfiguration(\n    publicKey: 'pk_live_...',\n    sandbox: false,\n  ),\n);\n\n// Tokenize card\nfinal token = await gateway.tokenizeCard(\n  cardNumber: '4242424242424242',\n  expiryMonth: '12',\n  expiryYear: '2025',\n  cvv: '123',\n  cardHolderName: 'John Doe',\n);\n\n// Process payment\nfinal result = await gateway.processPayment(\n  amount: 50000, // \u20a150,000\n  currency: Currency.crc,\n  method: PaymentMethodType.creditCard,\n  description: 'Purchase',\n);\n\nif (result.success) {\n  print('Payment successful: ${result.transactionId}');\n}\n</code></pre>"},{"location":"docs/packages/latam-payments-package/#8-package-configuration","title":"8. Package Configuration","text":""},{"location":"docs/packages/latam-payments-package/#pubspecyaml","title":"pubspec.yaml","text":"<pre><code>name: latam_payments\ndescription: A comprehensive payment gateway SDK for Latin America supporting Costa Rica, Panama, Colombia, Mexico, Brazil, and more.\nversion: 0.1.0\nhomepage: https://github.com/yourorg/latam_payments\nrepository: https://github.com/yourorg/latam_payments\n\nenvironment:\n  sdk: '&gt;=3.0.0 &lt;4.0.0'\n  flutter: '&gt;=3.10.0'\n\ndependencies:\n  flutter:\n    sdk: flutter\n  http: ^1.1.0\n  freezed_annotation: ^2.4.0\n  json_annotation: ^4.8.0\n  crypto: ^3.0.3\n\ndev_dependencies:\n  flutter_test:\n    sdk: flutter\n  build_runner: ^2.4.0\n  freezed: ^2.4.0\n  json_serializable: ^6.7.0\n  mockito: ^5.4.0\n\ntopics:\n  - payments\n  - latam\n  - gateway\n  - costa-rica\n  - colombia\n  - mexico\n  - brazil\n</code></pre>"},{"location":"docs/packages/latam-payments-package/#9-naming-conventions","title":"9. Naming Conventions","text":"<p>All classes use <code>PaymentGateway</code> suffix to avoid conflicts: - \u2705 <code>LatinAmericanPaymentGateway</code> - \u2705 <code>PaymentGatewayConfiguration</code> - \u2705 <code>PaymentGatewayFactory</code> - \u2705 <code>PaymentGatewayRegistry</code> - \u2705 <code>PaymentGatewayType</code> - \u2705 <code>OnvoPayPaymentGateway</code> - \u2705 <code>TilopayPaymentGateway</code> - \u2705 <code>WompiPaymentGateway</code></p>"},{"location":"docs/packages/latam-payments-package/#10-integration-example","title":"10. Integration Example","text":"<pre><code>// Consumer app configuration\nclass MyAppPaymentConfig {\n  static LatinAmericanPaymentGateway gatewayFor(Country country) {\n    return PaymentGatewayFactory.create(\n      type: _gatewayTypeFor(country),\n      config: PaymentGatewayConfiguration(\n        publicKey: _getPublicKeyFor(country),\n        sandbox: const bool.fromEnvironment('SANDBOX', defaultValue: true),\n      ),\n    );\n  }\n\n  static PaymentGatewayType _gatewayTypeFor(Country country) {\n    return switch (country) {\n      Country.costaRica =&gt; PaymentGatewayType.onvoPay,\n      Country.colombia =&gt; PaymentGatewayType.wompi,\n      Country.mexico =&gt; PaymentGatewayType.openpay,\n      Country.brazil =&gt; PaymentGatewayType.mercadoPago,\n      _ =&gt; throw UnsupportedError('Country not supported yet: $country'),\n    };\n  }\n}\n</code></pre> <p>License: MIT Version: 0.1.0 Last Updated: February 2026</p>"},{"location":"docs/packages/latam-payments-progress/","title":"LatinAmericanPaymentGateway - Progress Report","text":""},{"location":"docs/packages/latam-payments-progress/#sprint-progress","title":"Sprint Progress","text":""},{"location":"docs/packages/latam-payments-progress/#sprint-1-foundations-completed","title":"\u2705 Sprint 1: Foundations - COMPLETED","text":"<p>Date: February 18, 2026</p> <p>Completed: - \u2705 Created package directory structure (Clean Architecture) - \u2705 Defined core enums: Country, Currency, PaymentMethodType, PaymentStatus - \u2705 Created entities: Money, CardToken, PaymentResult, RefundResult, PaymentGatewayConfiguration - \u2705 Implemented interface: LatinAmericanPaymentGateway - \u2705 Created factory and registry services - \u2705 Implemented OnvoPayPaymentGateway (Costa Rica) - \u2705 Implemented TilopayPaymentGateway (Costa Rica) - \u2705 Static analysis: No errors, only minor infos</p> <p>Files Created (15):</p> <pre><code>lib/core/payments/\n\u251c\u2500\u2500 data/gateways/costa_rica/\n\u2502   \u251c\u2500\u2500 onvo_pay_payment_gateway.dart\n\u2502   \u2514\u2500\u2500 tilopay_payment_gateway.dart\n\u251c\u2500\u2500 domain/\n\u2502   \u251c\u2500\u2500 entities/ (5 files)\n\u2502   \u251c\u2500\u2500 enums/ (4 files)\n\u2502   \u2514\u2500\u2500 interfaces/ (1 file)\n\u251c\u2500\u2500 services/\n\u2502   \u251c\u2500\u2500 payment_gateway_factory.dart\n\u2502   \u2514\u2500\u2500 payment_gateway_registry.dart\n\u2514\u2500\u2500 latam_payments.dart\n</code></pre>"},{"location":"docs/packages/latam-payments-progress/#sprint-2-colombia-wompi-completed","title":"\u2705 Sprint 2: Colombia (Wompi) - COMPLETED","text":"<p>Date: February 18, 2026</p> <p>Completed: - \u2705 Researched Wompi API documentation - \u2705 Found existing Flutter SDK: <code>wompi_payment_colombia</code> v3.0.0 on pub.dev - \u2705 Found official GitHub: https://github.com/reyesmfabian/wompi_payment - \u2705 Implemented WompiPaymentGateway with:   - Credit/Debit Cards   - PSE (Pagos Seguros en L\u00ednea)   - Nequi (Digital wallet) - \u2705 Added support for Colombia AND Panama - \u2705 Added Acceptance Token flow (required by Wompi) - \u2705 Added Integrity Key support - \u2705 Added Business Prefix support - \u2705 Added getPseBanks() method - \u2705 Added verifyWebhookSignature() method</p> <p>Files Created (1):</p> <pre><code>lib/core/payments/data/gateways/colombia/\n\u2514\u2500\u2500 wompi_payment_gateway.dart\n</code></pre> <p>Key Wompi Features Implemented: 1. Acceptance Token - Required before any payment (Wompi requirement) 2. Integrity Key - For transaction verification 3. Business Prefix - For payment references 4. PSE Flow - Bank transfer with async payment URL 5. Nequi Flow - Digital wallet with phone number 6. Card Payments - Tokenization + payment 7. Webhooks - Signature verification</p> <p>Research Findings: - Wompi Official Docs: https://docs.wompi.co - Existing SDK: <code>wompi_payment_colombia</code> (unofficial but functional) - Supported Methods:   - Colombia: Cards, PSE, Nequi   - Panama: Cards, ACH - Currencies: COP, PAB, USD - Key Requirement: Acceptance token must be obtained before payments</p>"},{"location":"docs/packages/latam-payments-progress/#sprint-3-mexico-openpay-conekta-completed","title":"\u2705 Sprint 3: Mexico (OpenPay, Conekta) - COMPLETED","text":"<p>Date: February 18, 2026</p> <p>Completed: - \u2705 Researched OpenPay and Conekta APIs - \u2705 Found existing Flutter packages:   - OpenPay: <code>openpay_bbva</code>, <code>openpay2</code>, <code>kiwi-bop/openpay</code> (GitHub)   - Conekta: <code>conekta</code> (server-side), <code>conekta_component</code> (UI), <code>conekta_flutter</code> - \u2705 Implemented OpenpayPaymentGateway with:   - Credit/Debit Cards (tokenization)   - SPEI (bank transfer)   - OXXO (cash payments) - \u2705 Implemented ConektaPaymentGateway with:   - Credit/Debit Cards   - SPEI (bank transfer via checkout)   - OXXO (cash via checkout) - \u2705 Updated PaymentGatewayFactory with new gateways - \u2705 Static analysis: No errors, only warnings/infos</p> <p>Files Created (2):</p> <pre><code>lib/core/payments/data/gateways/mexico/\n\u251c\u2500\u2500 openpay_payment_gateway.dart\n\u2514\u2500\u2500 conekta_payment_gateway.dart\n</code></pre> <p>Key Implementation Details:</p> <p>OpenPay: - Uses merchant ID from extraConfig - Card tokenization via /tokens endpoint - Direct charge creation via /charges - Supports OXXO and SPEI via payment_method type</p> <p>Conekta: - Order-based payment flow - Checkout-based for cash/bank transfers - Card tokenization via /tokens endpoint - Versioned API (v2.1.0)</p> <p>Research Findings: - OpenPay Docs: https://documents.openpay.mx/en/api/ - Conekta Docs: https://developers.conekta/ - Supported Methods: Cards, SPEI, OXXO - Currencies: MXN, USD - Both require private key for server-side operations - Both support 3D Secure for cards</p>"},{"location":"docs/packages/latam-payments-progress/#sprint-4-brazil-mercado-pago-completed","title":"\u2705 Sprint 4: Brazil (Mercado Pago) - COMPLETED","text":"<p>Date: February 18, 2026</p> <p>Completed: - \u2705 Researched Mercado Pago Brazil API - \u2705 Found existing Flutter packages:   - <code>mercadopago_transparent</code> - Full SDK   - <code>mp_integration</code> - SDK module   - <code>mercadopago_ducos</code> - Server-side implementation   - <code>pix_bb</code> - Banco do Brasil PIX specific - \u2705 Implemented MercadoPagoPaymentGateway with:   - Credit/Debit Cards   - PIX (instant payments, QR code)   - Boleto banc\u00e1rio - \u2705 Added getPixQrCode() method - \u2705 Updated PaymentGatewayFactory with new gateway - \u2705 Static analysis: No errors, only minor warnings</p> <p>Files Created (1):</p> <pre><code>lib/core/payments/data/gateways/brazil/\n\u2514\u2500\u2500 mercado_pago_payment_gateway.dart\n</code></pre> <p>Key Implementation Details:</p> <p>Mercado Pago Brazil: - Order-based payment flow (v1/orders) - PIX via payment_method_id: 'pix' - Boleto via payment_method_id: 'bolbradesco' - X-Idempotency-Key header required - Returns QR code and ticket_url for PIX</p> <p>Research Findings: - Mercado Pago Docs: https://www.mercadopago.com.br/developers/ - Supported Methods: Cards, PIX, Boleto - Currencies: BRL, USD - PIX: Instant payments, QR code, copy-paste code - Note: Official Flutter SDK deprecated, recommends WebView checkout (Checkout Bricks)</p>"},{"location":"docs/packages/latam-payments-progress/#sprint-5-package-release-in-progress","title":"\ud83d\udea7 Sprint 5: Package Release - IN PROGRESS","text":"<p>Date: February 18, 2026</p> <p>Completed: - \u2705 Created CHANGELOG.md - \u2705 Added unit tests for entities and factory (52 tests passing) - \u2705 Tests cover: Country, Currency, PaymentMethodType, PaymentStatus enums - \u2705 Tests cover: Money, CardToken, PaymentResult, PaymentGatewayConfiguration entities - \u2705 Tests cover: PaymentGatewayFactory create, availableFor, nativeMethodsFor, supportedMethodsFor</p> <p>Pending: - [ ] Extract to separate repository - [ ] Create example app - [ ] Publish to pub.dev as <code>latam_payments: ^0.1.0</code> - [ ] Add widget tests for payment forms - [ ] Add integration tests for payment flows - [ ] Add mobile testing with Flutter MCP</p>"},{"location":"docs/packages/latam-payments-progress/#current-file-structure","title":"\ud83d\udcc1 Current File Structure","text":"<pre><code>lib/core/payments/\n\u251c\u2500\u2500 data/gateways/\n\u2502   \u251c\u2500\u2500 costa_rica/\n\u2502   \u2502   \u251c\u2500\u2500 onvo_pay_payment_gateway.dart\n\u2502   \u2502   \u2514\u2500\u2500 tilopay_payment_gateway.dart\n\u2502   \u251c\u2500\u2500 colombia/\n\u2502   \u2502   \u2514\u2500\u2500 wompi_payment_gateway.dart\n\u2502   \u251c\u2500\u2500 mexico/\n\u2502   \u2502   \u251c\u2500\u2500 openpay_payment_gateway.dart\n\u2502   \u2502   \u2514\u2500\u2500 conekta_payment_gateway.dart\n\u2502   \u2514\u2500\u2500 brazil/\n\u2502       \u2514\u2500\u2500 mercado_pago_payment_gateway.dart\n\u251c\u2500\u2500 domain/\n\u2502   \u251c\u2500\u2500 entities/\n\u2502   \u2502   \u251c\u2500\u2500 card_token.dart\n\u2502   \u2502   \u251c\u2500\u2500 money.dart\n\u2502   \u2502   \u251c\u2500\u2500 payment_gateway_configuration.dart\n\u2502   \u2502   \u251c\u2500\u2500 payment_result.dart\n\u2502   \u2502   \u2514\u2500\u2500 refund_result.dart\n\u2502   \u251c\u2500\u2500 enums/\n\u2502   \u2502   \u251c\u2500\u2500 country.dart\n\u2502   \u2502   \u251c\u2500\u2500 currency.dart\n\u2502   \u2502   \u251c\u2500\u2500 payment_method_type.dart\n\u2502   \u2502   \u2514\u2500\u2500 payment_status.dart\n\u2502   \u2514\u2500\u2500 interfaces/\n\u2502       \u2514\u2500\u2500 latin_american_payment_gateway.dart\n\u251c\u2500\u2500 services/\n\u2502   \u251c\u2500\u2500 payment_gateway_factory.dart\n\u2502   \u2514\u2500\u2500 payment_gateway_registry.dart\n\u2514\u2500\u2500 latam_payments.dart\n</code></pre>"},{"location":"docs/packages/latam-payments-progress/#usage-example","title":"\ud83d\udd27 Usage Example","text":"<pre><code>import 'package:altrupets/core/payments/latam_payments.dart';\n\n// Create gateway\nfinal gateway = PaymentGatewayFactory.create(\n  type: PaymentGatewayType.wompi,\n  config: PaymentGatewayConfiguration(\n    publicKey: 'pub_test_...',\n    sandbox: true,\n    extraConfig: {\n      'integrityKey': 'integ_...',\n      'businessPrefix': 'MY-',\n    },\n  ),\n);\n\n// Initialize (fetches acceptance token)\nawait gateway.initialize(config);\n\n// Tokenize card\nfinal token = await gateway.tokenizeCard(\n  cardNumber: '4242424242424242',\n  expiryMonth: '12',\n  expiryYear: '2025',\n  cvv: '123',\n  cardHolderName: 'John Doe',\n);\n\n// Process payment (card)\nfinal result = await gateway.processPayment(\n  amount: 50000, // COP\n  currency: Currency.cop,\n  method: PaymentMethodType.creditCard,\n  description: 'Purchase',\n  metadata: {'card_token': token.id},\n);\n\n// For PSE - get payment URL and redirect user\nif (result.receiptUrl != null) {\n  // Redirect to bank\n}\n</code></pre>"},{"location":"docs/packages/latam-payments-progress/#analysis-tests-results","title":"\ud83d\udcca Analysis &amp; Tests Results","text":"<pre><code>dart analyze lib/core/payments/\n\u2705 0 errors\n\u26a0\ufe0f  2 warnings (unused fields - expected, for future use)\n\u2139\ufe0f  Multiple infos (style recommendations)\n\nflutter test test/core/payments/\n\u2705 52 tests passing\n- payments_entities_test.dart: 29 tests\n- payment_gateway_factory_test.dart: 23 tests\n</code></pre>"},{"location":"docs/packages/latam-payments-progress/#supported-countries-methods","title":"\ud83c\udf0d Supported Countries &amp; Methods","text":"Country Gateways Methods \ud83c\udde8\ud83c\uddf7 Costa Rica OnvoPay, Tilopay Cards, SINPE \ud83c\udde8\ud83c\uddf4 Colombia Wompi Cards, PSE, Nequi \ud83c\uddf5\ud83c\udde6 Panama Wompi Cards, ACH \ud83c\uddf2\ud83c\uddfd Mexico OpenPay, Conekta Cards, SPEI, OXXO \ud83c\udde7\ud83c\uddf7 Brazil Mercado Pago Cards, PIX, Boleto"},{"location":"docs/packages/latam-payments-progress/#notes","title":"\ud83d\udcdd Notes","text":"<ul> <li>All gateways use <code>PaymentGateway</code> suffix to avoid naming conflicts</li> <li>Package-ready structure for future extraction to pub.dev</li> <li>Follows Clean Architecture with domain/data/presentation layers</li> <li>PCI-compliant: card tokenization happens on gateway side</li> <li>Multi-country support built into core interface</li> </ul> <p>Last Updated: February 18, 2026 Version: 0.1.0 Status: Sprint 5 In Progress (Unit Tests Added)</p>"}]}
